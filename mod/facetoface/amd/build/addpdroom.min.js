define(["jquery","core/str","core/config"],function(a,b,c){var d=function(){};return d.prototype=new totaraDialog_handler_treeview_singleselect("pdroomid","pdroom"),d.prototype.setup_delete=function(){this.deletable=!0;var c=a("#"+this.text_element_id),d=a("input[name="+this.value_element_name+"]"),e=a('<span class="dialog-singleselect-deletable">');b.get_string("delete","totara_core").done(function(a){e.html(a)});var f=this;e.click(function(){d.val(""),c.removeClass("nonempty"),c.empty(),a('input[name="pdroomid"]').val(0),a("span#roomnote").html(""),a('input[name="capacity"]').val("10"),a('input[name="pdroomcapacity"]').val(0),a("#warn").remove(),f.setup_delete()}),c.text().length&&c.append(e)},d.prototype._open=function(){var b=0,d=[];a('input[name^="datedelete["]').each(function(){if(!a(this).is(":checked")){var c=new Date(a('.fdate_time_selector select[name="timestart['+b+'][year]"]').val(),a('.fdate_time_selector select[name="timestart['+b+'][month]"]').val()-1,a('.fdate_time_selector select[name="timestart['+b+'][day]"]').val(),a('.fdate_time_selector select[name="timestart['+b+'][hour]"]').val(),a('.fdate_time_selector select[name="timestart['+b+'][minute]"]').val()).getTime()/1e3,e=new Date(a('.fdate_time_selector select[name="timefinish['+b+'][year]"]').val(),a('.fdate_time_selector select[name="timefinish['+b+'][month]"]').val()-1,a('.fdate_time_selector select[name="timefinish['+b+'][day]"]').val(),a('.fdate_time_selector select[name="timefinish['+b+'][hour]"]').val(),a('.fdate_time_selector select[name="timefinish['+b+'][minute]"]').val()).getTime()/1e3;d.push([c,e])}b+=1}),d=JSON.stringify(d),this._dialog.default_url=c.wwwroot+"/mod/facetoface/room/ajax/sessionrooms.php?sessionid="+M.totara_f2f_room.config.sessionid+"&datetimeknown="+M.totara_f2f_room.config.datetimeknown+"&timeslots="+d+"&facetofaceid="+M.totara_f2f_room.config.facetofaceid},d.prototype.first_load=function(){totaraDialog_handler_treeview_singleselect.prototype.first_load.call(this)},d.prototype.every_load=function(){totaraDialog_handler_treeview_singleselect.prototype.every_load.call(this);var b=a("#treeview_selected_val_"+this._title).val();a("span.unclickable").not("#item_"+b).has("a").not(".hasfootnoteflag").each(function(){a(this).addClass("hasfootnoteflag")})},d.prototype.external_function=function(){a.ajax({url:c.wwwroot+"/mod/facetoface/room/ajax/roomcap.php?id="+a('input[name="pdroomid"]').val(),type:"GET",success:function(b){b.length&&(a("#warn").remove(),a('input[name="capacity"]').val(b),a('input[name="pdroomcapacity"]').val(b))}}),a.ajax({url:c.wwwroot+"/mod/facetoface/room/ajax/roomnote.php?id="+a('input[name="pdroomid"]').val(),type:"GET",success:function(b){b.length&&(b="<br>"+b),a("span#roomnote").html(b)},error:function(){a("span#roomnote").html("")}}),a('input[name="customroom"]').prop("checked",!1),a('input[name="croomname"], input[name="croombuilding"], input[name="croomaddress"], input[name="croomcapacity"]').prop("disabled",!0)},d});