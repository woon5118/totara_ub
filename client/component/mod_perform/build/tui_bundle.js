!function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s="UXb3")}({"+EcL":function(e,t,i){"use strict";i.r(t);var n=i("Lrk7"),a=i("JXQf"),s=i.n(a),r=i("zdti"),o=i.n(r),l=i("nu/z"),d=i.n(l),c={components:{Loader:s.a,NotificationBanner:o.a,ActivityContent:d.a},props:{currentUserId:{required:!0,type:Number,default:null},subjectInstanceId:{required:!0,type:Number},sectionId:{required:!1,type:Number}},data:()=>({hasLoaded:!1,userActivity:null,subjectInstance:null}),apollo:{subjectInstance:{query:()=>n.a,skip(){return!this.subjectInstanceId},variables(){return{subject_instance_id:this.subjectInstanceId}},update(e){return this.hasLoaded=!0,e.mod_perform_subject_instance_for_participant}}},computed:{activityNotFound(){return null===this.subjectInstanceId||!this.$apollo.loading&&null===this.subjectInstance},activityFound(){return null!==this.subjectInstanceId&&(!this.$apollo.loading&&null!==this.subjectInstance)}}},u=i("KHd+"),m=function(e){e.options.__langStrings={mod_perform:["user_activities_activity_does_not_exist"]}},_=Object(u.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivity"},[i("Loader",{attrs:{loading:e.$apollo.loading}},[e.activityNotFound?i("NotificationBanner",{attrs:{dismissable:!1,message:e.$str("user_activities_activity_does_not_exist","mod_perform"),type:"error"}}):e.activityFound?i("ActivityContent",{attrs:{"current-user-id":e.currentUserId,activity:e.subjectInstance.activity,"created-at":e.subjectInstance.created_at,"subject-instance-id":e.subjectInstanceId,"section-id":e.sectionId,"subject-user":e.subjectInstance.subject_user,"job-assignments":e.subjectInstance.static_instances}}):e._e()],1)],1)}),[],!1,null,null,null);"function"==typeof m&&m(_),_.options.__hasBlocks={script:!0,template:!0};t.default=_.exports},"+FpX":function(e,t,i){"use strict";i.r(t);var n=i("vyVp"),a={props:{message:String},mounted(){this.message&&Object(n.notify)({message:this.message,type:"success"})}},s=i("KHd+"),r=Object(s.a)(a,(function(){var e=this.$createElement;return(this._self._c||e)("div")}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};t.default=r.exports},"+Hk5":function(e,t,i){"use strict";i.r(t);var n=i("/7MI"),a=i.n(n),s=i("5xBH"),r=i.n(s),o=i("VX2K"),l=i.n(o),d=i("dCH5"),c=i.n(d),u=i("WBvU"),m={components:{FieldGroup:a.a,FormDateSelector:u.FormDateSelector,FormField:u.FormField,FormRadioGroup:r.a,FormRadioWithInput:u.FormRadioWithInput,FormRow:u.FormRow,FormRowStack:u.FormRowStack,Radio:l.a,RadioDateRange:c.a},props:{isEnabled:{type:Boolean,required:!0},isFixed:{type:Boolean,required:!0},scheduleIsLimitedFixed:{type:Boolean,required:!0}},computed:{title(){return this.isEnabled?this.$str("due_date_enabled","mod_perform"):this.$str("due_date_disabled","mod_perform")}}},_=(i("62eV"),i("KHd+")),p=function(e){e.options.__langStrings={mod_perform:["date","due_date_disabled","due_date_disabled_description","due_date_enabled","due_date_enabled_description","due_date_enabled_fixed_date","due_date_enabled_relative_date","due_date_enabled_relative_date_a11y","due_date_enabled_relative_date_label","trigger"]}},v=Object(_.a)(m,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-assignmentScheduleDueDate"},[i("h4",{staticClass:"tui-assignmentScheduleDueDate__title"},[e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),i("div",{staticClass:"tui-assignmentScheduleDueDate__description"},[e._v("\n    "+e._s(e.$str(e.isEnabled?"due_date_enabled_description":"due_date_disabled_description","mod_perform"))+"\n  ")]),e._v(" "),e.isEnabled?[i("div",{staticClass:"tui-assignmentScheduleDueDate__form"},[e.scheduleIsLimitedFixed?i("FormRowStack",[i("FormRow",{attrs:{label:e.$str("trigger","mod_perform")}},[i("FormRadioGroup",{attrs:{name:"dueDateType"}},[i("FormRadioWithInput",{attrs:{name:["dueDateOffset","relative"],text:e.$str("due_date_enabled_relative_date","mod_perform"),value:"relative"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.disabledRadio,a=t.nameLabel,s=t.setAccessibleLabel,r=t.update,o=t.value;return[i("RadioDateRange",{attrs:{disabled:n,value:o,name:a},on:{input:function(e){return r(e)},"accessible-change":function(t){return s(e.$str("due_date_enabled_relative_date_a11y","mod_perform",{range:t.range,value:t.value}))}}})]}}],null,!1,1239654200)}),e._v(" "),i("Radio",{attrs:{value:"fixed"}},[e._v("\n              "+e._s(e.$str("due_date_enabled_fixed_date","mod_perform"))+"\n            ")])],1)],1),e._v(" "),i("FormRow",{attrs:{label:e.$str("date","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.labelId;return[i("FieldGroup",{attrs:{"aria-labelledby":n}},[i("FormDateSelector",{attrs:{id:e.$id("fixed-date-from"),name:"fixedDueDate",disabled:!e.isFixed,validations:function(e){return[e.required()]},type:"date","has-timezone":""}})],1)]}}],null,!1,2762850863)})],1):[i("FormRow",{attrs:{label:e.$str("due_date_enabled_relative_date_label","mod_perform")}},[i("FormField",{attrs:{name:["dueDateOffset","relative"]},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.labelId,n=e.value,a=e.update;return[i("RadioDateRange",{attrs:{"aria-labelledby":t,name:"dueDateOffset",value:n},on:{input:a}})]}}],null,!1,3260324037)})],1)]],2)]:e._e()],2)}),[],!1,null,null,null);"function"==typeof p&&p(v),v.options.__hasBlocks={script:!0,template:!0};t.default=v.exports},"+MEP":function(e,t){e.exports=tui.require("tui/components/profile/MiniProfileCard")},"+Y01":function(e,t,i){"use strict";var n=i("PWCq");i.n(n).a},"+kGl":function(e,t,i){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_activity_types"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activity_types"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}}]}}]}},"+kVI":function(e,t,i){},"/7MI":function(e,t){e.exports=tui.require("tui/components/form/FieldGroup")},"/Ngp":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/participation/InstanceInfoCard")},"/X/1":function(e,t){e.exports=tui.require("tui/components/toggle/ToggleSet")},"03eI":function(e,t,i){"use strict";i.r(t);var n=i("TXEh"),a=i("KxNG"),s=i("vF5l"),r=i.n(s),o=i("Aka+"),l=i.n(o),d=i("JXQf"),c=i.n(d),u=i("zkRv"),m=i.n(u),_=i("qCQ6"),p=i.n(_),v=i("a+Ln"),f=i.n(v),g=i("WBvU"),k=i("1SmC"),h=i.n(k),y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_participant_sections_for_print"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_participant_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"participant_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subject_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"mod_perform_participant_sections"},arguments:[{kind:"Argument",name:{kind:"Name",value:"participant_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"section_element_responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_element_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_print_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_response_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"response_data_raw"},name:{kind:"Name",value:"response_data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"responses_are_visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name_plural"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}}]}}]},S={components:{RequiredOptionalIndicator:f.a,Button:r.a,ElementParticipantForm:l.a,Loader:c.a,OtherParticipantResponses:m.a,ParticipantGeneralInformation:p.a,Uniform:g.Uniform,PrintedTodoIcon:h.a},props:{activity:{type:Object,required:!0},createdAt:{type:String,required:!0},dueDate:String,subjectUser:{type:Object,required:!0,validator:e=>["id","profileimageurlsmall","fullname"].every(Object.prototype.hasOwnProperty.bind(e))},participantInstanceId:{type:Number,required:!0},jobAssignments:{type:Array,required:!0},printedOnDate:{type:String,required:!0}},data:()=>({participantInstance:null,participantSectionResponses:[],errors:null,isDraft:!1}),computed:{elementsResponsesBySection(){const e={};return this.participantSectionResponses.forEach(t=>{e[t.id]=t.section_element_responses.map(e=>({id:e.section_element_id,clientId:Object(n.uniqueId)(),printComponent:tui.asyncComponent(e.element.element_plugin.participant_print_component),responseDisplayComponent:tui.asyncComponent(e.element.element_plugin.participant_response_component),element:{type:e.element.element_plugin,title:e.element.title,data:JSON.parse(e.element.data),is_required:e.element.is_required},sort_order:e.sort_order,is_respondable:e.element.is_respondable,response_data:JSON.parse(e.response_data),response_data_raw:JSON.parse(e.response_data_raw),response_data_formatted_lines:e.response_data_formatted_lines,other_responder_groups:e.other_responder_groups}))}),e},initialUniformValues(){if(this.participantSectionResponses===[])return{};const e={};return this.participantSectionResponses.forEach(t=>{e[t.id]={sectionElements:{}},this.elementsResponsesBySection[t.id].filter(e=>e.is_respondable).forEach(i=>{e[t.id].sectionElements[i.id]={response:i.response_data_raw}})}),e},relationshipToUser(){return null===this.participantInstance?null:this.currentUserIsSubject?this.$str("relation_to_subject_self","mod_perform"):this.participantInstance.core_relationship.name},currentUserIsSubject(){return null===this.participantInstance?null:this.participantInstance.core_relationship.idnumber===a.RELATIONSHIP_SUBJECT},participantInstanceDetails(){if(null===this.participantInstance)return[];const e=[this.$str("user_activities_print_created_on","mod_perform",this.createdAt),this.$str("user_activities_print_overall_progress","mod_perform",this.getStatusText(this.participantInstance.subject_instance.progress_status)),this.$str("user_activities_print_your_progress","mod_perform",this.getStatusText(this.participantInstance.progress_status))];return this.dueDate&&e.push(this.$str("user_activities_print_due_date","mod_perform",this.dueDate)),e}},apollo:{participantSectionResponses:{query:y,variables(){return{participant_instance_id:this.participantInstanceId}},update:e=>e.mod_perform_participant_sections,result({data:e}){this.participantInstance=e.mod_perform_participant_instance}}},methods:{printActivity(){window.print()},getStatusText(e){switch(e){case"NOT_STARTED":return this.$str("user_activities_status_not_started","mod_perform");case"IN_PROGRESS":return this.$str("user_activities_status_in_progress","mod_perform");case"COMPLETE":return this.$str("user_activities_status_complete","mod_perform");case"PROGRESS_NOT_APPLICABLE":return this.$str("user_activities_status_not_applicable","mod_perform");case"NOT_SUBMITTED":return this.$str("user_activities_status_not_submitted","mod_perform");default:return""}},showPrintedTodo:(e,t)=>"CLOSED"!==e.availability_status&&(!!e.can_answer&&(t.is_respondable&&0===t.response_data_formatted_lines.length))}},b=(i("ojeY"),i("KHd+")),N=function(e){e.options.__langStrings={mod_perform:["add_your_response","print","relation_to_subject_self","section_element_response_optional","section_element_response_required","user_activities_complete_before","user_activities_print_created_on","user_activities_print_due_date","user_activities_print_overall_progress","user_activities_print_your_progress","user_activities_status_complete","user_activities_status_in_progress","user_activities_status_not_applicable","user_activities_status_not_started","user_activities_status_not_submitted"]}},F=Object(b.a)(S,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-participantContentPrint"},[i("Loader",{attrs:{loading:e.$apollo.loading}},[i("div",{staticClass:"tui-participantContentPrint__printedOnDate"},[e._v("\n      "+e._s(e.printedOnDate)+"\n    ")]),e._v(" "),e.subjectUser.card_display?i("ParticipantGeneralInformation",{staticClass:"tui-participantContentPrint__participantGeneralInformation",attrs:{"subject-user":e.subjectUser,"job-assignments":e.jobAssignments,"current-user-is-subject":e.currentUserIsSubject,relationship:e.relationshipToUser}}):e._e(),e._v(" "),i("div",{staticClass:"tui-participantContentPrint__header"},[i("h1",{staticClass:"tui-participantContentPrint__activityName"},[e._v("\n        "+e._s(e.activity.name)+"\n      ")]),e._v(" "),i("h2",{staticClass:"tui-participantContentPrint__activityType"},[e._v("\n        "+e._s(e.activity.type.display_name)+"\n      ")]),e._v(" "),i("p",{staticClass:"tui-participantContentPrint__instanceDetails"},e._l(e.participantInstanceDetails,(function(t,n){return i("span",{key:n,staticClass:"tui-participantContentPrint__instanceDetails-detail"},[e._v(e._s(t))])})),0)]),e._v(" "),i("div",{staticClass:"tui-participantContentPrint__legendKey"},[i("div",[i("RequiredOptionalIndicator",{attrs:{"is-required":""}}),e._v("\n        "+e._s(e.$str("section_element_response_required","mod_perform"))+"\n      ")],1),e._v(" "),i("div",[i("PrintedTodoIcon",{staticClass:"tui-participantContentPrint__printedTodo"}),e._v("\n        "+e._s(e.$str("add_your_response","mod_perform"))+"\n      ")],1)]),e._v(" "),e._l(e.participantSectionResponses,(function(t){return i("div",{key:t.id,staticClass:"tui-participantContentPrint__section"},[e.activity.settings.multisection?i("h3",{staticClass:"tui-participantContentPrint__sectionHeading"},[e._v("\n        "+e._s(t.section.display_title)+"\n      ")]):e._e(),e._v(" "),t.id in e.initialUniformValues?i("Uniform",{attrs:{"input-width":"full","initial-values":e.initialUniformValues[t.id]}},[i("div",{staticClass:"tui-participantContentPrint__sectionItems"},e._l(e.elementsResponsesBySection[t.id],(function(n){return i("div",{key:n.id,staticClass:"tui-participantContentPrint__sectionItem"},[e.showPrintedTodo(t,n)?i("PrintedTodoIcon",{staticClass:"tui-participantContentPrint__printedTodo"}):e._e(),e._v(" "),n.element.title?i("h3",{staticClass:"tui-participantContentPrint__sectionItem-contentHeader",attrs:{id:e.$id("title")}},[e._v("\n              "+e._s(n.element.title)+"\n            ")]):e._e(),e._v(" "),n.is_respondable?i("RequiredOptionalIndicator",{attrs:{"is-required":n.element.is_required}}):e._e(),e._v(" "),i("div",{staticClass:"tui-participantContentPrint__sectionItem-content"},[n.is_respondable&&t.can_answer?i("ElementParticipantForm",{attrs:{"from-print":n.is_respondable&&t.can_answer},scopedSlots:e._u([{key:"content",fn:function(){return["CLOSED"===t.availability_status?i(n.responseDisplayComponent,{tag:"component",staticClass:"tui-participantContentPrint__element tui-participantContentPrint__element--readOnly",attrs:{element:n.element,data:n.response_data,"response-lines":n.response_data_formatted_lines,"section-element-id":n.id,"participant-instance-id":e.participantInstanceId}}):i(n.printComponent,{tag:"component",staticClass:"tui-participantContentPrint__element",attrs:{element:n.element,path:["sectionElements",n.id],data:n.response_data,"response-lines":n.response_data_formatted_lines,"section-element-id":n.id,"participant-instance-id":e.participantInstanceId}})]},proxy:!0}],null,!0)}):e._e(),e._v(" "),i("OtherParticipantResponses",{staticClass:"tui-participantContentPrint__otherParticipantResponses",attrs:{"view-only":!1,"section-element":n,"anonymous-responses":e.activity.anonymous_responses}}),e._v(" "),n.is_respondable?e._e():i(n.printComponent,{tag:"component",staticClass:"tui-participantContentPrint__element",attrs:{element:n.element,path:["sectionElements",n.id],data:n.response_data,"response-lines":n.response_data_formatted_lines}})],1)],1)})),0)]):e._e()],1)})),e._v(" "),e.$apollo.loading?e._e():i("div",{staticClass:"tui-participantContentPrint__actionButtons"},[i("Button",{attrs:{text:e.$str("print","mod_perform")},on:{click:e.printActivity}})],1)],2)],1)}),[],!1,null,null,null);"function"==typeof N&&N(F),F.options.__hasBlocks={script:!0,template:!0};t.default=F.exports},"05h+":function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("nXMa"),r=i.n(s),o=i("tkAW"),l=i.n(o),d=i("u5iS"),c=i.n(d),u=i("VX2K"),m=i.n(u),_=i("G6cq"),p=i.n(_),v={components:{Button:a.a,CancelButton:r.a,Modal:l.a,ModalContent:c.a,Radio:m.a,RadioGroup:p.a},props:{currentUserId:{required:!0,type:Number},participantSections:{type:Array,required:!0},isForSection:{type:Boolean,required:!0},subjectUser:{type:Object,required:!0},viewUrl:{type:String,required:!0},value:{type:Boolean,required:!0}},data:()=>({relationshipToRespondAs:null,relationshipConfirmed:!1}),computed:{respondAsOptions(){return 0===this.participantSections.length?[]:this.filterToCurrentUser(this.participantSections)},selectedParticipantSection(){return this.getFirstSectionToParticipate(this.participantSections,this.relationshipToRespondAs)}},mounted(){this.relationshipToRespondAs=this.respondAsOptions.length>0?this.respondAsOptions[0].participant_instance.core_relationship.id:null},methods:{getFirstSectionToParticipate(e,t){t=void 0!==t?t:null;let i=null;return e.forEach(e=>{const n=e.participant_instance;if(!n.is_for_current_user)return;const a=n.core_relationship.id;null!==i||null!==t&&t!==a||(i=e)}),i},confirmRelationshipSelection(){if(this.relationshipConfirmed=!0,!this.selectedParticipantSection)throw"Selected section not found";window.location=this.$url(this.viewUrl,{participant_section_id:this.selectedParticipantSection.id})},getStatusText(e){switch(this.isForSection?e.progress_status:e.participant_instance.progress_status){case"NOT_STARTED":return this.$str("user_activities_status_not_started","mod_perform");case"IN_PROGRESS":return this.$str("user_activities_status_in_progress","mod_perform");case"COMPLETE":return this.$str("user_activities_status_complete","mod_perform");case"PROGRESS_NOT_APPLICABLE":return this.$str("user_activities_status_not_applicable_for_relationship_selector","mod_perform");default:return""}},filterToCurrentUser(e){let t=[];return e.filter(e=>{if(!e.participant_instance.is_for_current_user)return!1;const i=e.participant_instance.core_relationship.name;return-1===t.indexOf(i)&&(t.push(i),!0)})}}},f=i("KHd+"),g=function(e){e.options.__langStrings={mod_perform:["select_relationship_to_respond_as_explanation","select_relationship_to_respond_as_option","select_relationship_to_respond_as_title","user_activities_status_complete","user_activities_status_in_progress","user_activities_status_not_applicable_for_relationship_selector","user_activities_status_not_started"],core:["continue"]}},k=Object(f.a)(v,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{attrs:{"aria-labelledby":e.$id("select-relationship-title")}},[e.participantSections.length>0?i("ModalContent",{attrs:{title:e.$str("select_relationship_to_respond_as_title","mod_perform"),"title-id":e.$id("select-relationship-title"),"close-button":!1},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("continue","core"),disabled:!e.relationshipToRespondAs||e.relationshipConfirmed},on:{click:e.confirmRelationshipSelection}}),e._v(" "),i("CancelButton",{attrs:{disabled:e.relationshipConfirmed},on:{click:function(t){return e.$emit("input",!1)}}})]},proxy:!0}],null,!1,2152440641)},[i("p",{attrs:{id:e.$id("select-relationship-explanation")}},[e._v("\n      "+e._s(e.$str("select_relationship_to_respond_as_explanation","mod_perform",e.subjectUser.fullname))+"\n    ")]),e._v(" "),i("RadioGroup",{attrs:{required:"","aria-labelledby":e.$id("select-relationship-explanation")},model:{value:e.relationshipToRespondAs,callback:function(t){e.relationshipToRespondAs=t},expression:"relationshipToRespondAs"}},e._l(e.respondAsOptions,(function(t){return i("Radio",{key:t.participant_instance.core_relationship.id,attrs:{value:t.participant_instance.core_relationship.id,name:"relationshipToRespondAs"}},[e._v("\n        "+e._s(e.$str("select_relationship_to_respond_as_option","mod_perform",{relationship_name:t.participant_instance.core_relationship.name,progress_status:e.getStatusText(t)}))+"\n      ")])})),1)],1):e._e()],1)}),[],!1,null,null,null);"function"==typeof g&&g(k),k.options.__hasBlocks={script:!0,template:!0};t.default=k.exports},"0LUZ":function(e,t,i){"use strict";var n=i("5Eii");i.n(n).a},"0ngu":function(e,t,i){"use strict";i.r(t);var n=i("5h9J"),a=i.n(n),s=i("Eb8+"),r=i.n(s),o=i("Xuva"),l=i.n(o),d=i("mawr"),c=i.n(d),u=i("fqqR"),m=i.n(u),_=i("MhKF"),p=i.n(_),v=i("HT9l"),f=i.n(v);var g={components:{ButtonIcon:a.a,LockIcon:r.a,ParticipantOpenCloseActionModal:l.a,ParticipantAddIcon:p.a,SectionOpenCloseActionModal:c.a,SubjectOpenCloseActionModal:m.a,UnlockIcon:f.a},props:{reportType:{type:String},id:{type:String},isOpen:{type:Boolean},showActions:{type:Boolean,required:!1,default:!0},canAddParticipants:{type:Boolean}},data:()=>({showModalOpen:!1}),computed:{isSectionReport(){return"PARTICIPANT_SECTION"===this.reportType},isParticipantReport(){return"PARTICIPANT_INSTANCE"===this.reportType},isSubjectReport(){return"SUBJECT_INSTANCE"===this.reportType},participationManagementUrl(){return this.$url("/mod/perform/manage/participation/add_participants.php",{subject_instance_id:this.id})}},methods:{modalClose(){this.showModalOpen=!1},showModal(){this.showModalOpen=!0}}},k=i("KHd+"),h=function(e){e.options.__langStrings={mod_perform:["activity_participants_add","button_reopen","button_close"]}},y=Object(k.a)(g,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.isSubjectReport?i("SubjectOpenCloseActionModal",{attrs:{"modal-open":e.showModalOpen,"subject-instance-id":e.id,"is-open":e.isOpen,"report-type":e.reportType},on:{"modal-close":e.modalClose}}):e._e(),e._v(" "),e.isParticipantReport?i("ParticipantOpenCloseActionModal",{attrs:{"modal-open":e.showModalOpen,"participant-instance-id":e.id,"is-open":e.isOpen,"report-type":e.reportType},on:{"modal-close":e.modalClose}}):e._e(),e._v(" "),e.isSectionReport?i("SectionOpenCloseActionModal",{attrs:{"modal-open":e.showModalOpen,"participant-section-id":e.id,"is-open":e.isOpen,"report-type":e.reportType},on:{"modal-close":e.modalClose}}):e._e(),e._v(" "),e.isSubjectReport&&e.canAddParticipants?i("a",{attrs:{href:e.participationManagementUrl,title:e.$str("activity_participants_add","mod_perform")}},[i("ParticipantAddIcon")],1):e._e(),e._v(" "),e.showActions?[e.isOpen?i("ButtonIcon",{attrs:{"aria-label":e.$str("button_close","mod_perform"),styleclass:{transparentNoPadding:!0}},on:{click:function(t){return e.showModal()}}},[i("LockIcon")],1):i("ButtonIcon",{attrs:{"aria-label":e.$str("button_reopen","mod_perform"),styleclass:{transparentNoPadding:!0}},on:{click:function(t){return e.showModal()}}},[i("UnlockIcon")],1)]:e._e()],2)}),[],!1,null,null,null);"function"==typeof h&&h(y),y.options.__hasBlocks={script:!0,template:!0};t.default=y.exports},"12HA":function(e,t){e.exports=tui.require("tui/config")},"133O":function(e,t,i){"use strict";i.r(t);var n=i("KGot"),a=i.n(n),s=i("5qAA"),r=i.n(s),o=i("yikf"),l=i.n(o),d={components:{Cell:a.a,HeaderCell:r.a,Table:l.a},props:{otherHistoricActivities:{required:!0,type:Array}}},c=(i("2O0+"),i("KHd+")),u=function(e){e.options.__langStrings={mod_perform:["user_historic_activities_activity_title_header","user_historic_activities_type_header","user_historic_activities_user_header","user_historic_activities_relationship_to_header","user_historic_activities_status_header"]}},m=Object(c.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Table",{staticClass:"tui-performOtherHistoricActivityList",attrs:{data:e.otherHistoricActivities},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",{attrs:{size:"4"}},[e._v("\n      "+e._s(e.$str("user_historic_activities_activity_title_header","mod_perform"))+"\n    ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n      "+e._s(e.$str("user_historic_activities_type_header","mod_perform"))+"\n    ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n      "+e._s(e.$str("user_historic_activities_user_header","mod_perform"))+"\n    ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n      "+e._s(e.$str("user_historic_activities_relationship_to_header","mod_perform"))+"\n    ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n      "+e._s(e.$str("user_historic_activities_status_header","mod_perform"))+"\n    ")])]},proxy:!0},{key:"row",fn:function(t){var n=t.row;return[i("Cell",{attrs:{size:"4","column-header":e.$str("user_historic_activities_activity_title_header","mod_perform"),valign:"center"}},[i("a",{attrs:{href:n.activity_link}},[e._v("\n        "+e._s(n.activity_name)+"\n      ")])]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_historic_activities_type_header","mod_perform")}},[e._v("\n      "+e._s(n.type)+"\n    ")]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_historic_activities_user_header","mod_perform")}},[e._v("\n      "+e._s(n.subject_user)+"\n    ")]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_historic_activities_relationship_to_header","mod_perform")}},[e._v("\n      "+e._s(n.relationship_to)+"\n    ")]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_historic_activities_status_header","mod_perform"),valign:"center"}},[e._v("\n      "+e._s(n.status)+"\n    ")])]}}])})}),[],!1,null,null,null);"function"==typeof u&&u(m),m.options.__hasBlocks={script:!0,template:!0};t.default=m.exports},"1GJm":function(e,t,i){},"1NcW":function(e,t,i){"use strict";i.r(t);var n=i("C+/B"),a=i.n(n),s=i("nEm4"),r=i.n(s),o=i("i/kK"),l=i.n(o),d=i("vGF0"),c=i.n(d),u=i("zdti"),m=i.n(u),_=i("lOlL"),p=i.n(_),v=i("vyVp"),f=i("KxNG"),g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_toggle_activity_close_on_completion_setting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"toggle_activity_setting"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_toggle_activity_close_on_completion_setting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"close_on_completion"},arguments:[],directives:[]}]}}]}}]}}]},k={components:{ConfirmationModal:a.a,Form:r.a,FormRow:l.a,FormRowDetails:c.a,NotificationBanner:m.a,ToggleSwitch:p.a},props:{activity:{type:Object,required:!0}},data(){return{isSaving:!1,value:this.activity.settings.close_on_completion,modalOpen:!1}},computed:{isDraft(){return this.activity.state_details.name===f.ACTIVITY_STATUS_DRAFT},showWarning(){return null!=this.activity.settings.visibility_condition&&this.activity.settings.visibility_condition.value!==f.VISIBILITY_CONDITION_NONE&&!this.value}},methods:{valueChanged(){this.isDraft?this.save():this.modalOpen=!0},modalCancelled(){this.modalOpen=!1,this.value=!this.value},modalConfirmed(){this.modalOpen=!1,this.isSaving=!0,this.save()},save(){this.isSaving=!0,this.$apollo.mutate({mutation:g,variables:{input:{activity_id:this.activity.id,setting:this.value}},refetchAll:!1}).then(()=>{Object(v.notify)({message:this.$str("toast_success_activity_update","mod_perform"),type:"success"}),this.isSaving=!1;const e=Object.assign({},this.activity.settings,{close_on_completion:this.value}),t=Object.assign({},this.activity,{settings:e});this.$emit("change",t)}).catch(()=>{this.value=this.activity.settings.close_on_completion,Object(v.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"}),this.isSaving=!1})}}},h=(i("5tS9"),i("KHd+")),y=function(e){e.options.__langStrings={mod_perform:["automatic_closure_status_mismatch_warning","modal_confirm","workflow_automatic_closure_confirmation_title","workflow_automatic_closure_disabled_confirmation_text","workflow_automatic_closure_enabled_confirmation_text","workflow_automatic_closure_label","workflow_automatic_closure_label_help","workflow_automatic_closure_on_completion","workflow_automatic_closure_on_completion_help","workflow_settings","toast_error_generic_update","toast_success_activity_update"]}},S=Object(h.a)(k,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performActivityWorkflowSettings"},[i("h3",{staticClass:"tui-performActivityWorkflowSettings__heading"},[e._v("\n    "+e._s(e.$str("workflow_settings","mod_perform"))+"\n  ")]),e._v(" "),i("Form",[i("FormRow",{attrs:{label:e.$str("workflow_automatic_closure_label","mod_perform"),helpmsg:e.$str("workflow_automatic_closure_label_help","mod_perform")}},[i("ToggleSwitch",{attrs:{"aria-describedby":e.$id("aria-describedby"),disabled:e.isSaving,"toggle-first":!0,text:e.$str("workflow_automatic_closure_on_completion","mod_perform")},on:{input:e.valueChanged},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),e._v(" "),i("FormRowDetails",{attrs:{id:e.$id("aria-describedby")}},[e._v("\n        "+e._s(e.$str("workflow_automatic_closure_on_completion_help","mod_perform"))+"\n      ")])],1),e._v(" "),i("FormRow",[i("div",{staticClass:"tui-performActivityWorkflowSettings__warning"},[e.showWarning?i("NotificationBanner",{attrs:{type:"warning",message:e.$str("automatic_closure_status_mismatch_warning","mod_perform")}}):e._e()],1)])],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.modalOpen,title:e.$str("workflow_automatic_closure_confirmation_title","mod_perform"),"confirm-button-text":e.$str("modal_confirm","mod_perform")},on:{confirm:e.modalConfirmed,cancel:e.modalCancelled}},[e._v("\n    "+e._s(e.$str(e.value?"workflow_automatic_closure_enabled_confirmation_text":"workflow_automatic_closure_disabled_confirmation_text","mod_perform"))+"\n  ")])],1)}),[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0};t.default=S.exports},"1RJV":function(e,t,i){},"1SmC":function(e,t){e.exports=tui.require("tui/components/icons/PrintedTodo")},"1fSv":function(e,t,i){},"1fhJ":function(e,t,i){},"1i2V":function(e,t){e.exports=tui.require("tui/components/tabs/Tab")},"1m4o":function(e,t,i){},"29lC":function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/ActivitiesFilter")},"2CGV":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/AssignmentScheduleFrequencySettings")},"2LpK":function(e,t){e.exports=tui.require("mod_perform/components/activities_list/ActivityActions")},"2O0+":function(e,t,i){"use strict";var n=i("+kVI");i.n(n).a},"2QG0":function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("BN8m"),r=i.n(s),o=i("csKv"),l=i.n(o),d=i("WBvU"),c={components:{Button:a.a,ButtonGroup:r.a,FormCheckbox:d.FormCheckbox,FormRow:d.FormRow,FormRowStack:l.a,FormText:d.FormText,Uniform:d.Uniform},props:{initialValues:Object,settings:Object},mounted(){this.$el.scrollIntoView(),this.$el.querySelector("input").focus()},methods:{handleSubmit(e){let t=Object.assign({},e);delete t.identifier,delete t.responseRequired,delete t.rawTitle,this.$emit("update",{data:t,identifier:e.identifier,is_required:e.responseRequired,title:e.rawTitle})},onChange(e){this.$emit("change",e)},cancel(){this.$emit("cancel")}}},u=i("KHd+"),m=function(e){e.options.__langStrings={mod_perform:["button_cancel","button_save","question_title","reporting_id_help_text","reporting_identifier","section_element_response_required"]}},_=Object(u.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Uniform",{attrs:{"initial-values":e.initialValues,vertical:!0,"validation-mode":"submit","input-width":"full"},on:{change:e.onChange,submit:e.handleSubmit}},[i("FormRowStack",{attrs:{spacing:"large"}},[e.settings.has_title?i("FormRow",{attrs:{label:e.settings.title_text,required:e.settings.is_title_required}},[i("FormText",{attrs:{name:"rawTitle",validations:function(t){return e.settings.is_title_required?[t.required(),t.maxLength(1024)]:[t.maxLength(1024)]}}})],1):e._e(),e._v(" "),e._t("default"),e._v(" "),e.settings.has_reporting_id?i("FormRow",{attrs:{label:e.$str("reporting_identifier","mod_perform"),helpmsg:e.$str("reporting_id_help_text","mod_perform")}},[i("FormText",{attrs:{name:"identifier",validations:function(e){return[e.maxLength(1024)]},"char-length":"20"}})],1):e._e(),e._v(" "),e.settings.is_respondable?i("FormRow",[i("FormCheckbox",{attrs:{name:"responseRequired",disabled:!e.settings.is_response_required_enabled}},[e._v("\n        "+e._s(e.$str("section_element_response_required","mod_perform"))+"\n      ")])],1):e._e(),e._v(" "),i("FormRow",[i("ButtonGroup",[i("Button",{staticClass:"tui-performAdminCustomElementEdit__submit",attrs:{styleclass:{primary:!0,small:!0},text:e.$str("button_save","mod_perform"),type:"submit"}}),e._v(" "),i("Button",{attrs:{text:e.$str("button_cancel","mod_perform"),styleclass:{small:!0}},on:{click:function(t){return e.$emit("cancel")}}})],1)],1)],2)],1)}),[],!1,null,null,null);"function"==typeof m&&m(_),_.options.__hasBlocks={script:!0,template:!0};t.default=_.exports},"2a8T":function(e,t,i){"use strict";var n=i("8ivr");i.n(n).a},"2lg0":function(e,t,i){"use strict";var n=i("hyIR");i.n(n).a},"37B8":function(e,t){e.exports=tui.require("tui/components/icons/Preview")},"3YkY":function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("a0Gz"),r=i.n(s),o=i("g8/U"),l=i.n(o),d=i("W2cn"),c=i.n(d),u=i("1i2V"),m=i.n(u),_=i("txsu"),p=i.n(_),v=i("FSRe"),f=i.n(v),g=i("U1ho"),k=i.n(g),h=i("vyVp"),y={components:{Button:a.a,ManualParticipantsSelectionBanner:r.a,PageHeading:l.a,SelectActivityModal:c.a,Tab:m.a,Tabs:p.a,UserActivityList:f.a,UserHistoricActivityList:k.a},props:{currentUserId:{required:!0,type:Number},viewActivityUrl:{required:!0,type:String},printActivityUrl:{required:!0,type:String},showAboutOthersTab:{required:!0,type:Boolean},completionSaveSuccess:{required:!0,type:Boolean},closedOnCompletion:{type:Boolean,default:!1},requireManualParticipantsNotification:{type:Boolean,default:!1},canPotentiallyManageParticipants:{required:!0,type:Boolean},isHistoricActivitiesEnabled:{required:!0,type:Boolean},filterOptions:Object},data:()=>({openParticipationModal:!1}),computed:{initialTab(){return this.showAboutOthersTab?this.$id("activities-about-others-tab"):this.$id("your-activities-tab")}},mounted(){if(this.completionSaveSuccess){let e=this.closedOnCompletion?"toast_success_save_close_on_completion_response":"toast_success_save_response";this.showSuccessNotification(e,"mod_perform")}},methods:{showSuccessNotification(e,t){Object(h.notify)({message:this.$str(e,t),type:"success"})}}},S=(i("SI/l"),i("KHd+")),b=function(e){e.options.__langStrings={mod_perform:["manage_participation","toast_success_save_close_on_completion_response","toast_success_save_response","user_activities_activities_about_others_title","user_activities_historic_activities","user_activities_page_title","user_activities_your_activities_title"]}},N=Object(S.a)(y,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivities"},[i("PageHeading",{attrs:{title:e.$str("user_activities_page_title","mod_perform")},scopedSlots:e._u([e.canPotentiallyManageParticipants?{key:"buttons",fn:function(){return[i("Button",{attrs:{text:e.$str("manage_participation","mod_perform")},on:{click:function(t){e.openParticipationModal=!0}}})]},proxy:!0}:null],null,!0)}),e._v(" "),e.requireManualParticipantsNotification?i("ManualParticipantsSelectionBanner"):e._e(),e._v(" "),i("div",{staticClass:"tui-performUserActivities__content"},[i("Tabs",{attrs:{selected:e.initialTab}},[i("Tab",{attrs:{id:e.$id("your-activities-tab"),name:e.$str("user_activities_your_activities_title","mod_perform")}},[i("UserActivityList",{attrs:{about:"self","current-user-id":e.currentUserId,"view-url":e.viewActivityUrl,"print-url":e.printActivityUrl,"filter-options":e.filterOptions}})],1),e._v(" "),i("Tab",{attrs:{id:e.$id("activities-about-others-tab"),name:e.$str("user_activities_activities_about_others_title","mod_perform")}},[i("UserActivityList",{attrs:{about:"others","current-user-id":e.currentUserId,"view-url":e.viewActivityUrl,"print-url":e.printActivityUrl,"filter-options":e.filterOptions}})],1),e._v(" "),e.isHistoricActivitiesEnabled?i("Tab",{attrs:{id:e.$id("your-historic-activities-tab"),name:e.$str("user_activities_historic_activities","mod_perform")}},[i("UserHistoricActivityList",{attrs:{"current-user-id":e.currentUserId}})],1):e._e()],1)],1),e._v(" "),e.openParticipationModal?i("SelectActivityModal",{model:{value:e.openParticipationModal,callback:function(t){e.openParticipationModal=t},expression:"openParticipationModal"}}):e._e()],1)}),[],!1,null,null,null);"function"==typeof b&&b(N),N.options.__hasBlocks={script:!0,template:!0};t.default=N.exports},"3pwq":function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant_selector/ExternalUserSelector")},"3sQR":function(e,t){e.exports=tui.require("tui/components/dropdown/DropdownButton")},"49h4":function(e,t){e.exports=tui.require("tui/components/filters/SelectFilter")},"4HqM":function(e,t,i){"use strict";i.r(t);var n=i("hjaT"),a=i.n(n),s=i("NMGf"),r=i.n(s),o={components:{Checkbox:a.a,DeleteIcon:r.a},props:{participant:{type:Object,required:!0},editable:{type:Boolean,required:!0},isViewOnlyParticipant:{type:Boolean,default:!1}},data(){return{participant_can_view:this.getCanView()}},methods:{getCanView(){return this.participant.can_view},toggleCanViewOnParticipant(e){const t=Object.assign({},this.participant,{can_view:e});this.$emit("can-view-changed",t)},removeDisplayedParticipant(e){this.$emit("participant-removed",e)}}},l=(i("GxLD"),i("KHd+")),d=function(e){e.options.__langStrings={mod_perform:["activity_participant_can_view","delete_relationship"]}},c=Object(l.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performActivitySectionRelationship"},[e.editable?i("div",{staticClass:"tui-performActivitySectionRelationship__item"},[i("div",{staticClass:"tui-performActivitySectionRelationship__item-name"},[e._v("\n      "+e._s(e.participant.core_relationship.name)+"\n      "),i("DeleteIcon",{attrs:{"aria-label":e.$str("delete_relationship","mod_perform",e.participant.core_relationship.name)},on:{click:function(t){return e.removeDisplayedParticipant(e.participant)}}})],1),e._v(" "),e.isViewOnlyParticipant?e._e():i("div",{staticClass:"tui-performActivitySectionRelationship__item-options"},[i("Checkbox",{on:{change:e.toggleCanViewOnParticipant},model:{value:e.participant_can_view,callback:function(t){e.participant_can_view=t},expression:"participant_can_view"}},[e._v("\n        "+e._s(e.$str("activity_participant_can_view","mod_perform"))+"\n      ")])],1)]):i("p",{staticClass:"tui-performActivitySectionRelationship__item"},[e._v("\n    "+e._s(e.participant.core_relationship.name)+e._s(e.participant.can_view&&!e.isViewOnlyParticipant?"*":"")+"\n  ")])])}),[],!1,null,null,null);"function"==typeof d&&d(c),c.options.__hasBlocks={script:!0,template:!0};t.default=c.exports},"4S6I":function(e,t,i){},"4a1h":function(e,t,i){var n={"./Activities":"sr8J","./Activities.vue":"sr8J","./AddParticipants":"gRxV","./AddParticipants.vue":"gRxV","./ExternalUserActivityInvalid":"nlOa","./ExternalUserActivityInvalid.vue":"nlOa","./ExternalUserActivitySuccess":"qBWj","./ExternalUserActivitySuccess.vue":"qBWj","./ManageActivity":"PLpX","./ManageActivity.vue":"PLpX","./SectionContent":"hGI4","./SectionContent.vue":"hGI4","./UserActivities":"3YkY","./UserActivities.vue":"3YkY","./UserActivitiesSelectParticipants":"CQE9","./UserActivitiesSelectParticipants.vue":"CQE9","./UserActivity":"w57E","./UserActivity.vue":"w57E","./ViewOnlyUserActivity":"+EcL","./ViewOnlyUserActivity.vue":"+EcL"};function a(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="4a1h"},"4kbG":function(e,t,i){"use strict";var n=i("XMQU");i.n(n).a},"50ks":function(e,t){e.exports=tui.require("mod_perform/components/user_activities/layout/LayoutOneColumnSidePanelActivities")},"58sl":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivityContentTab")},"59Wj":function(e,t){e.exports=tui.require("tui/components/filters/FilterBar")},"5Ag4":function(e,t,i){},"5Eii":function(e,t,i){},"5h9J":function(e,t){e.exports=tui.require("tui/components/buttons/ButtonIcon")},"5qAA":function(e,t){e.exports=tui.require("tui/components/datatable/HeaderCell")},"5tS9":function(e,t,i){"use strict";var n=i("k1c4");i.n(n).a},"5xBH":function(e,t){e.exports=tui.require("tui/components/uniform/FormRadioGroup")},"62eV":function(e,t,i){"use strict";var n=i("dFEZ");i.n(n).a},"6K0l":function(e,t){e.exports=tui.require("mod_perform/components/report/element_response/QuestionElementPreviewModal")},"6Mwu":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/AssignmentsTab")},"6PIi":function(e,t,i){},"6aIU":function(e,t,i){"use strict";var n=i("iLf5");i.n(n).a},"6iqc":function(e,t,i){"use strict";var n=i("mhw/");i.n(n).a},"78NT":function(e,t,i){},"78jW":function(e,t,i){"use strict";i.r(t);var n=i("KxNG"),a=i("PNtU"),s={components:{Lozenge:i.n(a).a},props:{currentUserIsSubject:{type:Boolean,required:!0},visibleToRelationships:{type:Array,required:!0},activity:{type:Object,required:!0},participantSection:{type:Object,required:!0,validator:e=>null===e||e.progress_status}},computed:{notVisibleToAnyone(){return 0===this.visibleToRelationships.length||this.currentUserIsSubject&&this.visibleToSubjectOnly},visibleToSubjectOnly(){return 1===this.visibleToRelationships.length&&this.visibleToSubject},relationshipDescriptions(){return this.currentUserIsSubject?this.descriptionsForSubject:this.descriptionsForNonSubject},descriptionsForSubject(){return this.nonSubjectRelationships.map(e=>this.$str("response_visibility_your_relationship","mod_perform",e.name_plural))},descriptionsForNonSubject(){const e=[];this.visibleToSubject&&e.push(this.$str("response_visibility_the_employee","mod_perform"));const t=this.nonSubjectRelationships.map(e=>this.$str("response_visibility_the_employees_relationship","mod_perform",e.name_plural));return Array.prototype.push.apply(e,t),e},visibleToSubject(){return this.visibleToRelationships.some(e=>e.idnumber===n.RELATIONSHIP_SUBJECT)},nonSubjectRelationships(){return this.visibleToRelationships.filter(e=>e.idnumber!==n.RELATIONSHIP_SUBJECT)},anonymousResponses(){return this.activity.anonymous_responses},isViewOnlyParticipant(){return null!==this.participantSection&&this.participantSection.progress_status===n.PROGRESS_NOT_APPLICABLE}}},r=(i("IpuJ"),i("KHd+")),o=function(e){e.options.__langStrings={mod_perform:["response_visibility_label","response_visibility_view_only_lozenge","response_visibility_label_anonymous","response_visibility_not_visible_to_anyone","response_visibility_the_employee","response_visibility_the_employees_relationship","response_visibility_your_relationship"]}},l=Object(r.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-responsesAreVisibleToDescription"},[e.isViewOnlyParticipant?i("div",{staticClass:"tui-responsesAreVisibleToDescription__viewOnly"},[i("Lozenge",{staticClass:"tui-responsesAreVisibleToDescription__viewOnly-lozenge",attrs:{text:e.$str("response_visibility_view_only_lozenge","mod_perform"),type:"info"}}),e._v(" "),i("p",{staticClass:"tui-responsesAreVisibleToDescription__text"},[e._v("\n      "+e._s(e.activity.settings.visibility_condition.view_only_participant_description)+"\n    ")])],1):i("p",{staticClass:"tui-responsesAreVisibleToDescription__text"},[e.notVisibleToAnyone?[e._v("\n      "+e._s(e.$str("response_visibility_not_visible_to_anyone","mod_perform"))+"\n    ")]:[e.anonymousResponses?i("span",{domProps:{innerHTML:e._s(e.$str("response_visibility_label_anonymous","mod_perform"))}}):i("span",{domProps:{innerHTML:e._s(e.$str("response_visibility_label","mod_perform"))}}),e._v(" "),e._l(e.relationshipDescriptions,(function(t,n){return[i("span",{key:n,domProps:{innerHTML:e._s(t)}}),n+1!==e.relationshipDescriptions.length?[e._v(",\n        ")]:e._e()]}))]],2),e._v(" "),!e.isViewOnlyParticipant&&e.activity.settings.visibility_condition.participant_description?i("p",{staticClass:"tui-responsesAreVisibleToDescription__text"},[e._v("\n    "+e._s(e.activity.settings.visibility_condition.participant_description)+"\n  ")]):e._e()])}),[],!1,null,null,null);"function"==typeof o&&o(l),l.options.__hasBlocks={script:!0,template:!0};t.default=l.exports},"7tcR":function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/RelationshipSelector")},"81hr":function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("H/tB"),r=i.n(s),o={components:{Button:a.a},props:{extraFields:Array,htmlContent:String,identifier:String,isRequired:Boolean,isStatic:Boolean,settings:Object,title:{type:String,required:!0}},mounted(){this.$_scan()},updated(){this.$_scan()},methods:{$_scan(){this.$nextTick().then(()=>{let e=this.$refs.content;e&&r.a.scan(e)})}}},l=(i("+Y01"),i("KHd+")),d=function(e){e.options.__langStrings={mod_perform:["button_close","html_content_title","question_response_required_yes","question_response_required_no","section_element_response_required","reporting_identifier"]}},c=Object(l.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performAdminCustomElementSummary"},[i("div",{staticClass:"tui-performAdminCustomElementSummary__section"},[i("h4",{staticClass:"tui-performAdminCustomElementSummary__section-title"},[e._v("\n      "+e._s(e.settings.title_text)+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performAdminCustomElementSummary__section-value"},[e._v("\n      "+e._s(e.title)+"\n    ")])]),e._v(" "),e.htmlContent?i("div",{staticClass:"tui-performAdminCustomElementSummary__section"},[i("h4",{staticClass:"tui-performAdminCustomElementSummary__section-title"},[e._v("\n      "+e._s(e.$str("html_content_title","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performAdminCustomElementSummary__section-value"},[i("div",{ref:"content",domProps:{innerHTML:e._s(e.htmlContent)}})])]):e._e(),e._v(" "),e._l(e.extraFields,(function(t,n){return i("div",{key:n,staticClass:"tui-performAdminCustomElementSummary__section"},[i("h4",{staticClass:"tui-performAdminCustomElementSummary__section-title"},[e._v("\n      "+e._s(t.title)+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performAdminCustomElementSummary__section-value"},[t.options?e._l(t.options,(function(t,n){return i("div",{key:"option"+n},[e._v("\n          "+e._s(t.value)+"\n        ")])})):[e._v("\n        "+e._s(t.value)+"\n      ")]],2)])})),e._v(" "),e.settings.is_respondable?i("div",{staticClass:"tui-performAdminCustomElementSummary__section"},[i("h4",{staticClass:"tui-performAdminCustomElementSummary__section-title"},[e._v("\n      "+e._s(e.$str("section_element_response_required","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performAdminCustomElementSummary__section-value"},[e._v("\n      "+e._s(e.$str(e.isRequired?"question_response_required_yes":"question_response_required_no","mod_perform"))+"\n    ")])]):e._e(),e._v(" "),e.identifier?i("div",{staticClass:"tui-performAdminCustomElementSummary__section"},[i("h4",{staticClass:"tui-performAdminCustomElementSummary__section-title"},[e._v("\n      "+e._s(e.$str("reporting_identifier","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performAdminCustomElementSummary__section-value"},[e._v("\n      "+e._s(e.identifier)+"\n    ")])]):e._e(),e._v(" "),i("div",{staticClass:"tui-performAdminCustomElementSummary__button"},[i("Button",{attrs:{styleclass:{small:!0},text:e.$str("button_close","mod_perform")},on:{click:function(t){return e.$emit("display")}}})],1)],2)}),[],!1,null,null,null);"function"==typeof d&&d(c),c.options.__hasBlocks={script:!0,template:!0};t.default=c.exports},"8FGy":function(e,t,i){"use strict";i.r(t);var n=i("sYsA"),a=i.n(n),s=i("iycM"),r=i.n(s),o=i("iFIC"),l=i.n(o),d=i("WBvU"),c={components:{FieldArray:a.a,FormEmail:d.FormEmail,FormText:d.FormText,InputSet:r.a,Repeater:l.a},props:{name:{required:!0,type:String}}},u=i("KHd+"),m=function(e){e.options.__langStrings={mod_perform:["external_user_email","external_user_email_help","external_user_name","external_user_name_help"]}},_=Object(u.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("FieldArray",{attrs:{path:e.name},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.items,a=t.push,s=t.remove;return[i("Repeater",{attrs:{align:"start","row-align":"center",direction:"vertical",rows:n,"delete-icon":!0,"allow-deleting-first-items":!0},on:{add:function(e){return a({email:"",name:""})},remove:function(e,t){s(t),0===n.length&&a({email:"",name:""})}},scopedSlots:e._u([{key:"default",fn:function(t){t.row;var n=t.index;return[i("InputSet",{attrs:{split:"","stack-below":25,"char-length":30}},[i("FormText",{attrs:{name:[n,"name"],"aria-label":e.$str("external_user_name_help","mod_perform",n+1),placeholder:e.$str("external_user_name","mod_perform"),validations:function(e){return[e.required(),e.maxLength(255)]}}}),e._v(" "),i("FormEmail",{attrs:{name:[n,"email"],"aria-label":e.$str("external_user_email_help","mod_perform",n+1),placeholder:e.$str("external_user_email","mod_perform"),validations:function(e){return[e.required(),e.maxLength(100),e.email()]}}})],1)]}}],null,!0)})]}}])})}),[],!1,null,null,null);"function"==typeof m&&m(_),_.options.__hasBlocks={script:!0,template:!0};t.default=_.exports},"8fk4":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/AssignmentScheduleToggles")},"8ivr":function(e,t,i){},"8xsX":function(e,t,i){"use strict";var n=i("zRWw");i.n(n).a},"90VL":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/notification/NotificationsTab")},"9Afl":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivitySectionElementSummary")},"9G+f":function(e,t){e.exports=tui.require("tui/components/popover/Popover")},"9VzG":function(e,t,i){"use strict";var n=i("ejU1");i.n(n).a},"9gBu":function(e,t){e.exports=tui.require("tui/components/icons/DateRelative")},AhV7:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("jJ8l"),r=i.n(s),o=i("tkAW"),l=i.n(o),d=i("u5iS"),c=i.n(d),u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_element"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"element_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_element"},arguments:[{kind:"Argument",name:{kind:"Name",value:"element_id"},value:{kind:"Variable",name:{kind:"Name",value:"element_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]}]}}]}}]}}]},m=i("JXQf"),_=i.n(m),p=i("O8Ag"),v=i.n(p),f=i("a+Ln"),g=i.n(f),k={components:{Card:r.a,RequiredOptionalIndicator:g.a,Uniform:v.a,Loader:_.a,Button:a.a,Modal:l.a,ModalContent:c.a},props:{open:{type:Boolean},elementId:{type:Number,required:!0}},data:()=>({element:null}),computed:{component(){return null===this.element?null:tui.asyncComponent(this.element.element_plugin.participant_form_component)}},methods:{close(){this.$emit("modal-close")}},apollo:{element:{query:u,variables(){return{element_id:this.elementId}},update:e=>{const t=e.mod_perform_element;return Object.assign({},t,{data:JSON.parse(t.data)})}}}},h=i("KHd+"),y=function(e){e.options.__langStrings={mod_perform:["preview"],totara_core:["close"]}},S=Object(h.a)(k,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{staticClass:"tui-performQuestionPreviewModal",attrs:{size:"normal","aria-labelledby":e.$id("question-element-preview-modal")}},[i("ModalContent",{attrs:{title:e.$str("preview","mod_perform"),"title-id":e.$id("question-element-preview-modal"),"close-button":""},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("Button",{attrs:{text:e.$str("close","totara_core")},on:{click:e.close}})]},proxy:!0}])},[i("Loader",{attrs:{loading:e.$apollo.loading}},[e.element?i("Uniform",[i("p",[i("strong",[e._v(e._s(e.element.title))]),e._v(" "),e.element.is_respondable?i("RequiredOptionalIndicator",{attrs:{"is-required":e.element.is_required}}):e._e()],1),e._v(" "),i(e.component,{tag:"component",attrs:{path:"",element:e.element}})],1):e._e()],1)],1)],1)}),[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0};t.default=S.exports},"Aka+":function(e,t){e.exports=tui.require("mod_perform/components/element/ElementParticipantForm")},Aros:function(e,t){e.exports=tui.require("tui/components/tag/TagList")},Awxv:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/CreateActivityForm")},"BB+S":function(e,t,i){},BN8m:function(e,t){e.exports=tui.require("tui/components/buttons/ButtonGroup")},BaY1:function(e,t){e.exports=tui.require("tui/components/sidepanel/SidePanel")},"Bx/y":function(e,t){e.exports=tui.require("tui/components/icons/Download")},BxDI:function(e,t){e.exports=tui.require("tui/components/decor/Separator")},"C+/B":function(e,t){e.exports=tui.require("tui/components/modal/ConfirmationModal")},"C/Jh":function(e,t){e.exports=tui.require("tui/components/icons/Users")},C2Qw:function(e,t,i){"use strict";i.r(t);var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_participant_instance"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_participant_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"participant_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"subject_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]}]}}]}}]},a=i("/Ngp"),s=i.n(a),r=i("JXQf"),o=i.n(r),l={components:{InstanceInfoCard:s.a,Loader:o.a},props:{participantInstanceId:{type:Number,required:!0},showAllLink:{type:String,required:!0}},data:()=>({participantInstance:null}),computed:{infoLines(){return null===this.participantInstance?[]:[{label:this.$str("participant_instance_card_participant_full_name","mod_perform"),text:this.participantInstance.participant?this.participantInstance.participant.fullname:this.$str("hidden_anonymised","mod_perform")},{label:this.$str("instance_info_card_subject_full_name","mod_perform"),text:this.participantInstance.subject_instance.subject_user.fullname},{label:this.$str("participant_instance_card_relationship","mod_perform"),text:this.participantInstance.participant?this.participantInstance.core_relationship.name:this.$str("hidden_anonymised","mod_perform")},{label:this.$str("instance_info_card_creation_date","mod_perform"),text:this.participantInstance.created_at}]}},apollo:{participantInstance:{query:n,variables(){return{participant_instance_id:this.participantInstanceId}},update:e=>e.mod_perform_participant_instance}}},d=i("KHd+"),c=function(e){e.options.__langStrings={mod_perform:["hidden_anonymised","instance_info_card_subject_full_name","instance_info_card_creation_date","participant_instance_card_participant_full_name","participant_instance_card_relationship","participant_instance_card_title"]}},u=Object(d.a)(l,(function(){var e=this.$createElement,t=this._self._c||e;return t("Loader",{attrs:{loading:this.$apollo.loading}},[t("InstanceInfoCard",{attrs:{title:this.$str("participant_instance_card_title","mod_perform"),"info-lines":this.infoLines,"show-all-link":this.showAllLink}})],1)}),[],!1,null,null,null);"function"==typeof c&&c(u),u.options.__hasBlocks={script:!0,template:!0};t.default=u.exports},C4fs:function(e,t,i){"use strict";var n=i("mTJD");i.n(n).a},CQE9:function(e,t,i){"use strict";i.r(t);var n=i("SNFb"),a=i.n(n),s=i("h0pk"),r=i.n(s),o=i("bxeI"),l=i.n(o),d=i("zs4z"),c=i.n(d),u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_manual_participant_selection_instances"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manual_participant_selection_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subject_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"static_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"position"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"organisation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"manual_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_set_manual_participants"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participants"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_set_manual_participants_input"}}}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_set_manual_participants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}},{kind:"Argument",name:{kind:"Name",value:"participants"},value:{kind:"Variable",name:{kind:"Name",value:"participants"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"success"},arguments:[],directives:[]}]}}]}}]},_=i("vyVp"),p={components:{ActivityParticipants:a.a,JobAssignmentInformation:r.a,Layout:l.a,PageBackLink:c.a},props:{currentUserId:{required:!0,type:Number},userActivitiesUrl:{required:!0,type:String}},data:()=>({participantSelectionInstances:[],savingId:null}),apollo:{participantSelectionInstances:{query:u,update:e=>e.mod_perform_manual_participant_selection_instances}},methods:{refetch(){this.$apollo.queries.participantSelectionInstances.refetch()},async submit(e,t){this.savingId=t;const i=e.map(e=>({manual_relationship_id:e.relationship_id,users:e.users}));try{await this.$apollo.mutate({mutation:m,variables:{subject_instance_id:t,participants:i}}),Object(_.notify)({message:this.$str("toast_success_participants_saved","mod_perform"),type:"success"})}catch(e){Object(_.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})}this.savingId=null,this.refetch()}}},v=(i("X/jl"),i("KHd+")),f=function(e){e.options.__langStrings={mod_perform:["back_to_all_activities","toast_error_generic_update","toast_success_participants_saved","user_activities_created_at","user_activities_select_participants_none","user_activities_select_participants_note","user_activities_select_participants_page_title"]}},g=Object(v.a)(p,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Layout",{staticClass:"tui-performUserActivitiesSelectParticipants",attrs:{loading:e.$apollo.loading,title:e.$str("user_activities_select_participants_page_title","mod_perform")},scopedSlots:e._u([{key:"content-nav",fn:function(){return[i("PageBackLink",{attrs:{link:e.$url(e.userActivitiesUrl),text:e.$str("back_to_all_activities","mod_perform")}})]},proxy:!0},{key:"content",fn:function(){return[e.$apollo.loading||e.participantSelectionInstances.length>0?i("div",{staticClass:"tui-performUserActivitiesSelectParticipants__content"},[i("div",[e._v("\n        "+e._s(e.$str("user_activities_select_participants_note","mod_perform"))+"\n      ")]),e._v(" "),e._l(e.participantSelectionInstances,(function(t){return i("ActivityParticipants",{key:t.subject_instance.id,attrs:{"subject-instance":t.subject_instance,relationships:t.manual_relationships,"require-input":!0,"is-saving":e.savingId===t.subject_instance.id},on:{submit:function(i){return e.submit(i,t.subject_instance.id)}},scopedSlots:e._u([{key:"meta",fn:function(){return[i("JobAssignmentInformation",{attrs:{"job-assignments":t.subject_instance.static_instances}}),e._v(" "),i("p",[e._v("\n            "+e._s(e.$str("user_activities_created_at","mod_perform",t.subject_instance.created_at))+"\n          ")])]},proxy:!0}],null,!0)})}))],2):i("div",[e._v("\n      "+e._s(e.$str("user_activities_select_participants_none","mod_perform"))+"\n    ")])]},proxy:!0}])})}),[],!1,null,null,null);"function"==typeof f&&f(g),g.options.__hasBlocks={script:!0,template:!0};t.default=g.exports},CQIp:function(e,t,i){},D31S:function(e,t){e.exports=tui.require("tui/components/modal/InformationModal")},D3AF:function(e,t){e.exports=tui.require("tui/components/adder/AudienceAdder")},D9If:function(e,t){e.exports=tui.require("tui/components/grid/GridItem")},DaLk:function(e,t){e.exports=tui.require("tui/components/drag_drop/Draggable")},DvNF:function(e,t){e.exports=tui.require("tui/components/icons/DateLimited")},E7bt:function(e,t){e.exports=tui.require("mod_perform/redirect")},EEfk:function(e,t,i){},"Eb8+":function(e,t){e.exports=tui.require("tui/components/icons/Lock")},EliJ:function(e,t,i){"use strict";i.r(t);var n=i("vyVp"),a=i("JXQf"),s=i.n(a),r=i("X1gS"),o=i.n(r),l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_notifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_notifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"class_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"trigger_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"triggers"},arguments:[],directives:[]}]}}]}}]},d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_toggle_notification"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_toggle_notification_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_toggle_notification"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notification"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"class_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"trigger_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"triggers"},arguments:[],directives:[]}]}}]}}]}}]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_toggle_notification_recipient"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_toggle_notification_recipient_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_toggle_notification_recipient"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notification"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"class_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"trigger_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"triggers"},arguments:[],directives:[]}]}}]}}]}}]},u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_notification_triggers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_update_notification_triggers_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_notification_triggers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"notification"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"recipients"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"active"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"triggers"},arguments:[],directives:[]}]}}]}}]}}]},m=i("TXEh"),_={components:{Loader:s.a,NotificationSection:o.a},props:{value:{type:Object,required:!0},tabIsActive:{type:Boolean,required:!0}},data:()=>({notifications:[],isLoading:!1,activityUpdated:!1,skipQuery:!0}),apollo:{notifications:{query:l,variables(){return{activity_id:this.value.id}},update:e=>e.mod_perform_notifications,skip(){return this.skipQuery&&!this.tabIsActive},fetchPolicy:"network-only"}},watch:{value(){this.activityUpdated=!0},tabIsActive(){this.skipQuery=!1,this.activityUpdated&&this.tabIsActive&&(this.$apollo.queries.notifications.refetch(),this.activityUpdated=!1)}},methods:{onUpdateTriggers:Object(m.debounce)((async function(e,t){try{await this.$apollo.mutate({mutation:u,variables:{input:{notification_id:e.id,values:t}}}),Object(n.notify)({message:this.$str("toast_success_activity_update","mod_perform"),type:"success"})}catch(e){throw Object(n.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"}),e}}),500,{leading:!0,trailing:!0}),async onToggleNotification(e,t){this.isLoading=!0;const{data:i}=await this.$apollo.mutate({mutation:d,variables:{input:{notification_id:e.id,active:t}}});this.updateNotification(i.mod_perform_toggle_notification),this.isLoading=!1},createNotificationIfNotExists:async e=>(console.warn("[NotificationsTab] createNotificationIfNotExists() is deprecated and should not be used.\nNotifications now always exist, so this will always return the ID of the notification."),e.id),async onToggleRecipient(e,t){this.isLoading=!0;const{data:i}=await this.$apollo.mutate({mutation:c,variables:{input:{notification_id:e.id,relationship_id:t.id,active:t.active}}});this.updateNotification(i.mod_perform_toggle_notification_recipient),this.isLoading=!1},updateNotification(e){this.notifications=this.notifications.map(t=>t.class_key===e.notification.class_key?e.notification:t)}}},p=(i("It7k"),i("KHd+")),v=function(e){e.options.__langStrings={mod_perform:["notification_active","manage_activities_tabs_notifications","toast_error_generic_update","toast_success_activity_update"]}},f=Object(p.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Loader",{attrs:{loading:e.$apollo.loading||e.isLoading}},[i("div",{staticClass:"tui-activityNotifications"},[i("h3",{staticClass:"tui-activityNotifications__header"},[i("span",{staticClass:"tui-activityNotifications__title"},[e._v(e._s(e.$str("manage_activities_tabs_notifications","mod_perform")))]),e._v(" "),i("span",{staticClass:"tui-activityNotifications__active",attrs:{"aria-hidden":"true"}},[e._v(e._s(e.$str("notification_active","mod_perform")))])]),e._v(" "),e._l(e.notifications,(function(t){return i("NotificationSection",{key:t.class_key,attrs:{data:t},on:{toggleNotification:e.onToggleNotification,toggleRecipient:e.onToggleRecipient,updateTriggers:e.onUpdateTriggers}})}))],2)])}),[],!1,null,null,null);"function"==typeof v&&v(f),f.options.__hasBlocks={script:!0,template:!0};t.default=f.exports},F6B7:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivitySectionRelationship")},FBvN:function(e,t){e.exports=tui.require("tui/components/filters/SearchFilter")},FONq:function(e,t,i){"use strict";i.r(t);var n=i("IqB1"),a=i.n(n),s=i("lOlL"),r=i.n(s),o=i("fkPW"),l=i.n(o),d=i("XDjs"),c=i.n(d),u=i("nEm4"),m=i.n(u),_=i("i/kK"),p=i.n(_),v={components:{Collapsible:a.a,ToggleSwitch:r.a,RecipientsTable:l.a,TriggersTable:c.a,Form:m.a,FormRow:p.a},props:{data:{required:!0,type:Object},preview:Object},data(){return{isSection:!0,expanded:this.data.active}}},f=(i("G/fF"),i("KHd+")),g=function(e){e.options.__langStrings={mod_perform:["no_recipients","recipients","toggle_notification","trigger_events"]}},k=Object(f.a)(v,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Collapsible",{staticClass:"tui-activityNotificationSettings",attrs:{label:e.data.name},scopedSlots:e._u([{key:"collapsible-side-content",fn:function(){return[i("div",{staticClass:"tui-activityNotificationSettings__toggle"},[i("ToggleSwitch",{staticClass:"tui-activityNotificationSettings__active",attrs:{text:"","aria-label":e.$str("toggle_notification","mod_perform",e.data.name),value:e.data.active},on:{input:function(t){return e.$emit("toggleNotification",e.data,t)}}})],1)]},proxy:!0}]),model:{value:e.expanded,callback:function(t){e.expanded=t},expression:"expanded"}},[e._v(" "),i("Form",{attrs:{"input-width":"full"}},[i("FormRow",{staticClass:"tui-activityNotificationsRecipients",attrs:{label:e.$str("recipients","mod_perform")}},[e.data.recipients.length?i("RecipientsTable",{attrs:{data:e.data.recipients,"class-key":e.data.class_key},on:{toggle:function(t){return e.$emit("toggleRecipient",e.data,t)}}}):i("div",[e._v(e._s(e.$str("no_recipients","mod_perform")))])],1),e._v(" "),e.data.trigger_label?i("FormRow",{attrs:{label:e.$str("trigger_events","mod_perform")}},[i("TriggersTable",{attrs:{data:e.data.triggers,label:e.data.trigger_label,"class-key":e.data.class_key},on:{input:function(t){return e.$emit("updateTriggers",e.data,t)}}})],1):e._e()],1)],1)}),[],!1,null,null,null);"function"==typeof g&&g(k),k.options.__hasBlocks={script:!0,template:!0};t.default=k.exports},FSRe:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/Activities")},FZHR:function(e,t,i){var n={"./constants":"jxQq","./constants.js":"jxQq","./redirect":"GSBk","./redirect.js":"GSBk"};function a(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="FZHR"},Fbz3:function(e,t,i){"use strict";i.r(t);var n=i("NAOU"),a=i.n(n),s=i("D9If"),r=i.n(s),o=i("JXQf"),l=i.n(o),d=i("g8/U"),c=i.n(d),u=i("dtfu"),m=i.n(u),_=i("BaY1"),p=i.n(_),v={components:{Grid:a.a,GridItem:r.a,Loader:l.a,PageHeading:c.a,Responsive:m.a,SidePanel:p.a},props:{flush:Boolean,loading:Boolean,outerFirstLoader:Boolean,title:{required:!0,type:String}},data:()=>({boundaryDefaults:{small:{gridDirection:"vertical",gridUnitsLeft:12,gridUnitsRight:12},medium:{gridDirection:"horizontal",gridUnitsLeft:3,gridUnitsRight:9},large:{gridDirection:"horizontal",gridUnitsLeft:2,gridUnitsRight:10}},currentBoundaryName:null,initialLoad:!0}),computed:{gridDirection(){if(this.currentBoundaryName)return this.boundaryDefaults[this.currentBoundaryName].gridDirection},gridUnitsLeft(){if(this.currentBoundaryName)return this.boundaryDefaults[this.currentBoundaryName].gridUnitsLeft},gridUnitsRight(){if(this.currentBoundaryName)return this.boundaryDefaults[this.currentBoundaryName].gridUnitsRight}},watch:{loading(){this.initialLoad=!1}},methods:{resize(e){this.currentBoundaryName=e}}},f=(i("mrdf"),i("KHd+")),g=Object(f.a)(v,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Loader",{attrs:{loading:e.outerFirstLoader&&e.loading&&e.initialLoad}},[i("div",{staticClass:"tui-layoutOneColumnSidePanelActivities",class:{"tui-layoutOneColumnSidePanelActivities--flush":e.flush}},[e._t("feedback-banner"),e._v(" "),e._t("user-overview"),e._v(" "),i("div",{staticClass:"tui-layoutOneColumnSidePanelActivities__heading"},[e._t("content-nav"),e._v(" "),i("PageHeading",{attrs:{title:e.title},scopedSlots:e._u([{key:"buttons",fn:function(){return[e._t("header-buttons")]},proxy:!0}],null,!0)})],2),e._v(" "),i("Responsive",{attrs:{breakpoints:[{name:"small",boundaries:[0,764]},{name:"medium",boundaries:[765,1192]},{name:"large",boundaries:[1193,1672]}]},on:{"responsive-resize":e.resize}},[i("Grid",{attrs:{direction:e.gridDirection,"stack-at":764}},[i("GridItem",{attrs:{units:e.gridUnitsLeft}},[i("SidePanel",{attrs:{flush:!1,"initially-open":!0,"show-button-control":!1,sticky:!1}},[e._t("side-panel")],2)],1),e._v(" "),i("GridItem",{attrs:{units:e.gridUnitsRight}},[i("Loader",{staticClass:"tui-layoutOneColumnSidePanelActivities__body",attrs:{loading:!e.initialLoad&&e.loading}},[e._t("content")],2)],1)],1)],1),e._v(" "),e._t("modals")],2)])}),[],!1,null,null,null);g.options.__hasBlocks={script:!0,template:!0};t.default=g.exports},"G/fF":function(e,t,i){"use strict";var n=i("OkVs");i.n(n).a},G0MF:function(e,t){e.exports=tui.require("mod_perform/components/activities_list/AdminActivityFilters")},G2sk:function(e,t,i){},G6cq:function(e,t){e.exports=tui.require("tui/components/form/RadioGroup")},GSBk:function(e,t,i){"use strict";function n(e,t){const i=document.createElement("form");i.style.display="hidden",i.action=e,i.method="post",Object.entries(t).forEach(e=>{const t=e[0],n=e[1],a=document.createElement("input");a.name=t,"boolean"==typeof n?(a.type="checkbox",a.checked=n):(a.type="text",a.value=n),i.appendChild(a)}),document.body.appendChild(i),i.submit()}i.r(t),i.d(t,"redirectWithPost",(function(){return n}))},GWNv:function(e,t){e.exports=tui.require("tui/components/icons/DateOpen")},GxLD:function(e,t,i){"use strict";var n=i("NSfp");i.n(n).a},Gyls:function(e,t,i){"use strict";i.r(t);var n=i("VX2K"),a=i.n(n),s=i("dCH5"),r=i.n(s),o=i("UbXC"),l=i.n(o),d=i("WBvU"),c={components:{FormRadioGroup:d.FormRadioGroup,FormRadioWithInput:d.FormRadioWithInput,FormRow:d.FormRow,FormRowStack:d.FormRowStack,FormScope:d.FormScope,Radio:a.a,RadioDateRange:r.a,RadioNumberInput:l.a},props:{isOpen:{type:Boolean,required:!0},isRepeating:{type:Boolean,required:!0}},computed:{title(){return this.isRepeating?this.$str("schedule_repeating_enabled_heading","mod_perform"):this.$str("schedule_repeating_disabled_heading","mod_perform")},noLimitLabel(){return this.isOpen?this.$str("schedule_repeating_limit_none_open_ended","mod_perform"):this.$str("schedule_repeating_limit_none","mod_perform")}},methods:{frequencyTriggerValidator(e){const t={},i=this.$str("schedule_repeating_date_min_value","mod_perform"),n=this.$str("schedule_repeating_date_error_value","mod_perform"),a=e.repeatingType,s=Number(e.repeatingOffset[a].value);if(e.repeatingLimit){const a=Number(e.repeatingLimit);Number.isInteger(a)?a<1&&(t.repeatingLimit=i):t.repeatingLimit=n}return Number.isInteger(s)?s<1&&(t.repeatingOffset={[a]:i}):t.repeatingOffset={[a]:n},t}}},u=(i("2a8T"),i("KHd+")),m=function(e){e.options.__langStrings={mod_perform:["schedule_repeating_date_error_value","schedule_repeating_date_min_value","schedule_repeating_disabled_heading","schedule_repeating_disabled_description","schedule_repeating_enabled_heading","schedule_repeating_enabled_description","schedule_repeating_every_time_after_completion","schedule_repeating_every_time_after_completion_a11y","schedule_repeating_every_time_after_creation_when_complete","schedule_repeating_every_time_after_creation_when_complete_a11y","schedule_repeating_every_time_since_creation","schedule_repeating_every_time_since_creation_a11y","schedule_repeating_limit_label","schedule_repeating_limit_maximum_of","schedule_repeating_limit_maximum_of_a11y","schedule_repeating_limit_none","schedule_repeating_limit_none_open_ended","trigger"]}},_=Object(u.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-assignmentScheduleFrequencySettings"},[i("h4",{staticClass:"tui-assignmentScheduleFrequencySettings__title"},[e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),i("div",{staticClass:"tui-assignmentScheduleFrequencySettings__description"},[e._v("\n    "+e._s(e.$str(e.isRepeating?"schedule_repeating_enabled_description":"schedule_repeating_disabled_description","mod_perform"))+"\n  ")]),e._v(" "),e.isRepeating?[i("FormScope",{attrs:{validate:e.frequencyTriggerValidator,path:"repeatingValues"}},[i("div",{staticClass:"tui-assignmentScheduleFrequencySettings__form"},[i("FormRowStack",[i("FormRow",{attrs:{label:e.$str("trigger","mod_perform")}},[i("FormRadioGroup",{attrs:{name:"repeatingType"}},[i("FormRadioWithInput",{attrs:{name:["repeatingOffset","creationOffset"],text:e.$str("schedule_repeating_every_time_since_creation","mod_perform"),value:"creationOffset"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.disabledRadio,a=t.nameLabel,s=t.setAccessibleLabel,r=t.update,o=t.value;return[i("RadioDateRange",{attrs:{disabled:n,name:a,value:o},on:{input:function(e){return r(e)},"accessible-change":function(t){return s(e.$str("schedule_repeating_every_time_since_creation_a11y","mod_perform",{range:t.range,value:t.value}))}}})]}}],null,!1,1494839747)}),e._v(" "),i("FormRadioWithInput",{attrs:{name:["repeatingOffset","creationWhenCompleteOffset"],text:e.$str("schedule_repeating_every_time_after_creation_when_complete","mod_perform"),value:"creationWhenCompleteOffset"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.disabledRadio,a=t.nameLabel,s=t.setAccessibleLabel,r=t.update,o=t.value;return[i("RadioDateRange",{attrs:{disabled:n,value:o,name:a},on:{input:function(e){return r(e)},"accessible-change":function(t){return s(e.$str("schedule_repeating_every_time_after_creation_when_complete_a11y","mod_perform",{range:t.range,value:t.value}))}}})]}}],null,!1,263779880)}),e._v(" "),i("FormRadioWithInput",{attrs:{name:["repeatingOffset","completeOffset"],text:e.$str("schedule_repeating_every_time_after_completion","mod_perform"),value:"completeOffset"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.disabledRadio,a=t.nameLabel,s=t.setAccessibleLabel,r=t.update,o=t.value;return[i("RadioDateRange",{attrs:{disabled:n,name:a,value:o},on:{input:function(e){return r(e)},"accessible-change":function(t){return s(e.$str("schedule_repeating_every_time_after_completion_a11y","mod_perform",{range:t.range,value:t.value}))}}})]}}],null,!1,2706689816)})],1)],1),e._v(" "),i("FormRow",{attrs:{label:e.$str("schedule_repeating_limit_label","mod_perform")}},[i("FormRadioGroup",{attrs:{name:"repeatingIsLimited"}},[i("Radio",{attrs:{value:!1}},[e._v("\n                "+e._s(e.noLimitLabel)+"\n              ")]),e._v(" "),i("FormRadioWithInput",{attrs:{name:["repeatingLimit"],text:e.$str("schedule_repeating_limit_maximum_of","mod_perform"),value:!0},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.disabledRadio,a=t.nameLabel,s=t.setAccessibleLabel,r=t.update,o=t.value;return[i("RadioNumberInput",{attrs:{disabled:n,name:a,value:o},on:{input:function(e){return r(e)},"accessible-change":function(t){return s(e.$str("schedule_repeating_limit_maximum_of_a11y","mod_perform",t))}}})]}}],null,!1,3354899432)})],1)],1)],1)],1)])]:e._e()],2)}),[],!1,null,null,null);"function"==typeof m&&m(_),_.options.__hasBlocks={script:!0,template:!0};t.default=_.exports},"H/tB":function(e,t){e.exports=tui.require("tui/tui")},HGXj:function(e,t){e.exports=tui.require("mod_perform/components/element/PerformAdminCustomElement")},HGaK:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivitySection")},HQOn:function(e,t,i){"use strict";i.r(t);var n=i("kUb+"),a=i.n(n),s=i("vF5l"),r=i.n(s),o=i("MAAM"),l=i.n(o),d=i("KxNG"),c={components:{ActionCard:a.a,Button:r.a,HelpIcon:l.a},props:{activity:{required:!0,type:Object},disabled:Boolean},data:()=>({ACTIVITY_STATUS_ACTIVE:d.ACTIVITY_STATUS_ACTIVE,ACTIVITY_STATUS_DRAFT:d.ACTIVITY_STATUS_DRAFT}),computed:{state(){return this.activity.state_details.name}}},u=(i("mn/Y"),i("KHd+")),m=function(e){e.options.__langStrings={mod_perform:["activation_criteria_assignments","activation_criteria_elements","activation_criteria_relationships","activation_criteria_schedule","activity_action_activate","activity_status_banner_active","activity_status_banner_draft","activity_status_banner_help_intro","activity_status_banner_help_title"]}},_=Object(u.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ActionCard",{scopedSlots:e._u([{key:"card-body",fn:function(){return[e.state===e.ACTIVITY_STATUS_DRAFT?[i("span",{domProps:{innerHTML:e._s(e.$str("activity_status_banner_draft","mod_perform"))}}),e._v(" "),i("HelpIcon",{staticClass:"tui-activityStatusBanner__helpIcon",attrs:{"icon-label":e.$str("activity_status_banner_help_title","mod_perform"),"desc-id":e.$id("activation-help")}},[i("p",[e._v(e._s(e.$str("activity_status_banner_help_intro","mod_perform")))]),e._v(" "),i("ul",[i("li",[e._v("\n            "+e._s(e.$str("activation_criteria_assignments","mod_perform"))+"\n          ")]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_elements","mod_perform")))]),e._v(" "),i("li",[e._v("\n            "+e._s(e.$str("activation_criteria_relationships","mod_perform"))+"\n          ")]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_schedule","mod_perform")))])])])]:e.state===e.ACTIVITY_STATUS_ACTIVE?i("span",{domProps:{innerHTML:e._s(e.$str("activity_status_banner_active","mod_perform"))}}):e._e()]},proxy:!0},e.activity.can_potentially_activate?{key:"card-action",fn:function(){return[i("Button",{attrs:{text:e.$str("activity_action_activate","mod_perform"),disabled:e.disabled},on:{click:function(t){return e.$emit("activate")}}})]},proxy:!0}:null],null,!0)})}),[],!1,null,null,null);"function"==typeof m&&m(_),_.options.__hasBlocks={script:!0,template:!0};t.default=_.exports},HT9l:function(e,t){e.exports=tui.require("tui/components/icons/Unlock")},IKbY:function(e,t,i){"use strict";var n=i("1m4o");i.n(n).a},IYAL:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/AssignmentScheduleAdditionalSettings")},IpuJ:function(e,t,i){"use strict";var n=i("vNE0");i.n(n).a},IqB1:function(e,t){e.exports=tui.require("tui/components/collapsible/Collapsible")},IrqF:function(e,t,i){},It7k:function(e,t,i){"use strict";var n=i("G2sk");i.n(n).a},J0b9:function(e,t,i){"use strict";i.r(t);i("swk3");var n=i("KHd+"),a=function(e){e.options.__langStrings={mod_perform:["no_response_submitted"]}},s=Object(n.a)({},(function(){var e=this.$createElement;return(this._self._c||e)("span",{staticClass:"tui-participantFormNoResponseSubmitted"},[this._v("\n  "+this._s(this.$str("no_response_submitted","mod_perform"))+"\n")])}),[],!1,null,null,null);"function"==typeof a&&a(s),s.options.__hasBlocks={script:!1,template:!0};t.default=s.exports},J5HE:function(e,t,i){"use strict";var n=i("iAar");i.n(n).a},JGbd:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant/ResponsesAreVisibleToDescription")},JLSV:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/WorkflowSettings")},JWZ4:function(e,t,i){},JXQf:function(e,t){e.exports=tui.require("tui/components/loading/Loader")},KGcv:function(e,t){e.exports=tui.require("tui/components/dropdown/DropdownItem")},KGot:function(e,t){e.exports=tui.require("tui/components/datatable/Cell")},"KHd+":function(e,t,i){"use strict";function n(e,t,i,n,a,s,r,o){var l,d="function"==typeof e?e.options:e;if(t&&(d.render=t,d.staticRenderFns=i,d._compiled=!0),n&&(d.functional=!0),s&&(d._scopeId="data-v-"+s),r?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},d._ssrRegister=l):a&&(l=o?function(){a.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(d.functional){d._injectStyles=l;var c=d.render;d.render=function(e,t){return l.call(t),c(e,t)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:d}}i.d(t,"a",(function(){return n}))},KRvX:function(e,t){e.exports=tui.require("tui/components/buttons/Submit")},KxNG:function(e,t){e.exports=tui.require("mod_perform/constants")},Ky4W:function(e,t){e.exports=tui.require("tui/components/icons/Calendar")},Lp7x:function(e,t,i){},Lrk7:function(e,t,i){"use strict";t.a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_subject_instance_for_participant"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_subject_instance_for_participant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"instance_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"close_on_completion"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"visibility_condition"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"view_only_participant_description"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"anonymous_responses"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"card_display"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"profile_picture_alt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_picture_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_fields"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"associate_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"job_assignment"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"static_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"managerja"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"position"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"organisation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}}]}}]}}]}},LxOS:function(e,t){e.exports=tui.require("tui/components/uniform/FormCheckbox")},MAAM:function(e,t){e.exports=tui.require("tui/components/form/HelpIcon")},MhKF:function(e,t){e.exports=tui.require("tui/components/icons/AddUser")},Mnur:function(e,t){e.exports=tui.require("tui/components/modal/ModalPresenter")},NAOU:function(e,t){e.exports=tui.require("tui/components/grid/Grid")},NMGf:function(e,t){e.exports=tui.require("tui/components/buttons/DeleteIcon")},NSfp:function(e,t,i){},Nou5:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/ActivityContentPrint")},O4KQ:function(e,t,i){"use strict";i.r(t);var n=i("+MEP"),a=i.n(n),s=i("h0pk"),r=i.n(s),o=i("NAOU"),l=i.n(o),d=i("D9If"),c=i.n(d),u={components:{MiniProfileCard:a.a,JobAssignmentInformation:r.a,Grid:l.a,GridItem:c.a},props:{subjectUser:{type:Object,required:!0},jobAssignments:Array,currentUserIsSubject:Boolean,relationship:String}},m=(i("OdRA"),i("KHd+")),_=function(e){e.options.__langStrings={mod_perform:["relation_to_subject_self_internal","user_activities_your_relationship_to_user_internal","user_activities_their_capacity","user_activities_your_capacity"]}},p=Object(m.a)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Grid",{staticClass:"tui-participantGeneralInformation",attrs:{"use-horizontal-gap":!1,"use-vertical-gap":!1,"max-units":12,"stack-at":600}},[i("GridItem",{attrs:{units:4}},[i("div",{staticClass:"tui-participantGeneralInformation__userDetails"},[i("MiniProfileCard",{attrs:{display:e.subjectUser.card_display,"label-id":e.$id("user-info"),"no-border":"","no-padding":"","read-only":""}})],1)]),e._v(" "),i("GridItem",{staticClass:"tui-participantGeneralInformation__rhs",attrs:{units:8}},[i("div",{staticClass:"tui-participantGeneralInformation__relationship"},[i("p",{staticClass:"tui-participantGeneralInformation__relationship-heading"},[e._v("\n        "+e._s(e.$str(e.currentUserIsSubject?"relation_to_subject_self_internal":"user_activities_your_relationship_to_user_internal","mod_perform"))+"\n        "),e.currentUserIsSubject?e._e():i("span",[e._v(e._s(e.relationship))])]),e._v(" "),i("div",{staticClass:"tui-participantGeneralInformation__relationship-toSubject"},[e.currentUserIsSubject&&e.jobAssignments&&e.jobAssignments.length>0?[e._v("\n          "+e._s(e.$str("user_activities_your_capacity","mod_perform"))+"\n        ")]:e._e(),e._v(" "),!e.currentUserIsSubject&&e.jobAssignments.length>0?[e._v("\n          "+e._s(e.$str("user_activities_their_capacity","mod_perform",e.subjectUser.fullname))+"\n        ")]:e._e()],2),e._v(" "),i("JobAssignmentInformation",{attrs:{"job-assignments":e.jobAssignments}})],1)])],1)}),[],!1,null,null,null);"function"==typeof _&&_(p),p.options.__hasBlocks={script:!0,template:!0};t.default=p.exports},O8Ag:function(e,t){e.exports=tui.require("tui/components/uniform/Uniform")},ONfz:function(e,t,i){"use strict";i.r(t);var n=i("kV+/"),a=i.n(n),s=i("/X/1"),r=i.n(s),o=i("Ky4W"),l=i.n(o),d=i("RbLc"),c=i.n(d),u=i("apvp"),m=i.n(u),_=i("UG3x"),p=i.n(_),v=i("hqJQ"),f=i.n(v),g=i("DvNF"),k=i.n(g),h=i("GWNv"),y=i.n(h),S=i("9gBu"),b=i.n(S),N={components:{CalendarIcon:l.a,DateDisabledIcon:c.a,DateEnabledIcon:m.a,DateFrequencyOnceIcon:p.a,DateFrequencyRepeatingIcon:f.a,DateLimitedIcon:k.a,DateOpenIcon:y.a,DateRelativeIcon:b.a,ToggleButton:a.a,ToggleSet:r.a},props:{value:{type:Object}},data:()=>({dueDateIsEnabled:!1,repeatingIsEnabled:!1,scheduleIsOpen:!1,scheduleIsFixed:!1}),watch:{value:{handler(){this.dueDateIsEnabled=this.value.dueDateIsEnabled,this.repeatingIsEnabled=this.value.repeatingIsEnabled,this.scheduleIsOpen=this.value.scheduleIsOpen,this.scheduleIsFixed=this.value.scheduleIsFixed},immediate:!0}},methods:{toggleChange(){this.$emit("input",{dueDateIsEnabled:this.dueDateIsEnabled,repeatingIsEnabled:this.repeatingIsEnabled,scheduleIsOpen:this.scheduleIsOpen,scheduleIsFixed:this.scheduleIsFixed})}}},F=(i("a6jG"),i("KHd+")),A=function(e){e.options.__langStrings={mod_perform:["activity_instance_creation_heading","due_date","due_date_is_disabled","due_date_is_enabled","schedule_creation_range","schedule_creation_date_type","schedule_creation_frequency","schedule_creation_frequency_once_off","schedule_creation_frequency_repeating","schedule_is_fixed","schedule_is_limited","schedule_is_open","schedule_is_relative"]}},C=Object(F.a)(N,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-assignmentScheduleToggles"},[i("div",{staticClass:"tui-assignmentScheduleToggles__group"},[i("div",{staticClass:"tui-assignmentScheduleToggles__item"},[i("h4",{staticClass:"tui-assignmentScheduleToggles__item-header"},[e._v("\n        "+e._s(e.$str("schedule_creation_range","mod_perform"))+"\n      ")]),e._v(" "),i("ToggleSet",{staticClass:"tui-assignmentScheduleToggles__item-toggle",attrs:{"aria-label":e.$str("schedule_creation_range","mod_perform"),large:!0},on:{input:e.toggleChange},model:{value:e.scheduleIsOpen,callback:function(t){e.scheduleIsOpen=t},expression:"scheduleIsOpen"}},[i("ToggleButton",{attrs:{value:!1,"aria-label":e.$str("schedule_is_limited","mod_perform"),text:e.$str("schedule_is_limited","mod_perform")}},[i("DateLimitedIcon")],1),e._v(" "),i("ToggleButton",{attrs:{value:!0,"aria-label":e.$str("schedule_is_open","mod_perform"),text:e.$str("schedule_is_open","mod_perform")}},[i("DateOpenIcon")],1)],1)],1),e._v(" "),i("div",{staticClass:"tui-assignmentScheduleToggles__item"},[i("h4",{staticClass:"tui-assignmentScheduleToggles__item-header"},[e._v("\n        "+e._s(e.$str("schedule_creation_date_type","mod_perform"))+"\n      ")]),e._v(" "),i("ToggleSet",{staticClass:"tui-assignmentScheduleToggles__item-toggle",attrs:{"aria-label":e.$str("schedule_creation_date_type","mod_perform"),large:!0},on:{input:e.toggleChange},model:{value:e.scheduleIsFixed,callback:function(t){e.scheduleIsFixed=t},expression:"scheduleIsFixed"}},[i("ToggleButton",{attrs:{value:!0,"aria-label":e.$str("schedule_is_fixed","mod_perform"),text:e.$str("schedule_is_fixed","mod_perform")}},[i("CalendarIcon")],1),e._v(" "),i("ToggleButton",{attrs:{value:!1,"aria-label":e.$str("schedule_is_relative","mod_perform"),text:e.$str("schedule_is_relative","mod_perform")}},[i("DateRelativeIcon")],1)],1)],1)]),e._v(" "),i("div",{staticClass:"tui-assignmentScheduleToggles__group"},[i("div",{staticClass:"tui-assignmentScheduleToggles__item"},[i("h4",{staticClass:"tui-assignmentScheduleToggles__item-header"},[e._v("\n        "+e._s(e.$str("schedule_creation_frequency","mod_perform"))+"\n      ")]),e._v(" "),i("ToggleSet",{staticClass:"tui-assignmentScheduleToggles__item-toggle",attrs:{"aria-label":e.$str("schedule_creation_frequency","mod_perform"),large:!0},on:{input:e.toggleChange},model:{value:e.repeatingIsEnabled,callback:function(t){e.repeatingIsEnabled=t},expression:"repeatingIsEnabled"}},[i("ToggleButton",{attrs:{value:!1,"aria-label":e.$str("schedule_creation_frequency_once_off","mod_perform"),text:e.$str("schedule_creation_frequency_once_off","mod_perform")}},[i("DateFrequencyOnceIcon")],1),e._v(" "),i("ToggleButton",{attrs:{value:!0,"aria-label":e.$str("schedule_creation_frequency_repeating","mod_perform"),text:e.$str("schedule_creation_frequency_repeating","mod_perform")}},[i("DateFrequencyRepeatingIcon")],1)],1)],1)]),e._v(" "),i("div",{staticClass:"tui-assignmentScheduleToggles__group"},[i("div",{staticClass:"tui-assignmentScheduleToggles__item"},[i("h4",{staticClass:"tui-assignmentScheduleToggles__item-header"},[e._v("\n        "+e._s(e.$str("due_date","mod_perform"))+"\n      ")]),e._v(" "),i("ToggleSet",{staticClass:"tui-assignmentScheduleToggles__item-toggle",attrs:{"aria-label":e.$str("due_date","mod_perform"),large:!0},on:{input:e.toggleChange},model:{value:e.dueDateIsEnabled,callback:function(t){e.dueDateIsEnabled=t},expression:"dueDateIsEnabled"}},[i("ToggleButton",{attrs:{value:!0,"aria-label":e.$str("due_date_is_enabled","mod_perform"),text:e.$str("due_date_is_enabled","mod_perform")}},[i("DateEnabledIcon")],1),e._v(" "),i("ToggleButton",{attrs:{value:!1,"aria-label":e.$str("due_date_is_disabled","mod_perform"),text:e.$str("due_date_is_disabled","mod_perform")}},[i("DateDisabledIcon")],1)],1)],1)])])}),[],!1,null,null,null);"function"==typeof A&&A(C),C.options.__hasBlocks={script:!0,template:!0};t.default=C.exports},"Oa7+":function(e,t,i){},Oct9:function(e,t,i){"use strict";var n=i("1GJm");i.n(n).a},OdRA:function(e,t,i){"use strict";var n=i("u/Qm");i.n(n).a},OgUY:function(e,t,i){"use strict";var n=i("6PIi");i.n(n).a},Oi9v:function(e,t){e.exports=tui.require("tui/components/adder/OrganisationAdder")},OiWw:function(e,t,i){"use strict";i.r(t);var n=i("VOnF"),a=i.n(n),s=i("iFIC"),r=i.n(s),o=i("nBTD"),l=i.n(o);function d(e){return e.length?e.map((t,i)=>(t*=1,isNaN(t)||t<1||t>365?"trigger_out_of_range":(e.indexOf(t)!==i||-1!==e.indexOf(t,i+1))&&"trigger_duplicates")):[]}var c={components:{InputNumber:a.a,Repeater:r.a,FieldError:l.a},props:{data:{type:Array,required:!0},classKey:{type:String,required:!0},label:String},data(){let e=this.data.slice();return{values:e.map(e=>1*e),errors:d(e)}},watch:{data(e){e=e.slice(),this.values=e.map(e=>1*e),this.update()}},methods:{onInput(e,t){this.values[e]=1*t,this.update()},async onAdd(){this.values.push(""),this.errors.push(!1),await this.$nextTick();let e=this.$el.querySelectorAll(".tui-activityNotificationsTrigger__input");e.length&&e[e.length-1].focus()},onRemove(e,t){this.values.length>0&&(this.values.splice(t,1),this.update())},update(){this.errors=d(this.values),this.errors.filter(e=>!1!==e).length||this.$emit("input",this.values.slice())}}},u=(i("diYH"),i("KHd+")),m=function(e){e.options.__langStrings={mod_perform:["trigger_events","trigger_duplicates","trigger_out_of_range","trigger_set"]}},_=Object(u.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-activityNotificationsTriggersTable"},[i("Repeater",{staticClass:"tui-activityNotificationsTriggers",attrs:{rows:e.values,"min-rows":1,"delete-icon":!0,"allow-deleting-first-items":!0,"aria-label":e.$str("trigger_events","mod_perform"),role:"region"},on:{add:e.onAdd,remove:e.onRemove},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row,a=t.index;return[i("div",{staticClass:"tui-activityNotificationsTrigger"},[i("div",{staticClass:"tui-activityNotificationsTrigger__field"},[i("div",{staticClass:"tui-activityNotificationsTrigger__value"},[i("InputNumber",{staticClass:"tui-activityNotificationsTrigger__input",attrs:{value:n,min:1,max:365,placeholder:e.$str("trigger_set","mod_perform"),"aria-labelledby":e.$id(a),name:"trigger-"+e.classKey+"["+a+"]",autocomplete:"off"},on:{input:function(t){return e.onInput(a,t)}}})],1),e._v(" "),i("span",{staticClass:"tui-activityNotificationsTrigger__format",attrs:{id:e.$id(a)}},[e._v(e._s(e.label))])]),e._v(" "),i("FieldError",{staticClass:"tui-activityNotificationsTrigger__error",attrs:{error:e.errors[a]?e.$str(e.errors[a],"mod_perform"):""}})],1)]}}])})],1)}),[],!1,null,null,null);"function"==typeof m&&m(_),_.options.__hasBlocks={script:!0,template:!0};t.default=_.exports},Oj5a:function(e,t){e.exports=tui.require("tui/components/sidepanel/SidePanelNavGroup")},OkVs:function(e,t,i){},PLpX:function(e,t,i){"use strict";i.r(t);var n=i("bOP/"),a=i.n(n),s=i("58sl"),r=i.n(s),o=i("dUjM"),l=i.n(o),d=i("6Mwu"),c=i.n(d),u=i("gNII"),m=i.n(u),_=i("bxeI"),p=i.n(_),v=i("90VL"),f=i.n(v),g=i("zs4z"),k=i.n(g),h=i("1i2V"),y=i.n(h),S=i("txsu"),b=i.n(S),N=i("vyVp"),F=i("TXEh"),A={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"edit_name"},name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"edit_description"},name:{kind:"Name",value:"description"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"anonymous_responses"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"can_potentially_activate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"raw_created_at"},name:{kind:"Name",value:"created_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_updated_at"},name:{kind:"Name",value:"updated_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"close_on_completion"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"visibility_condition"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"manual_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"manual_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"selector_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"visibility_condition_options"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]}]}}]}}]},C={components:{ActivateActivityModal:a.a,ActivityContentTab:r.a,ActivityStatusBanner:l.a,AssignmentsTab:c.a,GeneralInfoTab:m.a,Layout:p.a,NotificationsTab:f.a,PageBackLink:k.a,Tab:y.a,Tabs:b.a},props:{activityId:{required:!0,type:Number},goBackLink:{required:!0,type:String},activityClonedSuccess:Boolean,clonedActivityName:String},data(){return{activity:null,currentTabId:this.$id("content-tab"),tabs:[{id:this.$id("genral-info-tab"),component:"GeneralInfoTab",name:this.$str("manage_activities_tabs_general","mod_perform")},{id:this.$id("content-tab"),component:"ActivityContentTab",name:this.$str("manage_activities_tabs_content","mod_perform")},{id:this.$id("assignments-tab"),component:"AssignmentsTab",name:this.$str("manage_activities_tabs_assignment","mod_perform")},{id:this.$id("notifications-tab"),component:"NotificationsTab",name:this.$str("manage_activities_tabs_notifications","mod_perform")}],unsavedChanges:!1,showActivateModal:!1,activateModalLoading:!1}},computed:{activityState(){return this.activity?this.activity.state_details.name:null}},created(){this.showMutationSuccessNotification=Object(F.debounce)(this.showMutationSuccessNotification,500)},mounted(){this.activityClonedSuccess&&Object(N.notify)({message:this.$str("toast_success_activity_cloned","mod_perform",this.clonedActivityName),type:"success"})},apollo:{activity:{query:A,variables(){return{activity_id:this.activityId}},update:e=>e.mod_perform_activity}},methods:{changeTabRequest(e){if(this.unsavedChanges){const t=this.$str("unsaved_changes_warning","mod_perform");if(!window.confirm(t))return;this.currentTabId=e,this.unsavedChanges=!1}else this.currentTabId=e},refetch(){this.$apollo.queries.activity.refetch()},showMutationErrorNotification(){Object(N.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},showMutationSuccessNotification(){Object(N.notify)({message:this.$str("toast_success_activity_update","mod_perform"),type:"success"})},setUnsavedChanges(e){this.unsavedChanges=e},activateActivity(){if(this.unsavedChanges){const e=this.$str("unsaved_changes_warning","mod_perform");if(!window.confirm(e))return;this.showActivateModal=!0}else this.showActivateModal=!0},updateShowActivateModal(e){this.showActivateModal=e},uploadLoading(e){this.activateModalLoading=e}}},E=(i("9VzG"),i("KHd+")),I=function(e){e.options.__langStrings={mod_perform:["back_to_all_activities","manage_activities_tabs_assignment","manage_activities_tabs_content","manage_activities_tabs_general","manage_activities_tabs_notifications","toast_error_generic_update","toast_success_activity_cloned","toast_success_activity_update"]}},T=Object(E.a)(C,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Layout",{staticClass:"tui-performManageActivity",attrs:{loading:e.$apollo.loading,title:e.activity?e.activity.name:""},scopedSlots:e._u([{key:"content-nav",fn:function(){return[i("PageBackLink",{attrs:{link:e.goBackLink,text:e.$str("back_to_all_activities","mod_perform")}})]},proxy:!0},e.activity?{key:"content",fn:function(){return[i("div",{staticClass:"tui-performManageActivity__content"},[i("ActivityStatusBanner",{attrs:{activity:e.activity,disabled:e.activateModalLoading},on:{activate:e.activateActivity}}),e._v(" "),i("Tabs",{attrs:{selected:e.currentTabId,controlled:!0,"content-spacing":"large"},on:{input:e.changeTabRequest}},e._l(e.tabs,(function(t,n){var a=t.component,s=t.name,r=t.id;return i("Tab",{key:n,attrs:{id:r,name:s,"always-render":!0}},[i(a,{tag:"component",attrs:{"activity-id":e.activityId,"activity-state":e.activityState,"activity-context-id":parseInt(e.activity.context_id),"activity-has-unsaved-changes":e.unsavedChanges,"tab-is-active":r===e.currentTabId},on:{"unsaved-changes":e.setUnsavedChanges,"mutation-error":e.showMutationErrorNotification,"mutation-success":e.showMutationSuccessNotification},model:{value:e.activity,callback:function(t){e.activity=t},expression:"activity"}})],1)})),1),e._v(" "),i("ActivateActivityModal",{attrs:{activity:e.activity,"trigger-open":e.showActivateModal},on:{"close-activate-modal":e.updateShowActivateModal,"update-loading":e.uploadLoading,"unsaved-changes":e.setUnsavedChanges,refetch:e.refetch}})],1)]},proxy:!0}:null],null,!0)})}),[],!1,null,null,null);"function"==typeof I&&I(T),T.options.__hasBlocks={script:!0,template:!0};t.default=T.exports},PNFE:function(e,t){e.exports=tui.require("tui/components/icons/Add")},PNtU:function(e,t){e.exports=tui.require("tui/components/lozenge/Lozenge")},PT33:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("BN8m"),r=i.n(s),o=i("tkAW"),l=i.n(o),d=i("u5iS"),c=i.n(d),u=i("Mnur"),m=i.n(u),_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_manually_change_participant_section"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_manually_change_participant_section_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manually_change_participant_section"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]},p=i("vyVp"),v=i("E7bt"),f=i("KxNG"),g={components:{Button:a.a,ButtonGroup:r.a,Modal:l.a,ModalContent:c.a,ModalPresenter:m.a},props:{modalOpen:{type:Boolean},participantSectionId:{type:String},isOpen:{type:Boolean},reportType:{type:String}},methods:{modalClose(){this.$emit("modal-close")},showErrorNotification(){Object(p.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},async changeAvailability(){try{let e=this.isOpen?f.INSTANCE_AVAILABILITY_STATUS_CLOSED:f.INSTANCE_AVAILABILITY_STATUS_OPEN;await this.$apollo.mutate({mutation:_,variables:{input:{participant_section_id:this.participantSectionId,availability:e}}}),this.$emit("modal-close"),Object(v.redirectWithPost)(window.location,{is_open:!this.isOpen,report_type:this.reportType})}catch(e){this.showErrorNotification()}}}},k=i("KHd+"),h=function(e){e.options.__langStrings={mod_perform:["button_cancel","button_close","button_reopen","participant_section_close_title","participant_section_close_message","participant_section_reopen_title","participant_section_reopen_message"]}},y=Object(k.a)(g,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ModalPresenter",{attrs:{open:e.modalOpen},on:{"request-close":e.modalClose}},[i("Modal",{attrs:{size:"normal","aria-labelledby":e.$id("report_open_close")}},[i("ModalContent",{attrs:{title:e.$str(e.isOpen?"participant_section_close_title":"participant_section_reopen_title","mod_perform"),"title-id":e.$id("report_open_close")},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str(e.isOpen?"button_close":"button_reopen","mod_perform")},on:{click:function(t){return e.changeAvailability()}}}),e._v(" "),i("Button",{attrs:{text:e.$str("button_cancel","mod_perform")},on:{click:function(t){return e.modalClose()}}})],1)]},proxy:!0}])},[e.isOpen?[i("p",[e._v("\n          "+e._s(e.$str("participant_section_close_message","mod_perform"))+"\n        ")])]:[i("p",[e._v("\n          "+e._s(e.$str("participant_section_reopen_message","mod_perform"))+"\n        ")])]],2)],1)],1)}),[],!1,null,null,null);"function"==typeof h&&h(y),y.options.__hasBlocks={script:!0,template:!0};t.default=y.exports},PWCq:function(e,t,i){},PyqE:function(e,t,i){},QAyg:function(e,t,i){"use strict";var n=i("4S6I");i.n(n).a},QPJV:function(e,t,i){"use strict";i.r(t);var n=i("lOlL"),a={components:{ToggleSwitch:i.n(n).a},props:{data:{type:Array,required:!0},classKey:{type:String,required:!0}},methods:{onToggle(e,t){this.$emit("toggle",{id:e.relationship_id,active:t})}}},s=(i("8xsX"),i("KHd+")),r=function(e){e.options.__langStrings={mod_perform:["recipients"]}},o=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",{staticClass:"tui-activityNotificationsRecipientsTable",attrs:{"aria-label":e.$str("recipients","mod_perform")}},e._l(e.data,(function(t){return i("li",{key:t.relationship_id,staticClass:"tui-activityNotificationsRecipientsTable__row"},[i("ToggleSwitch",{attrs:{text:t.name,value:t.active,"toggle-first":!0},on:{input:function(i){return e.onToggle(t,i)}}})],1)})),0)}),[],!1,null,null,null);"function"==typeof r&&r(o),o.options.__hasBlocks={script:!0,template:!0};t.default=o.exports},Qfz1:function(e,t,i){"use strict";var n=i("IrqF");i.n(n).a},QhoR:function(e,t,i){"use strict";i.r(t);var n=i("Xi9X"),a={components:{Avatar:i.n(n).a},props:{userName:String,profilePicture:String,size:String}},s=(i("J5HE"),i("KHd+")),r=Object(s.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tui-participantUserHeader"},[t("Avatar",{staticClass:"tui-participantUserHeader__avatar",attrs:{src:this.profilePicture,size:this.size,alt:this.userName,"aria-hidden":!0}}),this._v(" "),t("div",{staticClass:"tui-participantUserHeader__name"},[this._v("\n    "+this._s(this.userName)+"\n  ")])],1)}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};t.default=r.exports},R0bL:function(e,t,i){"use strict";i.r(t);var n=i("TXEh"),a=i("KxNG"),s=i("E7bt"),r=i("vyVp"),o=i("12HA"),l=i("fCWf"),d=i.n(l),c=i("vF5l"),u=i.n(c),m=i("nXMa"),_=i.n(m),p=i("BN8m"),v=i.n(p),f=i("KRvX"),g=i.n(f),k=i("IqB1"),h=i.n(k),y=i("C+/B"),S=i.n(y),b=i("Aka+"),N=i.n(b),F=i("i/kK"),A=i.n(F),C=i("bxeI"),E=i.n(C),I=i("50ks"),T=i.n(I),x=i("JXQf"),O=i.n(x),w=i("zkRv"),$=i.n(w),D=i("zs4z"),R=i.n(D),j=i("g8/U"),q=i.n(j),P=i("s0yi"),M=i.n(P),B=i("a+Ln"),V=i.n(B),L=i("JGbd"),U=i.n(L),H=i("gH98"),G=i.n(H),K=i("o01z"),z=i.n(K),W=i("rjlk"),J=i.n(W),Y=i("Oj5a"),X=i.n(Y),Q=i("lOlL"),Z=i.n(Q),ee=i("WBvU"),te=i("+MEP"),ie=i.n(te),ne=i("qCQ6"),ae=i.n(ne),se={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_participant_section"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participant_section_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_participant_section"},arguments:[{kind:"Argument",name:{kind:"Name",value:"participant_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}}},{kind:"Argument",name:{kind:"Name",value:"participant_section_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_section_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"answerable_participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_element_responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_element_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_response_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"response_data_raw"},name:{kind:"Name",value:"response_data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validation_errors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"error_code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error_message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"responses_are_visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name_plural"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}}]}}]},re={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_view_only_section_responses"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"section_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_view_only_section_responses"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section_id"},value:{kind:"Variable",name:{kind:"Name",value:"section_id"}}},{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"siblings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"section_element_responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_element_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_response_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]},oe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_participant_section_external_participant_nosession"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"token"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"participant_section_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_participant_section_external_participant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"token"},value:{kind:"Variable",name:{kind:"Name",value:"token"}}},{kind:"Argument",name:{kind:"Name",value:"participant_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_instance_id"}}},{kind:"Argument",name:{kind:"Name",value:"participant_section_id"},value:{kind:"Variable",name:{kind:"Name",value:"participant_section_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"answerable_participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_element_responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_element_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_response_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"response_data_raw"},name:{kind:"Name",value:"response_data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validation_errors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"error_code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error_message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"responses_are_visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name_plural"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}}]}}]},le={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_section_responses"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_update_section_responses_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_section_responses"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"section_element_responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_element_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"response_data_raw"},name:{kind:"Name",value:"response_data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validation_errors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"error_code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error_message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}]},de={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_section_responses_external_participant_nosession"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_update_section_responses_external_participant_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_section_responses_external_participant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"section_element_responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_element_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"response_data_raw"},name:{kind:"Name",value:"response_data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"validation_errors"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"error_code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"error_message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"other_responder_groups"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"relationship_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"responses"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"response_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"response_data_formatted_lines"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"visible_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}}]}}]}}]}}]}}]}}]};var ce={components:{ActionLink:d.a,RequiredOptionalIndicator:V.a,Button:u.a,ButtonCancel:_.a,ButtonGroup:v.a,ButtonSubmit:g.a,Collapsible:h.a,ConfirmationModal:S.a,ElementParticipantForm:N.a,FormRow:A.a,Layout:E.a,LayoutSidePanel:T.a,Loader:O.a,OtherParticipantResponses:$.a,PageBackLink:R.a,PageHeading:q.a,ParticipantUserHeader:M.a,ResponsesAreVisibleToDescription:U.a,ResponseRelationshipSelector:G.a,SidePanelNav:z.a,SidePanelNavButtonItem:J.a,SidePanelNavGroup:X.a,ToggleSwitch:Z.a,Uniform:ee.Uniform,MiniProfileCard:ie.a,ParticipantGeneralInformation:ae.a},props:{activity:{required:!0,type:Object},createdAt:{type:String,required:!0},subjectUser:{required:!0,type:Object,validator:e=>["id","profileimageurlsmall","fullname"].every(Object.prototype.hasOwnProperty.bind(e))},currentUserId:{type:Number},userActivitiesUrl:{type:String},participantInstanceId:{type:Number},participantSectionId:{type:Number},subjectInstanceId:{type:Number},sectionId:{type:Number},token:{required:!1,type:String},jobAssignments:{type:Array,required:!0}},data(){return{answerableParticipantInstances:null,answeringAsParticipantId:this.participantInstanceId,activeParticipantSection:{},completionSaveSuccess:!1,errors:null,hasOtherResponse:!1,hasUnsavedChanges:!1,initialValues:null,isSaving:!1,section:{title:"",section_elements:[]},sectionElements:[],progressStatus:null,showOtherResponse:!1,modalOpen:!1,formValues:{},participantSections:[],siblingSections:[],hasChanges:!1,responsesAreVisibleTo:[],selectedRelationshipFilter:null,selectedParticipantSectionId:this.participantSectionId,selectedSectionId:this.selectedSectionId||null,isDraft:!1,checkboxGroupId:this.$id("label")}},computed:{viewOnlyReportMode(){return Boolean(this.subjectInstanceId)},participantCanAnswer(){return this.activeParticipantSection.can_answer},hasSaveDraft(){return"COMPLETE"!==this.progressStatus},navModel:{get(){if(this.viewOnlyReportMode){const e=this.siblingSections[0]||{};return this.selectedSectionId?this.selectedSectionId:e.id}return this.selectedParticipantSectionId},set(e){this.viewOnlyReportMode?this.selectedSectionId=e:this.selectedParticipantSectionId=e}},isExternalParticipant(){return!this.viewOnlyReportMode&&(null!==this.token&&this.token.length>0)},cleanedSectionElements(){return this.sectionElements.map(e=>{const t=Object.assign({},e);if(this.activity.anonymous_responses&&t.other_responder_groups.length>0){const e=this.sortMissingAnswersToEnd(t.other_responder_groups[0]);t.other_responder_groups=[e]}else this.selectedRelationshipFilter&&(t.other_responder_groups=t.other_responder_groups.filter(e=>e.relationship_name===this.selectedRelationshipFilter));return t})},noParticipantForRelationshipFilter(){return null!==this.selectedRelationshipFilter&&!this.cleanedSectionElements.some(e=>0!==e.other_responder_groups.length)},relationshipToUser(){return this.currentUserIsSubject?this.$str("relation_to_subject_self","mod_perform"):this.answeringAs?this.answeringAs.core_relationship.name:null},respondableSectionElements(){return this.sectionElements.filter(e=>e.is_respondable)},currentUserIsSubject(){return!this.isExternalParticipant&&null!=this.answeringAs&&this.answeringAs.core_relationship.idnumber===a.RELATIONSHIP_SUBJECT},activeSectionIsClosed(){return this.activeParticipantSection&&"CLOSED"===this.activeParticipantSection.availability_status},nextNavSectionModel(){const e=this.navModelSections[this.navModelIndex+1];return e?e.id:null},previousNavSectionModel(){const e=this.navModelSections[this.navModelIndex-1];return e?e.id:null},navModelIndex(){return this.navModelSections.findIndex(e=>e.id==this.navModel)},navModelSections(){return this.viewOnlyReportMode?this.siblingSections:this.participantSections},answeringAs(){return this.viewOnlyReportMode||null===this.answerableParticipantInstances?null:this.answerableParticipantInstances.find(e=>Number(e.id)===Number(this.answeringAsParticipantId))},currentRelationship(){return this.answeringAs?this.answeringAs.core_relationship.name:null},showSidePanel(){return this.activity.settings.multisection},backToUserReportHref(){return this.$url("/mod/perform/reporting/performance/user.php",{subject_user_id:this.subjectUser.id})}},mounted(){window.addEventListener("beforeunload",this.unloadHandler),window.addEventListener("popstate",this.popstateHandler)},apollo:{section:{query(){return this.viewOnlyReportMode?re:this.isExternalParticipant?oe:se},variables(){return this.viewOnlyReportMode?{subject_instance_id:this.subjectInstanceId,section_id:this.selectedSectionId}:{participant_instance_id:this.answeringAsParticipantId,participant_section_id:this.selectedParticipantSectionId,token:this.token}},fetchPolicy:"network-only",update(e){return this.viewOnlyReportMode?e.mod_perform_view_only_section_responses.section:this.isExternalParticipant?e.mod_perform_participant_section_external_participant.section:e.mod_perform_participant_section.section},result({data:e}){let t;this.viewOnlyReportMode?(t=e.mod_perform_view_only_section_responses,this.siblingSections=t.siblings):(t=this.isExternalParticipant?e.mod_perform_participant_section_external_participant:e.mod_perform_participant_section,t.id!=this.selectedParticipantSectionId&&(this.selectedParticipantSectionId=t.id),this.answerableParticipantInstances=t.answerable_participant_instances,this.activeParticipantSection=t,this.participantSections=t.participant_instance.participant_sections,this.progressStatus=t.progress_status,this.responsesAreVisibleTo=t.responses_are_visible_to),this.formValues={},this.initialValues={sectionElements:{}},this.sectionElements=t.section_element_responses.map(e=>{let t=null;return e.element.is_respondable&&(t=tui.asyncComponent(e.element.element_plugin.participant_response_component)),{id:e.section_element_id,clientId:Object(n.uniqueId)(),formComponent:tui.asyncComponent(e.element.element_plugin.participant_form_component),responseDisplayComponent:t,element:{type:e.element.element_plugin,title:e.element.title,identifier:e.element.identifier,data:JSON.parse(e.element.data),is_required:e.element.is_required,responseData:null},sort_order:e.sort_order,is_respondable:e.element.is_respondable,response_data:this.viewOnlyReportMode?null:JSON.parse(e.response_data),response_data_formatted_lines:this.viewOnlyReportMode?[]:e.response_data_formatted_lines,other_responder_groups:e.other_responder_groups}}),!this.viewOnlyReportMode&&this.participantCanAnswer?t.section_element_responses.filter(e=>e.element.is_respondable).forEach(e=>{this.initialValues.sectionElements[e.section_element_id]={response:JSON.parse(e.response_data_raw)},this.hasOtherResponse=e.other_responder_groups.length>0,e.other_responder_groups.forEach(t=>{t.responses.length>0&&e.response_data&&(this.showOtherResponse=!0)})}):this.showOtherResponse=!0}}},methods:{sortMissingAnswersToEnd(e){const t=Object.assign({},e);return t.responses=t.responses.slice().sort(e=>null===e.response_data?1:-1),t},showErrorNotification(){Object(r.notify)({message:this.$str("toast_error_save_response","mod_perform"),type:"error"})},showSuccessNotification(){let e=this.activity.settings.close_on_completion?"toast_success_save_close_on_completion_response":"toast_success_save_response";this.isDraft&&(e="participant_section_draft_saved"),Object(r.notify)({message:this.$str(e,"mod_perform"),type:"success"})},handleSubmit(e){this.formValues=e,this.isDraft?(this.submit(this.formValues),this.hasUnsavedChanges=!1):this.modalOpen=!0},confirmModal(){this.submit(this.formValues),this.modalOpen=!1,this.hasUnsavedChanges=!1},cancelModal(){this.modalOpen=!1},async submit(e){this.errors&&(this.errors=null),this.sectionElements.forEach(t=>{t.element.responseData=e.sectionElements[t.id]}),this.isSaving=!0;try{const e=await this.save(),t=(this.isExternalParticipant?e.mod_perform_update_section_responses_external_participant:e.mod_perform_update_section_responses).participant_section;this.errors=t.section_element_responses.filter(e=>e.validation_errors).reduce((e,t)=>(t.validation_errors.forEach(i=>{null==e&&(e={}),e[t.section_element_id]=i.error_message}),e),null),this.errors||(this.isDraft?this.showSuccessNotification():this.nextNavSectionModel?(this.showSuccessNotification(),this.loadNextSection()):this.goBackToListCompletionSuccess())}catch(e){this.showErrorNotification()}this.isSaving=!1},async save(){const e=this.respondableSectionElements.map(e=>({section_element_id:e.id,response_data:JSON.stringify(e.element.responseData)}));let t={participant_section_id:this.activeParticipantSection.id,is_draft:this.isDraft,update:e};this.token&&(t.token=this.token);const{data:i}=await this.$apollo.mutate({mutation:this.isExternalParticipant?de:le,variables:{input:t},refetchAll:!1});return i},loadNextSection(){this.changeSection(this.nextNavSectionModel)},loadPreviousSection(){this.changeSection(this.previousNavSectionModel)},async reloadData(){await this.$apollo.queries.section.refetch()},getActivityTitle(){var e=this.activity.name.trim(),t=this.createdAt?this.createdAt.trim():"";return t?this.$str("activity_title_with_subject_creation_date","mod_perform",{title:e,date:t}):e},goBackToListCompletionSuccess(){const e=o.config.locale.language;if(this.isExternalParticipant)return void(window.location.href=this.$url("/mod/perform/activity/external.php?lang="+e,{success:1,token:this.token}));const t=this.$url("/mod/perform/activity/index.php");Object(s.redirectWithPost)(t,{show_about_others_tab:!this.currentUserIsSubject,completion_save_success:!0,closed_on_completion:this.activity.settings.close_on_completion})},goBackToListCancel(){const e=this.$url("/mod/perform/activity/index.php");Object(s.redirectWithPost)(e,{show_about_others_tab:!this.currentUserIsSubject,completion_save_success:!1})},handleChange(e){for(let t in this.initialValues.sectionElements){let i=e.sectionElements[t],n=JSON.stringify(this.initialValues.sectionElements[t]);if((null===i||!Object.values(i)[0]||0===Object.values(i)[0].length)&&(i=null),i=JSON.stringify(i),n!==i){this.hasUnsavedChanges=!0;break}this.hasUnsavedChanges=!1}},navChange({id:e}){this.changeSection(e)},changeSection(e){this.checkForUnsavedChanges()&&(this.navModel=e,this.updateUrl(),this.updateTitle(),this.reloadData())},checkForUnsavedChanges(){if(this.viewOnlyReportMode||!this.hasUnsavedChanges)return!0;const e=this.$str("unsaved_changes_warning","mod_perform");return window.confirm(e)?(this.hasUnsavedChanges=!1,!0):(this.selectedParticipantSectionId=this.activeParticipantSection.id,!1)},updateUrl(){const e={};this.viewOnlyReportMode?(e.subject_instance_id=this.subjectInstanceId,this.selectedSectionId&&(e.section_id=this.selectedSectionId)):e.participant_section_id=this.selectedParticipantSectionId;const t=Object(n.formatParams)(e),i=window.location.pathname+"?"+t;window.history.pushState(null,null,i)},updateTitle(){if(!this.activity.settings.multisection||this.viewOnlyReportMode)window.document.title=this.activity.name;else{const e=this.activeParticipantSection.participant_instance.participant_sections.find(e=>this.selectedParticipantSectionId===e.id);window.document.title=this.activity.name+" - "+e.section.display_title}},popstateHandler(){const e=this.viewOnlyReportMode?"section_id":"participant_section_id";let t=Object(n.getQueryStringParam)(e);this.viewOnlyReportMode&&!t&&(t=this.siblingSections[0].id),t?(this.navModel=t,this.reloadData()):window.location.reload()},unloadHandler(e){if(!this.hasUnsavedChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t},fullSubmit(e){this.isDraft=!1,e()},draftSubmit(e){this.isDraft=!0,e()}}},ue=(i("IKbY"),i("KHd+")),me=function(e){e.options.__langStrings={mod_perform:["activity_title_with_subject_creation_date","back_to_user_activities","button_close","next_section","previous_section","participant_section_button_draft","participant_section_draft_saved","relation_to_subject_self","section_element_response_optional","section_element_response_required","sections_header","selected_relationship_not_in_section","toast_error_save_response","toast_success_save_close_on_completion_response","toast_success_save_response","unsaved_changes_warning","user_activities_close_on_completion_submit_confirmation_message","user_activities_other_response_show","user_activities_submit_confirmation_message","user_activities_submit_confirmation_title","user_activities_your_relationship_to_user"],core:["submit"]}},_e=Object(ue.a)(ce,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(e.showSidePanel?"LayoutSidePanel":"Layout",{tag:"Component",staticClass:"tui-participantContent",attrs:{loading:e.$apollo.loading,title:e.getActivityTitle(),"outer-first-loader":!0},scopedSlots:e._u([{key:"content-nav",fn:function(){return[e.isExternalParticipant||e.viewOnlyReportMode?e._e():i("PageBackLink",{attrs:{link:e.$url(e.userActivitiesUrl),text:e.$str("back_to_user_activities","mod_perform")}})]},proxy:!0},{key:"user-overview",fn:function(){return[e.subjectUser.card_display&&!e.viewOnlyReportMode?i("ParticipantGeneralInformation",{attrs:{"subject-user":e.subjectUser,"job-assignments":e.jobAssignments,"current-user-is-subject":e.currentUserIsSubject,relationship:e.currentRelationship}}):i("div",{staticClass:"tui-participantContent__user"},[i("ParticipantUserHeader",{staticClass:"tui-participantContent__user-info",attrs:{"user-name":e.subjectUser.fullname,"profile-picture":e.subjectUser.profileimageurlsmall,size:"small"}}),e._v(" "),e.viewOnlyReportMode?i("ResponseRelationshipSelector",{attrs:{"anonymous-responses":e.activity.anonymous_responses,"subject-instance-id":e.subjectInstanceId},model:{value:e.selectedRelationshipFilter,callback:function(t){e.selectedRelationshipFilter=t},expression:"selectedRelationshipFilter"}}):i("div",{staticClass:"tui-participantContent__user-relationship"},[e._v("\n        "+e._s(e.$str("user_activities_your_relationship_to_user","mod_perform"))+"\n        "),i("h4",{staticClass:"tui-participantContent__user-relationshipValue"},[e._v("\n          "+e._s(e.relationshipToUser)+"\n        ")])])],1)]},proxy:!0},{key:"side-panel",fn:function(){return[i("SidePanelNav",{attrs:{"aria-label":!1},on:{change:e.navChange},model:{value:e.navModel,callback:function(t){e.navModel=t},expression:"navModel"}},[e.viewOnlyReportMode?i("SidePanelNavGroup",{attrs:{title:e.$str("sections_header","mod_perform")}},e._l(e.siblingSections,(function(e){return i("SidePanelNavButtonItem",{key:e.id,attrs:{id:e.id,text:e.display_title}})})),1):i("SidePanelNavGroup",{attrs:{title:e.$str("sections_header","mod_perform")}},e._l(e.participantSections,(function(e){return i("SidePanelNavButtonItem",{key:e.id,attrs:{id:e.id,text:e.section.display_title}})})),1)],1)]},proxy:!0},{key:"content",fn:function(){return[e.initialValues?i("Uniform",{key:e.activeParticipantSection.id,staticClass:"tui-participantContent__form",attrs:{"initial-values":e.initialValues},on:{submit:e.handleSubmit,change:e.handleChange},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.getSubmitting;return[i("div",{staticClass:"tui-participantContent__section"},[i("div",{staticClass:"tui-participantContent__sectionHeading"},[e.activity.settings.multisection?i("h3",{staticClass:"tui-participantContent__sectionHeading-title"},[e._v("\n            "+e._s(e.section.display_title)+"\n          ")]):e._e(),e._v(" "),e.viewOnlyReportMode?e.noParticipantForRelationshipFilter?i("div",{staticClass:"tui-participantContent__sectionHeading-relationshipNotInSection"},[e._v("\n            "+e._s(e.$str("selected_relationship_not_in_section","mod_perform"))+"\n          ")]):e._e():i("div",{staticClass:"tui-participantContent__infoBar"},[i("ResponsesAreVisibleToDescription",{staticClass:"tui-participantContent__sectionHeadingOtherResponsesDescription",attrs:{"current-user-is-subject":e.currentUserIsSubject,"visible-to-relationships":e.responsesAreVisibleTo,activity:e.activity,"participant-section":e.activeParticipantSection}}),e._v(" "),i("div",{staticClass:"tui-participantContent__sectionHeading-otherResponseSwitch"},[e.hasOtherResponse&&e.participantCanAnswer?i("ToggleSwitch",{attrs:{text:e.$str("user_activities_other_response_show","mod_perform")},model:{value:e.showOtherResponse,callback:function(t){e.showOtherResponse=t},expression:"showOtherResponse"}}):e._e()],1)],1)]),e._v(" "),e.noParticipantForRelationshipFilter?e._e():[i("div",{staticClass:"tui-participantContent__section-requiredContainer"},[i("span",{staticClass:"tui-participantContent__section-responseRequired",domProps:{textContent:e._s("*")}}),e._v("\n            "+e._s(e.$str("section_element_response_required","mod_perform"))+"\n          ")]),e._v(" "),i("div",{staticClass:"tui-participantContent__sectionItems"},e._l(e.cleanedSectionElements,(function(t){return i("div",{key:t.id,staticClass:"tui-participantContent__sectionItem"},[t.element.title?i("h3",{staticClass:"tui-participantContent__sectionItem-contentHeader",attrs:{id:e.$id("title")}},[e._v("\n                "+e._s(t.element.title)+"\n\n                "),t.is_respondable?i("RequiredOptionalIndicator",{attrs:{"is-required":t.element.is_required}}):e._e()],1):e._e(),e._v(" "),i("div",{staticClass:"tui-participantContent__sectionItem-content"},[t.is_respondable&&e.participantCanAnswer&&!e.viewOnlyReportMode?i("ElementParticipantForm",{attrs:{"accessible-label":t.element.title,required:t.element.is_required,"aria-describedby":e.checkboxGroupId,"active-section-is-closed":e.activeSectionIsClosed},scopedSlots:e._u([{key:"content",fn:function(n){var a=n.labelId;return[e.activeSectionIsClosed?i(t.responseDisplayComponent,{tag:"component",attrs:{element:t.element,data:t.response_data,"response-lines":t.response_data_formatted_lines,"aria-labelledby":a,"label-id":e.checkboxGroupId}}):i(t.formComponent,{tag:"component",attrs:{"is-draft":e.isDraft,element:t.element,path:["sectionElements",t.id],error:e.errors&&e.errors[t.id],"aria-labelledby":a,"label-id":e.checkboxGroupId,"section-element-id":t.id,"participant-instance-id":e.participantInstanceId,"is-external-participant":e.isExternalParticipant}})]}}],null,!0)}):t.is_respondable?e._e():i("div",{staticClass:"tui-participantContent__staticElement"},[i(t.formComponent,{tag:"component",attrs:{"is-draft":e.isDraft,element:t.element,path:["sectionElements",t.id],error:e.errors&&e.errors[t.id],"section-element-id":t.id,"participant-instance-id":e.participantInstanceId,"is-external-participant":e.isExternalParticipant}})],1),e._v(" "),i("OtherParticipantResponses",{directives:[{name:"show",rawName:"v-show",value:e.showOtherResponse,expression:"showOtherResponse"}],attrs:{"view-only":e.viewOnlyReportMode,"section-element":t,"anonymous-responses":e.activity.anonymous_responses}})],1)])})),0)]],2),e._v(" "),i("FormRow",[e.activeSectionIsClosed||!e.participantCanAnswer||e.viewOnlyReportMode?e._e():i("ButtonGroup",{staticClass:"tui-participantContent__buttons"},[i("ButtonSubmit",{on:{click:function(t){return e.fullSubmit(n)}}}),e._v(" "),e.hasSaveDraft?i("Button",{attrs:{text:e.$str("participant_section_button_draft","mod_perform"),type:"submit"},on:{click:function(t){return e.draftSubmit(n)}}}):e._e(),e._v(" "),e.isExternalParticipant?e._e():i("ButtonCancel",{on:{click:e.goBackToListCancel}})],1)],1),e._v(" "),e.activeSectionIsClosed||!e.participantCanAnswer||e.viewOnlyReportMode?i("div",{staticClass:"tui-participantContent__navigation"},[i("div",[e.previousNavSectionModel?i("Button",{attrs:{text:e.$str("previous_section","mod_perform")},on:{click:e.loadPreviousSection}}):e._e()],1),e._v(" "),i("div",{staticClass:"tui-participantContent__navigation-buttons"},[e.nextNavSectionModel?i("Button",{attrs:{styleclass:{primary:"true"},text:e.$str("next_section","mod_perform")},on:{click:e.loadNextSection}}):e._e(),e._v(" "),e.isExternalParticipant||e.viewOnlyReportMode?e._e():i("Button",{attrs:{text:e.$str("button_close","mod_perform")},on:{click:e.goBackToListCancel}}),e._v(" "),e.viewOnlyReportMode?i("ActionLink",{attrs:{text:e.$str("button_close","mod_perform"),href:e.backToUserReportHref}}):e._e()],1)]):e._e()]}}],null,!1,3882307080)}):e._e()]},proxy:!0},{key:"modals",fn:function(){return[i("ConfirmationModal",{attrs:{open:e.modalOpen,"confirm-button-text":e.$str("submit","core"),title:e.$str("user_activities_submit_confirmation_title","mod_perform")},on:{confirm:e.confirmModal,cancel:e.cancelModal}},[i("p",[e._v("\n        "+e._s(e.$str("user_activities_submit_confirmation_message","mod_perform"))+"\n      ")]),e._v(" "),e.activity.settings.close_on_completion?i("p",[e._v("\n        "+e._s(e.$str("user_activities_close_on_completion_submit_confirmation_message","mod_perform"))+"\n      ")]):e._e()])]},proxy:!0}])})}),[],!1,null,null,null);"function"==typeof me&&me(_e),_e.options.__hasBlocks={script:!0,template:!0};t.default=_e.exports},REqq:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/OtherHistoricActivities")},RFl9:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant_selector/UserSelector")},RbLc:function(e,t){e.exports=tui.require("tui/components/icons/DateDisabled")},Rgjc:function(e,t){e.exports=tui.require("tui/components/drag_drop/Droppable")},"SI/l":function(e,t,i){"use strict";var n=i("78NT");i.n(n).a},SNFb:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant_selector/ActivityParticipants")},"TFH/":function(e,t,i){"use strict";var n=i("p/9T");i.n(n).a},TXEh:function(e,t){e.exports=tui.require("tui/util")},TqL4:function(e,t,i){"use strict";i.r(t);var n=i("YMfc"),a={components:{Tag:i.n(n).a},props:{reportingIds:{type:Array,required:!0}}},s=(i("f056"),i("KHd+")),r=function(e){e.options.__langStrings={mod_perform:["element_identifier"]}},o=Object(s.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tui-performReportPerformanceReportingIdBanner"},[t("strong",[this._v(this._s(this.$str("element_identifier","mod_perform")))]),this._v(" "),this._l(this.reportingIds,(function(e){return t("Tag",{key:e,staticClass:"tui-performReportPerformanceReportingIdBanner__tag",attrs:{text:e}})}))],2)}),[],!1,null,null,null);"function"==typeof r&&r(o),o.options.__hasBlocks={script:!0,template:!0};t.default=o.exports},U1ho:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/HistoricActivities")},U3fo:function(e,t,i){},UB0E:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_reportable_activities"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_reportable_activities"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]},r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_reportable_element_identifiers"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_reportable_element_identifiers"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"identifier"},arguments:[],directives:[]}]}}]}}]},o=i("Aros"),l=i.n(o),d=i("BxDI"),c=i.n(d),u=i("WBvU"),m=i("JXQf"),_=i.n(m),p={components:{Button:a.a,Uniform:u.Uniform,FormRow:u.FormRow,FormSelect:u.FormSelect,Separator:c.a,TagList:l.a,Loader:_.a},props:{hasReportingIds:{type:Boolean,required:!0}},data:()=>({initialValues:{activity:null},tags:[],activities:[],elementIdentifiers:[],searchItem:""}),computed:{activityOptions(){const e=this.activities.map(e=>({id:e.id,label:e.name}));return e.unshift({id:null,label:this.$str("performance_report_select_activity_placeholder","mod_perform")}),e},reportingIds(){const e=this.elementIdentifiers.map(e=>({id:e.id,name:e.identifier})).filter(e=>!this.tags.some(t=>e.id===t.id));return this.searchItem?e.filter(e=>e.name.includes(this.searchItem)):e}},methods:{loadActivityReport(e){window.location=this.$url("/mod/perform/reporting/performance/activity.php",{activity_id:e.activity})},loadReportingIDReport(){const e=this.tags.map(e=>e.id);window.location=this.$url("/mod/perform/reporting/performance/element_identifier.php",{element_identifier:e.join(",")})},select(e){const{name:t,id:i}=e;this.tags.push({text:t,id:i}),this.searchItem=""},remove(e){this.tags=this.tags.filter(t=>t!==e)},filter(e){this.searchItem=e}},apollo:{activities:{query:s,update:e=>e.mod_perform_reportable_activities},elementIdentifiers:{query:r,update:e=>e.mod_perform_reportable_element_identifiers,skip(){return!this.hasReportingIds}}}},v=(i("Zbdl"),i("KHd+")),f=function(e){e.options.__langStrings={mod_perform:["performance_report_load_records","performance_report_load_records_divider","performance_report_select_activity","performance_report_select_activity_placeholder","performance_report_select_reporting_ids"]}},g=Object(v.a)(p,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performReportPerformanceResponseByContent"},[i("div",{staticClass:"tui-performReportPerformanceResponseByContent__activity"},[i("div",{staticClass:"tui-performReportPerformanceResponseByContent__heading"},[e._v("\n      "+e._s(e.$str("performance_report_select_activity","mod_perform"))+"\n    ")]),e._v(" "),i("Loader",{attrs:{loading:e.$apollo.loading}},[i("Uniform",{attrs:{vertical:!0,"initial-values":e.initialValues},on:{submit:e.loadActivityReport}},[i("FormRow",{attrs:{label:e.$str("performance_report_select_activity","mod_perform"),hidden:!0},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("FormSelect",{attrs:{id:n,name:"activity","aria-labelledby":n,"aria-describedby":e.$id("aria-describedby"),options:e.activityOptions,validations:function(e){return[e.required()]}}})]}}])}),e._v(" "),i("FormRow",[i("Button",{staticClass:"tui-performReportPerformanceResponseByContent__activity_button",attrs:{styleclass:{primary:!0},text:e.$str("performance_report_load_records","mod_perform"),type:"submit"}})],1)],1)],1)],1),e._v(" "),e.hasReportingIds?i("div",{staticClass:"tui-performReportPerformanceResponseByContent__divider"},[i("Separator",[e._v("\n      "+e._s(e.$str("performance_report_load_records_divider","mod_perform"))+"\n    ")])],1):e._e(),e._v(" "),e.hasReportingIds?i("div",{staticClass:"tui-performReportPerformanceResponseByContent__id"},[i("div",{staticClass:"tui-performReportPerformanceResponseByContent__heading"},[e._v("\n      "+e._s(e.$str("performance_report_select_reporting_ids","mod_perform"))+"\n    ")]),e._v(" "),i("Loader",{attrs:{loading:e.$apollo.loading}},[i("Uniform",{attrs:{vertical:!0},on:{submit:e.loadReportingIDReport}},[i("FormRow",{attrs:{label:e.$str("performance_report_select_reporting_ids","mod_perform"),hidden:!0},scopedSlots:e._u([{key:"default",fn:function(t){t.id;return[i("TagList",{attrs:{tags:e.tags,items:e.reportingIds,filter:e.searchItem},on:{select:e.select,remove:e.remove,filter:e.filter},scopedSlots:e._u([{key:"item",fn:function(t){t.index;var n=t.item;return[i("div",[i("p",[e._v(e._s(n.name))])])]}}],null,!0)})]}}],null,!1,1569802411)}),e._v(" "),i("FormRow",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("performance_report_load_records","mod_perform"),type:"submit"}})],1)],1)],1)],1):e._e()])}),[],!1,null,null,null);"function"==typeof f&&f(g),g.options.__hasBlocks={script:!0,template:!0};t.default=g.exports},UF8y:function(e,t,i){"use strict";i.r(t);var n={props:{jobAssignments:Array}},a=(i("4kbG"),i("KHd+")),s=function(e){e.options.__langStrings={mod_perform:["in_team"]}},r=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.jobAssignments?i("div",{staticClass:"tui-jobAssignment"},e._l(e.jobAssignments,(function(t,n){return i("p",{key:n,staticClass:"tui-jobAssignment__jobAssignmentDetails"},[[i("strong",{class:{"tui-jobAssignment__spacing":t.position}},[e._v(e._s(t.fullname))]),e._v(" "),t.position||!t.managerja&&!t.organisation?e._e():i("span",[e._v(",")])],e._v(" "),t.position?[e._v("\n      ("+e._s(t.position.fullname)+")\n      "),t.managerja||t.organisation?i("span",[e._v(",")]):e._e()]:e._e(),e._v(" "),t.managerja?[e._v("\n      "+e._s(e.$str("in_team","mod_perform",t.managerja.user.fullname))+"\n      "),t.organisation?i("span",[e._v(",")]):e._e()]:e._e(),e._v(" "),t.organisation?[e._v("\n      "+e._s(t.organisation.fullname)+"\n    ")]:e._e()],2)})),0):e._e()}),[],!1,null,null,null);"function"==typeof s&&s(r),r.options.__hasBlocks={script:!0,template:!0};t.default=r.exports},"UFn/":function(e,t,i){"use strict";var n=i("fLIY");i.n(n).a},UG3x:function(e,t){e.exports=tui.require("tui/components/icons/DateFrequencyOnce")},"URM+":function(e,t,i){"use strict";var n=i("JWZ4");i.n(n).a},UXb3:function(e,t,i){!function(){"use strict";"undefined"!=typeof tui&&tui._bundle.isLoaded("mod_perform")?console.warn('[tui bundle] The bundle "mod_perform" is already loaded, skipping initialisation.'):(tui._bundle.register("mod_perform"),tui._bundle.addModulesFromContext("mod_perform",i("FZHR")),tui._bundle.addModulesFromContext("mod_perform/components",i("msfZ")),tui._bundle.addModulesFromContext("mod_perform/pages",i("4a1h")))}()},UYTS:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("BN8m"),r=i.n(s),o=i("nEm4"),l=i.n(o),d=i("i/kK"),c=i.n(d),u=i("csKv"),m=i.n(u),_=i("oMuj"),p=i.n(_),v=i("zdti"),f=i.n(v),g=i("VX2K"),k=i.n(g),h=i("G6cq"),y=i.n(h),S=i("fw38"),b=i.n(S),N=i("ruKP"),F=i.n(N),A=i("lOlL"),C=i.n(A),E=i("KxNG"),I=i("+kGl"),T={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_manual_relationship_selector_options"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manual_relationship_selector_options"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]},x={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"description"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type_id"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"anonymous_responses"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_boolean"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"visibility_condition"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relationships"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_activity_manual_relationship_selection_input"}}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"with_relationships"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}},{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"description"},value:{kind:"Variable",name:{kind:"Name",value:"description"}}},{kind:"Argument",name:{kind:"Name",value:"type_id"},value:{kind:"Variable",name:{kind:"Name",value:"type_id"}}},{kind:"Argument",name:{kind:"Name",value:"anonymous_responses"},value:{kind:"Variable",name:{kind:"Name",value:"anonymous_responses"}}},{kind:"Argument",name:{kind:"Name",value:"visibility_condition"},value:{kind:"Variable",name:{kind:"Name",value:"visibility_condition"}}},{kind:"Argument",name:{kind:"Name",value:"relationships"},value:{kind:"Variable",name:{kind:"Name",value:"relationships"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"edit_name"},name:{kind:"Name",value:"name"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"edit_description"},name:{kind:"Name",value:"description"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"anonymous_responses"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"visibility_condition"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"close_on_completion"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"manual_relationships"},arguments:[],directives:[{kind:"Directive",name:{kind:"Name",value:"include"},arguments:[{kind:"Argument",name:{kind:"Name",value:"if"},value:{kind:"Variable",name:{kind:"Name",value:"with_relationships"}}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"manual_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"selector_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"context_id"},arguments:[],directives:[]}]}}]}}]}}]},O={components:{Button:a.a,ButtonGroup:r.a,Form:l.a,FormRow:c.a,FormRowStack:m.a,InputText:p.a,NotificationBanner:f.a,Radio:k.a,RadioGroup:y.a,Select:b.a,Textarea:F.a,ToggleSwitch:C.a},props:{value:{type:Object,required:!0,validator(e){let t=Object.keys(e);return t.includes("edit_name")&&t.includes("edit_description")&&t.includes("anonymous_responses")&&t.includes("manual_relationships")}},activityHasUnsavedChanges:Boolean},data(){return{form:{name:this.value.edit_name,description:this.value.edit_description,type_id:this.value.type.id,manualRelationshipSelections:this.getManualRelationshipSelections(),anonymousResponse:this.value&&this.value.anonymous_responses,visibilityConditionValue:this.value.settings.visibility_condition.value},activityTypes:[{id:this.value.type.id,label:this.value.type.display_name}],manualRelationshipOptions:this.value.manual_relationships.map(e=>({id:e.selector_relationship.id,label:e.selector_relationship.name})),isSaving:!1,mutationError:null}},computed:{hasNoTitle(){return!this.form.name||0===this.form.name.trim().length},isActive(){return!!this.value&&this.value.state_details.name===E.ACTIVITY_STATUS_ACTIVE},manualRelationships(){return this.value?this.value.manual_relationships.map(e=>({name:e.manual_relationship.name,id:e.manual_relationship.id,selector_relationship_id:e.selector_relationship.id,selector_relationship_name:e.selector_relationship.name})):[]},isAnonymousResponse(){return this.isActive?this.value.anonymous_responses:this.form.anonymousResponse},showWarning(){return null!==this.value.settings.visibility_condition.value&&this.value.settings.visibility_condition.value!==E.VISIBILITY_CONDITION_NONE&&!this.value.settings.close_on_completion},visibilityConditionOptions(){return this.value.visibility_condition_options.slice().sort((e,t)=>e.value-t.value)}},watch:{form:{deep:!0,handler(){this.handleChanges(this.hasUnsavedChanges())}}},created(){this.ACTIVITY_NAME_MAX_LENGTH=E.ACTIVITY_NAME_MAX_LENGTH},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},beforeDestroy(){window.removeEventListener("beforeunload",this.unloadHandler)},apollo:{activityTypes:{query:I.a,variables:()=>[],update:({mod_perform_activity_types:e})=>e.map(e=>({id:e.id,label:e.display_name})).sort((e,t)=>e.label.localeCompare(t.label))},manualRelationshipOptions:{query:T,variables(){return{activity_id:this.value.id}},update:({mod_perform_manual_relationship_selector_options:e})=>e.map(e=>({id:e.id,label:e.name}))}},methods:{getManualRelationshipSelections(){let e={};return this.value&&this.value.manual_relationships&&this.value.manual_relationships.forEach(t=>{e[t.manual_relationship.id]=t.selector_relationship.id}),e},async trySave(){this.isSaving=!0;try{const e=await this.save();this.updateActivity(e),this.handleChanges(!1),this.$emit("mutation-success",e)}catch(e){this.$emit("mutation-error",e)}this.isSaving=!1},async save(){let e=x,t={activity_id:this.value.id,name:this.form.name,description:this.form.description,with_relationships:!1};this.isActive||(this.value.anonymous_responses!==this.form.anonymousResponse&&(t.anonymous_responses=this.form.anonymousResponse),this.value.type.id!==this.form.type_id&&(t.type_id=this.form.type_id),this.hasChangesToRelationshipSelection()&&(t.with_relationships=!0,t.relationships=Object.keys(this.form.manualRelationshipSelections).map(e=>({manual_relationship_id:e,selector_relationship_id:this.form.manualRelationshipSelections[e]})))),this.value.settings.visibility_condition.value!=this.form.visibilityConditionValue&&(t.visibility_condition=this.form.visibilityConditionValue);const{data:i}=await this.$apollo.mutate({mutation:e,variables:t,refetchAll:!0});return i.mod_perform_update_activity.activity},activeToggleText(e){return e?this.$str("boolean_setting_text_enabled","mod_perform"):this.$str("boolean_setting_text_disabled","mod_perform")},hasUnsavedChanges(){return this.form.name!==this.value.edit_name||this.form.description!==this.value.edit_description||this.form.type_id!==this.value.type.id||this.form.anonymousResponse!==this.value.anonymous_responses||this.form.visibilityConditionValue!==this.value.settings.visibility_condition.value||this.hasChangesToRelationshipSelection()},hasChangesToRelationshipSelection(){return this.manualRelationships.some(e=>this.form.manualRelationshipSelections[e.id]!==e.selector_relationship_id)},updateActivity(e){let t=Object.assign({},this.value,e);this.$emit("input",t)},unloadHandler(e){if(!this.activityHasUnsavedChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t},resetChanges(){this.resetActivityChanges(),this.resetManualRelationshipChanges()},resetActivityChanges(){this.form.name=this.value.edit_name,this.form.description=this.value.edit_description,this.form.type_id=this.value.type.id,this.form.anonymousResponse=this.value.anonymous_responses},resetManualRelationshipChanges(){this.value.manual_relationships.map(e=>{this.form.manualRelationshipSelections[e.manual_relationship.id]=e.selector_relationship.id})},anonymityValueChanged(){this.form.anonymousResponse&&(this.form.visibilityConditionValue=E.VISIBILITY_CONDITION_ALL_PARTICIPANT_CLOSED)},handleChanges(e){this.$emit("unsaved-changes",e)}}},w=(i("QAyg"),i("KHd+")),$=function(e){e.options.__langStrings={mod_perform:["activity_general_tab_heading","activity_general_response_attribution_heading","activity_general_anonymous_responses_label","activity_general_anonymous_responses_label_help","boolean_setting_text_enabled","boolean_setting_text_disabled","general_info_label_activity_description","general_info_label_activity_title","general_info_label_activity_type","general_info_participant_selection_description","general_info_participant_selection_heading","save_changes","unsaved_changes_warning","visibility_condition_all_closed","visibility_condition_label","visibility_condition_label_help","visibility_condition_status_mismatch_warning"],core:["cancel"]}},D=Object(w.a)(O,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Form",{staticClass:"tui-performManageActivityGeneralInfo"},[i("FormRowStack",{attrs:{spacing:"large"}},[i("h3",{staticClass:"tui-performManageActivityGeneralInfo__heading"},[e._v("\n      "+e._s(e.$str("activity_general_tab_heading","mod_perform"))+"\n    ")]),e._v(" "),i("FormRow",{attrs:{label:e.$str("general_info_label_activity_title","mod_perform"),required:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("InputText",{attrs:{id:n,maxlength:e.ACTIVITY_NAME_MAX_LENGTH,"char-length":"50"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})]}}])}),e._v(" "),i("FormRow",{attrs:{label:e.$str("general_info_label_activity_description","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("Textarea",{attrs:{id:n,"char-length":"50",rows:4},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})]}}])}),e._v(" "),i("FormRow",{attrs:{label:e.$str("general_info_label_activity_type","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.id;return[i("div",[e.isActive?i("span",{staticClass:"tui-performManageActivityGeneralInfo"},[e._v(e._s(e.value.type.display_name))]):i("Select",{attrs:{id:n,"aria-labelledby":n,"aria-describedby":e.$id("aria-describedby"),options:e.activityTypes},model:{value:e.form.type_id,callback:function(t){e.$set(e.form,"type_id",t)},expression:"form.type_id"}})],1)]}}])})],1),e._v(" "),i("FormRowStack",{attrs:{spacing:"large"}},[i("h3",{staticClass:"tui-performManageActivityGeneralInfo__heading"},[e._v("\n      "+e._s(e.$str("activity_general_response_attribution_heading","mod_perform"))+"\n    ")]),e._v(" "),i("FormRow",{attrs:{label:e.$str("activity_general_anonymous_responses_label","mod_perform"),helpmsg:e.$str("activity_general_anonymous_responses_label_help","mod_perform")}},[i("div",[e.isActive?i("span",[e._v("\n          "+e._s(e.activeToggleText(e.value.anonymous_responses))+"\n        ")]):i("ToggleSwitch",{attrs:{"toggle-first":"","aria-label":e.$str("activity_general_anonymous_responses_label","mod_perform")},on:{input:e.anonymityValueChanged},model:{value:e.form.anonymousResponse,callback:function(t){e.$set(e.form,"anonymousResponse",t)},expression:"form.anonymousResponse"}})],1)]),e._v(" "),i("FormRow",{attrs:{label:e.$str("visibility_condition_label","mod_perform"),helpmsg:e.$str("visibility_condition_label_help","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.labelId;return[i("div",[e.isAnonymousResponse?i("span",[e._v("\n          "+e._s(e.$str("visibility_condition_all_closed","mod_perform"))+"\n        ")]):i("RadioGroup",{attrs:{"aria-labelledby":n},model:{value:e.form.visibilityConditionValue,callback:function(t){e.$set(e.form,"visibilityConditionValue",t)},expression:"form.visibilityConditionValue"}},e._l(e.visibilityConditionOptions,(function(t){return i("Radio",{key:t.value,attrs:{value:t.value}},[e._v("\n            "+e._s(t.name)+"\n          ")])})),1)],1)]}}])}),e._v(" "),e.showWarning?i("FormRow",[i("div",{staticClass:"tui-performManageActivityGeneralInfo__warning"},[i("NotificationBanner",{attrs:{type:"warning",message:e.$str("visibility_condition_status_mismatch_warning","mod_perform")}})],1)]):e._e()],1),e._v(" "),i("FormRowStack",{attrs:{spacing:"large"}},[i("h3",{staticClass:"tui-performManageActivityGeneralInfo__heading"},[e._v("\n      "+e._s(e.$str("general_info_participant_selection_heading","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performManageActivityGeneralInfo__description"},[e._v("\n      "+e._s(e.$str("general_info_participant_selection_description","mod_perform"))+"\n    ")]),e._v(" "),e._l(e.manualRelationships,(function(t){return i("FormRow",{key:t.id,attrs:{label:t.name},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.id;return[i("div",[e.isActive?i("span",[e._v("\n          "+e._s(t.selector_relationship_name)+"\n        ")]):i("Select",{attrs:{id:a,"aria-labelledby":a,"aria-label":t.name,"aria-describedby":e.$id("aria-describedby"),options:e.manualRelationshipOptions},model:{value:e.form.manualRelationshipSelections[t.id],callback:function(i){e.$set(e.form.manualRelationshipSelections,t.id,i)},expression:"form.manualRelationshipSelections[relationship.id]"}})],1)]}}],null,!0)})}))],2),e._v(" "),i("FormRow",{staticClass:"tui-performManageActivityGeneralInfo__buttons"},[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("save_changes","mod_perform"),disabled:e.isSaving||e.hasNoTitle,type:"submit"},on:{click:function(t){return t.preventDefault(),e.trySave(t)}}}),e._v(" "),i("Button",{attrs:{disabled:e.isSaving,text:e.$str("cancel","core")},on:{click:e.resetChanges}})],1)],1)],1)}),[],!1,null,null,null);"function"==typeof $&&$(D),D.options.__hasBlocks={script:!0,template:!0};t.default=D.exports},UbXC:function(e,t){e.exports=tui.require("tui/components/form/RadioNumberInput")},Uh6e:function(e,t,i){"use strict";var n=i("eYZS");i.n(n).a},"Uo+B":function(e,t,i){"use strict";var n=i("U3fo");i.n(n).a},Uz97:function(e,t){e.exports=tui.require("tui/components/icons/Settings")},UzeO:function(e,t){e.exports=tui.require("tui/components/adder/PositionAdder")},VOnF:function(e,t){e.exports=tui.require("tui/components/form/InputNumber")},VX2K:function(e,t){e.exports=tui.require("tui/components/form/Radio")},W2cn:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/participation/SelectActivityModal")},WBvU:function(e,t){e.exports=tui.require("tui/components/uniform")},WNR0:function(e,t,i){"use strict";var n=i("aW2t");i.n(n).a},WOU5:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("BN8m"),r=i.n(s),o=i("3pwq"),l=i.n(o),d=i("RFl9"),c=i.n(d),u=i("WBvU"),m=i("KxNG"),_={components:{Button:a.a,ButtonGroup:r.a,ExternalUserSelector:l.a,FormField:u.FormField,FormRow:u.FormRow,Uniform:u.Uniform,UserSelector:c.a},props:{subjectInstance:{required:!0,type:Object},relationships:{required:!0,type:Array},requireInput:{required:!0,type:Boolean},isSaving:{required:!0,type:Boolean},validate:{type:Function,default:null}},data(){return{initialValues:this.getInitialValues(),hasChanges:!1}},computed:{instanceTitle(){return this.$str("activity_title_for_subject","mod_perform",{activity:this.subjectInstance.activity.name,user:this.subjectInstance.subject_user.fullname})}},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},beforeDestroy(){window.removeEventListener("beforeunload",this.unloadHandler)},methods:{isExternal(e){return isNaN(e)||(e=this.relationships.find(t=>t.id===e)),e.idnumber===m.RELATIONSHIP_PERFORM_EXTERNAL},async submit(e){const t=Object.keys(e).map(t=>({relationship_id:t,users:e[t].map(e=>this.isExternal(t)?e:{user_id:e.id})}));this.$emit("submit",t)},validateInternal(e){return!(!this.requireInput||0!==e.length)&&this.$str("error_no_participants_selected","mod_perform")},validateExternal(e){let t={};return null!=this.validate&&(t=this.validate(e)),Object.keys(e).forEach(i=>{if(this.isExternal(i)){t[i]=[];let n=e[i],a=[];Object.keys(n).forEach(e=>{t[i][e]={};let s=n[e];a.includes(s.email)?t[i][e].email=this.$str("error_external_participant_duplicate_email","mod_perform"):a.push(s.email)})}}),t},getInitialValues(){let e={};return this.relationships.forEach(t=>{e[t.id]=[],this.requireInput&&this.isExternal(t)&&(e[t.id]=[{email:"",name:""}])}),e},updateHasChanges(e){this.hasChanges=Object.keys(e).some(t=>this.isExternal(t)?e[t].some(e=>e.name.length>0||e.email.length>0):e[t].length>0)},unloadHandler(e){if(!this.hasChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t}}},p=(i("w3ef"),i("KHd+")),v=function(e){e.options.__langStrings={mod_perform:["activity_title_for_subject","error_external_participant_duplicate_email","error_no_participants_selected","external_user_email","external_user_email_help","external_user_name","external_user_name_help","unsaved_changes_warning","user_activities_created_at"],totara_core:["save"]}},f=Object(p.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performActivityParticipantSelector"},[i("h3",{staticClass:"tui-performActivityParticipantSelector__title"},[e._v("\n    "+e._s(e.instanceTitle)+"\n  ")]),e._v(" "),e.$slots.meta?i("div",{staticClass:"tui-performActivityParticipantSelector__meta"},[e._t("meta")],2):e._e(),e._v(" "),i("Uniform",{staticClass:"tui-performActivityParticipantSelector__form",attrs:{"initial-values":e.initialValues,validate:e.validateExternal,"input-width":"full"},on:{change:e.updateHasChanges,submit:e.submit}},[e.validate?i("FormField",{attrs:{name:"error"}}):e._e(),e._v(" "),e._l(e.relationships,(function(t){return i("FormRow",{key:t.id,attrs:{label:t.name,required:e.requireInput}},[e.isExternal(t)?i("ExternalUserSelector",{attrs:{name:t.id}}):i("FormField",{attrs:{name:t.id,validate:e.validateInternal,"char-length":30},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.value,a=t.update;return[i("UserSelector",{attrs:{"subject-instance-id":e.subjectInstance.id,"exclude-users":[e.subjectInstance.subject_user.id]},on:{input:a},model:{value:n,callback:function(e){n=e},expression:"value"}})]}}],null,!0)})],1)})),e._v(" "),e.relationships.length>0?i("FormRow",[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:"true"},text:e.$str("save","totara_core"),disabled:e.isSaving,type:"submit"}}),e._v(" "),e._t("buttons")],2)],1):e._e()],2)],1)}),[],!1,null,null,null);"function"==typeof v&&v(f),f.options.__hasBlocks={script:!0,template:!0};t.default=f.exports},WtS6:function(e,t,i){"use strict";i.r(t);var n=i("vGF0"),a=i.n(n),s=i("VX2K"),r=i.n(s),o=i("WBvU"),l=i("KxNG"),d={components:{FormRadioGroup:o.FormRadioGroup,FormRow:o.FormRow,FormRowDetails:a.a,FormScope:o.FormScope,Radio:r.a},props:{usesJobBasedDynamicSource:{type:Boolean},dynamicSourceName:{type:String}},data:()=>({SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT:l.SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT,SUBJECT_INSTANCE_GENERATION_ONE_PER_JOB:l.SUBJECT_INSTANCE_GENERATION_ONE_PER_JOB}),methods:{jobBasedCanDisableValidator(e){return this.usesJobBasedDynamicSource&&e==l.SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT?this.$str("schedule_job_assignment_based_disable_error","mod_perform",this.dynamicSourceName):null}}},c=(i("y3p0"),i("KHd+")),u=function(e){e.options.__langStrings={mod_perform:["schedule_job_assignment_based_disable_error","schedule_job_assignment_based_instances","schedule_job_assignment_based_instances_disabled","schedule_job_assignment_based_instances_disabled_description","schedule_job_assignment_based_instances_enabled","schedule_job_assignment_based_instances_enabled_description"]}},m=Object(c.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-assignmentScheduleAdditionalSettings"},[i("FormScope",{attrs:{path:"additionalSettings"}},[i("FormRow",{attrs:{label:e.$str("schedule_job_assignment_based_instances","mod_perform")}},[i("FormRadioGroup",{attrs:{validate:e.jobBasedCanDisableValidator,name:"subjectInstanceGeneration","char-length":"30"}},[i("Radio",{attrs:{value:e.SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT,"aria-describedby":e.$id("disabled")}},[e._v("\n          "+e._s(e.$str("schedule_job_assignment_based_instances_disabled","mod_perform"))+"\n        ")]),e._v(" "),i("FormRowDetails",{attrs:{id:e.$id("disabled")}},[i("span",{staticClass:"tui-assignmentScheduleAdditionalSettings__description"},[e._v("\n            "+e._s(e.$str("schedule_job_assignment_based_instances_disabled_description","mod_perform"))+"\n          ")])]),e._v(" "),i("Radio",{attrs:{value:e.SUBJECT_INSTANCE_GENERATION_ONE_PER_JOB,"aria-describedby":e.$id("enabled")}},[e._v("\n          "+e._s(e.$str("schedule_job_assignment_based_instances_enabled","mod_perform"))+"\n        ")]),e._v(" "),i("FormRowDetails",{attrs:{id:e.$id("enabled")}},[i("span",{staticClass:"tui-assignmentScheduleAdditionalSettings__description"},[e._v("\n            "+e._s(e.$str("schedule_job_assignment_based_instances_enabled_description","mod_perform"))+"\n          ")])])],1)],1)],1)],1)}),[],!1,null,null,null);"function"==typeof u&&u(m),m.options.__hasBlocks={script:!0,template:!0};t.default=m.exports},"X/jl":function(e,t,i){"use strict";var n=i("wqLF");i.n(n).a},X1gS:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/notification/NotificationSection")},X8xi:function(e,t){e.exports=tui.require("tui/components/icons/Tasks")},XDjs:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/notification/TriggersTable")},XDmp:function(e,t,i){"use strict";i.r(t);var n=i("PNFE"),a=i.n(n),s=i("5h9J"),r=i.n(s),o=i("gLvT"),l=i.n(o),d=i("3sQR"),c=i.n(d),u=i("eYNO"),m=i.n(u),_={components:{AddIcon:a.a,ButtonIcon:r.a,Dropdown:l.a,DropdownButton:c.a,DropdownGroup:m.a},props:{elementPlugins:{type:Array,required:!0}},computed:{questionElement:function(){return this.elementPlugins.filter((function(e){if("1"===e.group)return e}))},otherElement:function(){return this.elementPlugins.filter((function(e){if("2"===e.group)return e}))}},methods:{addElementPlugin(e){this.$emit("add-element-item",e)}}},p=i("KHd+"),v=function(e){e.options.__langStrings={mod_perform:["section_element_questions","section_add_element","section_dropdown_other_elements","section_dropdown_question_elements"]}},f=Object(p.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performEditSectionContentAddElement"},[i("Dropdown",{scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle,a=t.isOpen;return[i("ButtonIcon",{attrs:{"aria-expanded":a?"true":"false","aria-label":e.$str("section_add_element","mod_perform"),text:e.$str("section_add_element","mod_perform"),styleclass:{small:!0},caret:!0},on:{click:function(e){return e.preventDefault(),n(e)}}},[i("AddIcon",{attrs:{size:"200"}})],1)]}}])},[e._v(" "),i("DropdownGroup",{attrs:{separator:!0,text:e.$str("section_dropdown_question_elements","mod_perform")}},e._l(e.questionElement,(function(t){return i("DropdownButton",{key:t.plugin_name,on:{click:function(i){return e.addElementPlugin(t)}}},[e._v("\n        "+e._s(t.name)+"\n      ")])})),1),e._v(" "),i("DropdownGroup",{attrs:{separator:!0,text:e.$str("section_dropdown_other_elements","mod_perform")}},e._l(e.otherElement,(function(t){return i("DropdownButton",{key:t.plugin_name,on:{click:function(i){return e.addElementPlugin(t)}}},[e._v("\n        "+e._s(t.name)+"\n      ")])})),1)],1)],1)}),[],!1,null,null,null);"function"==typeof v&&v(f),f.options.__hasBlocks={script:!0,template:!0};t.default=f.exports},XMQU:function(e,t,i){},Xi9X:function(e,t){e.exports=tui.require("tui/components/avatar/Avatar")},Xuva:function(e,t){e.exports=tui.require("mod_perform/components/report/manage_participation/ParticipantOpenCloseActionModal")},YMfc:function(e,t){e.exports=tui.require("tui/components/tag/Tag")},YlPD:function(e,t,i){"use strict";var n=i("BB+S");i.n(n).a},ZISq:function(e,t,i){},Zbdl:function(e,t,i){"use strict";var n=i("wHjO");i.n(n).a},"a+Ln":function(e,t){e.exports=tui.require("mod_perform/components/user_activities/RequiredOptionalIndicator")},a0Gz:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/ManualParticipantsSelectionBanner")},a1wA:function(e,t,i){"use strict";i.r(t);var n=i("PNFE"),a=i.n(n),s=i("vF5l"),r=i.n(s),o=i("5h9J"),l=i.n(o),d=i("hjaT"),c=i.n(d),u=i("9G+f"),m=i.n(u),_={components:{AddIcon:a.a,Button:r.a,ButtonIcon:l.a,Checkbox:c.a,Popover:m.a},props:{activeParticipants:{required:!0,type:Array,default:()=>[]},relationships:{type:Array,required:!0},isViewOnlyParticipants:Boolean},data:()=>({checkedParticipants:[]}),computed:{addButtonAriaLabel(){return this.isViewOnlyParticipants?this.$str("activity_participants_view_only_add","mod_perform"):this.$str("activity_participants_add","mod_perform")},hasAddedAllParticipants(){return this.relationships.length===this.activeParticipants.length}},methods:{updateParticipants(e){e(),this.$emit("update-participants",this.checkedParticipants),this.checkedParticipants=[]},isCheckedParticipant(e){return this.checkedParticipants.some(t=>t.id==e.id)},resetCheckedParticipants(){return this.checkedParticipants=[]},isActiveParticipant(e){return this.activeParticipants.map(e=>e.core_relationship.id).includes(e.id)},handleChange(e,t){e?this.checkedParticipants.push(t):this.checkedParticipants=this.checkedParticipants.filter(e=>e!==t)}}},p=i("KHd+"),v=function(e){e.options.__langStrings={core:["cancel"],mod_perform:["activity_participants_select_done","activity_participants_select_heading","activity_participants_add","activity_participants_view_only_add"]}},f=Object(p.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Popover",{attrs:{triggers:["click"]},scopedSlots:e._u([{key:"buttons",fn:function(t){var n=t.close;return[i("Button",{attrs:{styleclass:{small:!0,primary:!0},text:e.$str("activity_participants_select_done","mod_perform")},on:{click:function(t){return e.updateParticipants(n)}}}),e._v(" "),i("Button",{attrs:{styleclass:{small:!0,primary:!1},text:e.$str("cancel","core")},on:{click:n}})]}},{key:"trigger",fn:function(){return[i("ButtonIcon",{attrs:{styleclass:{small:!0},"aria-label":e.addButtonAriaLabel,disabled:e.hasAddedAllParticipants},on:{click:e.resetCheckedParticipants}},[i("AddIcon",{attrs:{size:"100"}})],1)]},proxy:!0}])},[i("h2",{staticClass:"sr-only"},[e._v("\n    "+e._s(e.$str("activity_participants_select_heading","mod_perform"))+"\n  ")]),e._v(" "),i("label",{attrs:{id:e.$id("participants-select-heading")}},[e._v("\n    "+e._s(e.$str("activity_participants_select_heading","mod_perform"))+"\n  ")]),e._v(" "),e._l(e.relationships,(function(t){return i("Checkbox",{key:t.id,attrs:{value:t.id,name:t.name,checked:e.isCheckedParticipant(t),disabled:e.isActiveParticipant(t)},on:{change:function(i){return e.handleChange(i,t)}}},[[e._v("\n      "+e._s(t.name)+"\n    ")]],2)}))],2)}),[],!1,null,null,null);"function"==typeof v&&v(f),f.options.__hasBlocks={script:!0,template:!0};t.default=f.exports},a6jG:function(e,t,i){"use strict";var n=i("zN6o");i.n(n).a},aW2t:function(e,t,i){},adT2:function(e,t,i){"use strict";i.r(t);var n=i("5h9J"),a=i.n(n),s=i("jJ8l"),r=i.n(s),o=i("NMGf"),l=i.n(o),d=i("nnnb"),c=i.n(d),u=i("gLvT"),m=i.n(u),_=i("KGcv"),p=i.n(_),v=i("bF0+"),f=i.n(v),g=i("PNtU"),k=i.n(g),h=i("tNJr"),y=i.n(h),S=i("Uz97"),b=i.n(S),N={components:{ButtonIcon:a.a,Card:r.a,DeleteButton:l.a,DragHandleIcon:c.a,Dropdown:m.a,DropdownItem:p.a,EditButton:f.a,Lozenge:k.a,MoreButton:y.a,SettingsIcon:b.a},props:{activityState:Object,draggable:Boolean,dragging:Boolean,errors:Object,isMultiSectionActive:{type:Boolean,required:!0},sectionComponent:Object,sectionElement:Object,sectionId:String,activityContextId:[Number,String]},computed:{isActive(){return"ACTIVE"===this.activityState.name}},methods:{edit(){this.$emit("edit")},remove(){this.$emit("remove")},displayRead(){this.$emit("display-read")},move(){this.$emit("move")}}},F=(i("0LUZ"),i("KHd+")),A=function(e){e.options.__langStrings={mod_perform:["edit_element","element_action_options","element_type_heading_a11y","move_to_other_section","section_element_tag_optional","section_element_tag_required","setting_element"],core:["delete"]}},C=Object(F.a)(N,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Card",{staticClass:"tui-performAdminCustomElement",class:{"tui-performAdminCustomElement--dragging":e.dragging},attrs:{"has-hover-shadow":!e.isActive}},[e.draggable?i("div",{staticClass:"tui-performAdminCustomElement__moveIcon"},[i("DragHandleIcon")],1):e._e(),e._v(" "),e.sectionElement.element.element_plugin?i("div",{staticClass:"tui-performAdminCustomElement__actions"},[e.isActive||"view"!==e.sectionComponent.type?e._e():i("EditButton",{staticClass:"tui-performAdminCustomElement__actions-item",attrs:{"aria-label":e.$str("edit_element","mod_perform",e.sectionElement.element.title?e.sectionElement.element.title:e.sectionElement.element.element_plugin.name)},on:{click:e.edit}}),e._v(" "),e.isActive||"view"!==e.sectionComponent.type?e._e():i("Dropdown",{staticClass:"tui-performAdminCustomElement__actions-item",attrs:{position:"bottom-right"},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle;return[i("MoreButton",{attrs:{"no-padding":!0,"aria-label":e.$str("element_action_options","mod_perform")},on:{click:n}})]}}],null,!1,2091391161)},[e._v(" "),e.isMultiSectionActive?i("DropdownItem",{on:{click:e.move}},[e._v("\n        "+e._s(e.$str("move_to_other_section","mod_perform"))+"\n      ")]):e._e(),e._v(" "),i("DropdownItem",{on:{click:e.remove}},[e._v("\n        "+e._s(e.$str("delete","core"))+"\n      ")])],1),e._v(" "),e.isActive&&"view"===e.sectionComponent.type?i("ButtonIcon",{attrs:{"aria-label":e.$str("setting_element","mod_perform",e.sectionElement.element.title?e.sectionElement.element.title:e.sectionElement.element.element_plugin.name),styleclass:{transparentNoPadding:!0}},on:{click:e.displayRead}},[i("SettingsIcon")],1):e._e()],1):e._e(),e._v(" "),i("div",{staticClass:"tui-performAdminCustomElement__content"},["view"==e.sectionComponent.type&&e.sectionElement.element.title?i("h3",{staticClass:"tui-performAdminCustomElement__content-title"},[e.sectionElement.element.element_plugin?i("span",{staticClass:"tui-performAdminCustomElement__content-accessibleTitle"},[e._v("\n        "+e._s(e.$str("element_type_heading_a11y","mod_perform",e.sectionElement.element.element_plugin.name))+"\n      ")]):e._e(),e._v(" "),i("span",{staticClass:"tui-performAdminCustomElement__content-titleText"},[e._v("\n        "+e._s(e.sectionElement.element.title)+"\n      ")]),e._v(" "),e.sectionElement.element.is_required?i("span",{staticClass:"tui-performAdminCustomElement__content-titleRequired"},[e._v("\n        *\n      ")]):e._e()]):e._e(),e._v(" "),i(e.sectionComponent.component,{key:e.sectionElement.id,ref:"sectionElements",tag:"component",attrs:{"activity-state":e.activityState,"aria-hidden":!0,data:e.sectionElement.element.data,"element-id":e.sectionElement.element.id,identifier:e.sectionElement.element.identifier,"is-required":e.sectionElement.element.is_required,"raw-data":e.sectionElement.element.raw_data,"raw-title":e.sectionElement.element.raw_title,"section-id":e.sectionId,settings:e.sectionComponent.settings,title:e.sectionElement.element.title,"activity-context-id":e.activityContextId},on:{display:function(t){return e.$emit("display",e.sectionElement)},"display-read":function(t){return e.$emit("display-read",e.sectionElement)},update:function(t){return e.$emit("update",t)}}})],1),e._v(" "),i("div",{staticClass:"tui-performAdminCustomElement__lozenge"},[e.sectionElement.element.identifier&&!e.isActive&&"editing"!==e.sectionComponent.type?i("Lozenge",{attrs:{text:e.sectionElement.element.identifier,type:"neutral"}}):e._e()],1)])}),[],!1,null,null,null);"function"==typeof A&&A(C),C.options.__hasBlocks={script:!0,template:!0};t.default=C.exports},apvp:function(e,t){e.exports=tui.require("tui/components/icons/DateEnabled")},"bF0+":function(e,t){e.exports=tui.require("tui/components/buttons/EditIcon")},"bOP/":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/ActivateActivityModal")},bPHd:function(e,t,i){"use strict";i.r(t);var n=i("59Wj"),a=i.n(n),s=i("FBvN"),r=i.n(s),o=i("49h4"),l=i.n(o),d=i("KxNG"),c={components:{FilterBar:a.a,SearchFilter:r.a,SelectFilter:l.a},props:{types:{type:Array,required:!0},shown:{type:Number,default:0},total:{type:Number,default:0}},data(){return{options:{types:[{id:null,label:this.$str("all")}].concat(this.types),statuses:[{id:null,label:this.$str("all")},{id:d.ACTIVITY_STATUS_DRAFT,label:this.$str("activity_status_draft","mod_perform")},{id:d.ACTIVITY_STATUS_ACTIVE,label:this.$str("activity_status_active","mod_perform")}],sorts:[{id:"creation_date",label:this.$str("manage_activity_list_sort_creation_date","mod_perform")},{id:"name",label:this.$str("manage_activity_list_sort_name","mod_perform")}].sort((e,t)=>e.label.localeCompare(t.label))},selectedFilters:{type:null,status:null,name:""},selectedSorting:"creation_date"}},watch:{selectedFilters:{deep:!0,handler:"update"},selectedSorting:"update"},methods:{update(){this.$emit("update",{filters:this.selectedFilters,sorting:this.selectedSorting})}}},u=(i("URM+"),i("KHd+")),m=function(e){e.options.__langStrings={mod_perform:["activity_status_active","activity_status_draft","manage_activity_list_filter_name","manage_activity_list_filter_name_placeholder","manage_activity_list_filter_status","manage_activity_list_filter_type","manage_activity_list_sort_creation_date","manage_activity_list_sort_name","perform:manage_activity","showing_activities"],core:["all","sortby"]}},_=Object(u.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManageActivityFilters"},[i("FilterBar",{staticClass:"tui-performManageActivityFilters__filter",attrs:{title:e.$str("perform:manage_activity","mod_perform")},scopedSlots:e._u([{key:"filters-left",fn:function(t){var n=t.stacked;return[i("SelectFilter",{attrs:{label:e.$str("manage_activity_list_filter_type","mod_perform"),"show-label":!0,options:e.options.types,stacked:n},model:{value:e.selectedFilters.type,callback:function(t){e.$set(e.selectedFilters,"type",t)},expression:"selectedFilters.type"}}),e._v(" "),i("SelectFilter",{attrs:{label:e.$str("manage_activity_list_filter_status","mod_perform"),"show-label":!0,options:e.options.statuses,stacked:n},model:{value:e.selectedFilters.status,callback:function(t){e.$set(e.selectedFilters,"status",t)},expression:"selectedFilters.status"}})]}},{key:"filters-right",fn:function(t){var n=t.stacked;return[i("SearchFilter",{attrs:{label:e.$str("manage_activity_list_filter_name","mod_perform"),placeholder:e.$str("manage_activity_list_filter_name_placeholder","mod_perform"),"drop-label":"",stacked:n},model:{value:e.selectedFilters.name,callback:function(t){e.$set(e.selectedFilters,"name",t)},expression:"selectedFilters.name"}})]}}]),model:{value:e.selectedFilters,callback:function(t){e.selectedFilters=t},expression:"selectedFilters"}}),e._v(" "),i("div",{staticClass:"tui-performManageActivityFilters__after"},[e.total?i("strong",{staticClass:"tui-performManageActivityFilters__total"},[e._v("\n      "+e._s(e.$str("showing_activities","mod_perform",{shown:e.shown,total:e.total}))+"\n    ")]):e._e(),e._v(" "),i("div",{staticClass:"tui-performManageActivityFilters__sortFilter"},[i("SelectFilter",{attrs:{label:e.$str("sortby"),"show-label":!0,options:e.options.sorts},model:{value:e.selectedSorting,callback:function(t){e.selectedSorting=t},expression:"selectedSorting"}})],1)])],1)}),[],!1,null,null,null);"function"==typeof m&&m(_),_.options.__hasBlocks={script:!0,template:!0};t.default=_.exports},bxeI:function(e,t){e.exports=tui.require("tui/components/layouts/LayoutOneColumn")},byy7:function(e,t,i){"use strict";i.r(t);var n=i("kUb+"),a=i.n(n),s=i("fCWf"),r=i.n(s),o={components:{ActionCard:a.a,ActionLink:r.a},props:{},data:()=>({})},l=(i("Uh6e"),i("KHd+")),d=function(e){e.options.__langStrings={mod_perform:["user_activities_require_manual_participant_selection_header_text","user_activities_require_manual_participant_selection_link_text"]}},c=Object(l.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManualParticipantSelectionBanner"},[i("ActionCard",{scopedSlots:e._u([{key:"card-body",fn:function(){return[i("span",[e._v(e._s(e.$str("user_activities_require_manual_participant_selection_header_text","mod_perform")))])]},proxy:!0},{key:"card-action",fn:function(){return[i("ActionLink",{attrs:{href:e.$url("/mod/perform/activity/select-participants.php"),text:e.$str("user_activities_require_manual_participant_selection_link_text","mod_perform"),styleclass:{primary:!0,small:!0}}})]},proxy:!0}])})],1)}),[],!1,null,null,null);"function"==typeof d&&d(c),c.options.__hasBlocks={script:!0,template:!0};t.default=c.exports},cK46:function(e,t,i){"use strict";var n=i("vwAc");i.n(n).a},cKVU:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/AssignmentScheduleDueDate")},"cY/X":function(e,t,i){},csKv:function(e,t){e.exports=tui.require("tui/components/form/FormRowStack")},dCH5:function(e,t){e.exports=tui.require("tui/components/form/RadioDateRangeInput")},dFEZ:function(e,t,i){},dUjM:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/ActivityStatusBanner")},diYH:function(e,t,i){"use strict";var n=i("PyqE");i.n(n).a},dtfu:function(e,t){e.exports=tui.require("tui/components/responsive/Responsive")},e5h7:function(e,t,i){"use strict";i.r(t);var n=i("/7MI"),a=i.n(n),s=i("LxOS"),r=i.n(s),o=i("5xBH"),l=i.n(o),d=i("vGF0"),c=i.n(d),u=i("VX2K"),m=i.n(u),_=i("dCH5"),p=i.n(_),v=i("WBvU"),f=i("sVqh"),g=i("KxNG"),k={components:{FieldGroup:a.a,FormCheckbox:r.a,FormDateSelector:v.FormDateSelector,FormRadioGroup:l.a,FormRadioWithInput:v.FormRadioWithInput,FormRow:v.FormRow,FormRowDetails:c.a,FormScope:v.FormScope,FormSelect:v.FormSelect,FormRowStack:v.FormRowStack,Radio:m.a,RadioDateRange:p.a},props:{dynamicDateSettingComponent:{type:Object},dynamicDateSources:{type:Array,required:!0},isFixed:{type:Boolean,required:!0},isOpen:{type:Boolean,required:!0}},data:()=>({afterValue:g.RELATIVE_DATE_DIRECTION_AFTER,beforeValue:g.RELATIVE_DATE_DIRECTION_BEFORE}),computed:{title(){return this.isOpen&&this.isFixed?this.$str("schedule_range_heading_open_fixed","mod_perform"):!this.isOpen&&this.isFixed?this.$str("schedule_range_heading_limited_fixed","mod_perform"):this.isOpen&&!this.isFixed?this.$str("schedule_range_heading_open_dynamic","mod_perform"):this.$str("schedule_range_heading_limited_dynamic","mod_perform")},description(){return this.isFixed?this.$str("schedule_range_date_description","mod_perform"):this.$str("schedule_range_date_description_limited_relative","mod_perform")},dynamicSourcesForSelect(){return this.dynamicDateSources?this.dynamicDateSources.map(e=>({label:e.display_name,id:`${e.resolver_class_name}--${e.option_key}`})):[]},showCustomDynamicSetting(){return!(!this.dynamicDateSettingComponent||!this.dynamicDateSettingComponent.name)}},methods:{dynamicSettingComponentFor(){return tui.asyncComponent(this.dynamicDateSettingComponent.name)},fixedDateValidator(e){const t={};return this.isOpen||Object(f.isIsoAfter)(e.to.iso,e.from.iso)||(t.to=this.$str("fixed_date_selector_error_range","mod_perform")),t},relativeDateValidator(e){const t={},i=this.$str("relative_date_selector_error_range","mod_perform"),n=this.$str("schedule_range_date_min_value","mod_perform"),a=this.$str("relative_date_selector_error_value","mod_perform"),s=e.fromDirection;let r=g.RELATIVE_DATE_UNIT_DAY,o=0;const l=e.toDirection;let d=g.RELATIVE_DATE_UNIT_DAY,c=0;return s===g.RELATIVE_DATE_DIRECTION_BEFORE?(o=Number(e.fromOffset.before.value),r=e.fromOffset.before.range):s===g.RELATIVE_DATE_DIRECTION_AFTER&&(o=Number(e.fromOffset.after.value),r=e.fromOffset.after.range),l===g.RELATIVE_DATE_DIRECTION_BEFORE?(c=Number(e.toOffset.before.value),d=e.toOffset.before.range):l===g.RELATIVE_DATE_DIRECTION_AFTER&&(c=Number(e.toOffset.after.value),d=e.toOffset.after.range),r==g.RELATIVE_DATE_UNIT_WEEK&&(o*=7),d==g.RELATIVE_DATE_UNIT_WEEK&&(c*=7),s&&!Number.isInteger(o)?s===g.RELATIVE_DATE_DIRECTION_BEFORE?t.fromOffset={before:a}:t.fromOffset={after:a}:l&&!Number.isInteger(c)?l===g.RELATIVE_DATE_DIRECTION_BEFORE?t.toOffset={before:a}:t.toOffset={after:a}:s&&o<1?s===g.RELATIVE_DATE_DIRECTION_BEFORE?t.fromOffset={before:n}:t.fromOffset={after:n}:l&&c<1&&(l===g.RELATIVE_DATE_DIRECTION_BEFORE?t.toOffset={before:n}:t.toOffset={after:n}),this.isOpen||(s===g.RELATIVE_DATE_DIRECTION_AFTER&&l===g.RELATIVE_DATE_DIRECTION_BEFORE?t.toOffset={before:i}:s!==g.RELATIVE_DATE_DIRECTION_AFTER||l?s===g.RELATIVE_DATE_DIRECTION_AFTER&&l===g.RELATIVE_DATE_DIRECTION_AFTER&&o>c?t.toOffset={after:i}:(!s&&l===g.RELATIVE_DATE_DIRECTION_BEFORE&&o<c||s===g.RELATIVE_DATE_DIRECTION_BEFORE&&l===g.RELATIVE_DATE_DIRECTION_BEFORE&&o<c)&&(t.toOffset={before:i}):t.toDirection=i),t}}},h=(i("C4fs"),i("KHd+")),y=function(e){e.options.__langStrings={mod_perform:["fixed_date_selector_error_range","relative_date_selector_reference_date","relative_date_selector_error_range","relative_date_selector_error_value","schedule_after","schedule_after_a11y","schedule_before","schedule_before_a11y","schedule_on_date","schedule_range_date_description","schedule_range_date_description_limited_relative","schedule_range_date_end","schedule_range_date_min_value","schedule_range_date_start","schedule_range_heading_limited_dynamic","schedule_range_heading_limited_fixed","schedule_range_heading_open_dynamic","schedule_range_heading_open_fixed","schedule_range_use_anniversary","schedule_use_anniversary_label"]}},S=Object(h.a)(k,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-assignmentScheduleCreationRange"},[i("h4",{staticClass:"tui-assignmentScheduleCreationRange__title"},[e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),i("div",{staticClass:"tui-assignmentScheduleCreationRange__description"},[e._v("\n    "+e._s(e.description)+"\n  ")]),e._v(" "),e.isFixed?[i("FormScope",{attrs:{path:"scheduleFixed",validate:e.fixedDateValidator}},[i("div",{staticClass:"tui-assignmentScheduleCreationRange__form"},[i("FormRowStack",[i("FormRow",{attrs:{label:e.$str("schedule_range_date_start","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.id,n=e.labelId;return[i("FieldGroup",{attrs:{"aria-labelledby":n}},[i("FormDateSelector",{attrs:{id:t,name:"from",type:"date","has-timezone":"",validations:function(e){return[e.required()]}}})],1)]}}],null,!1,2666838548)}),e._v(" "),e.isOpen?e._e():i("FormRow",{attrs:{label:e.$str("schedule_range_date_end","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.labelId;return[i("FieldGroup",{attrs:{"aria-labelledby":n}},[i("FormDateSelector",{attrs:{id:e.$id("fixed-date-to"),name:"to",type:"date",validations:function(e){return[e.required()]}}})],1)]}}],null,!1,836314126)})],1)],1)])]:[i("FormScope",{attrs:{path:"scheduleDynamic",validate:e.relativeDateValidator}},[i("div",{staticClass:"tui-assignmentScheduleCreationRange__form"},[i("FormRowStack",[i("FormRow",{attrs:{label:e.$str("relative_date_selector_reference_date","mod_perform")}},[e.dynamicDateSources?i("FormSelect",{attrs:{id:e.$id("relative-date-reference-date"),name:"dynamic_source","char-length":"25",options:e.dynamicSourcesForSelect}}):e._e()],1),e._v(" "),e.showCustomDynamicSetting?i(e.dynamicSettingComponentFor(),{tag:"component",attrs:{data:e.dynamicDateSettingComponent.data,"config-data":e.dynamicDateSettingComponent.configData}}):e._e(),e._v(" "),i("FormRow",{attrs:{label:e.$str("schedule_range_use_anniversary","mod_perform"),"is-stacked":!0,"aria-describedby":e.$id("use-anniversary")}},[i("div",{staticClass:"tui-assignmentScheduleCreationRange__form-checkbox"},[i("FormCheckbox",{attrs:{name:"useAnniversary"}})],1),e._v(" "),i("FormRowDetails",{attrs:{id:e.$id("use-anniversary")}},[e._v("\n              "+e._s(e.$str("schedule_use_anniversary_label","mod_perform"))+"\n            ")])],1),e._v(" "),i("FormRow",{attrs:{label:e.$str("schedule_range_date_start","mod_perform")}},[i("FormRadioGroup",{attrs:{name:"fromDirection"}},[i("Radio",{attrs:{value:!1}},[e._v("\n                "+e._s(e.$str("schedule_on_date","mod_perform"))+"\n              ")]),e._v(" "),i("FormRadioWithInput",{attrs:{name:["fromOffset","before"],text:e.$str("schedule_before","mod_perform"),value:e.beforeValue},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.disabledRadio,a=t.nameLabel,s=t.setAccessibleLabel,r=t.update,o=t.value;return[i("RadioDateRange",{attrs:{disabled:n,name:a,value:o},on:{input:function(e){return r(e)},"accessible-change":function(t){return s(e.$str("schedule_before_a11y","mod_perform",{range:t.range,value:t.value}))}}})]}}])}),e._v(" "),i("FormRadioWithInput",{attrs:{name:["fromOffset","after"],text:e.$str("schedule_after","mod_perform"),value:e.afterValue},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.disabledRadio,a=t.nameLabel,s=t.setAccessibleLabel,r=t.update,o=t.value;return[i("RadioDateRange",{attrs:{disabled:n,name:a,value:o},on:{input:function(e){return r(e)},"accessible-change":function(t){return s(e.$str("schedule_after_a11y","mod_perform",{range:t.range,value:t.value}))}}})]}}])})],1)],1),e._v(" "),e.isOpen?e._e():i("FormRow",{attrs:{label:e.$str("schedule_range_date_end","mod_perform")}},[i("FormRadioGroup",{attrs:{name:"toDirection"}},[i("Radio",{attrs:{value:!1}},[e._v("\n                "+e._s(e.$str("schedule_on_date","mod_perform"))+"\n              ")]),e._v(" "),i("FormRadioWithInput",{attrs:{name:["toOffset","before"],text:e.$str("schedule_before","mod_perform"),value:e.beforeValue},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.disabledRadio,a=t.nameLabel,s=t.setAccessibleLabel,r=t.update,o=t.value;return[i("RadioDateRange",{attrs:{disabled:n,name:a,value:o},on:{input:function(e){return r(e)},"accessible-change":function(t){return s(e.$str("schedule_before_a11y","mod_perform",{range:t.range,value:t.value}))}}})]}}],null,!1,2313033854)}),e._v(" "),i("FormRadioWithInput",{attrs:{name:["toOffset","after"],text:e.$str("schedule_after","mod_perform"),value:e.afterValue},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.disabledRadio,a=t.nameLabel,s=t.setAccessibleLabel,r=t.update,o=t.value;return[i("RadioDateRange",{attrs:{disabled:n,name:a,value:o},on:{input:function(e){return r(e)},"accessible-change":function(t){return s(e.$str("schedule_after_a11y","mod_perform",{range:t.range,value:t.value}))}}})]}}],null,!1,3853093539)})],1)],1)],1)],1)])]],2)}),[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0};t.default=S.exports},e7Z5:function(e,t,i){"use strict";i.r(t);var n=i("IYAL"),a=i.n(n),s=i("vF5l"),r=i.n(s),o=i("BN8m"),l=i.n(o),d=i("C+/B"),c=i.n(d),u=i("olVF"),m=i.n(u),_=i("cKVU"),p=i.n(_),v=i("2CGV"),f=i.n(v),g=i("8fk4"),k=i.n(g),h=i("WBvU"),y=i("vyVp"),S=i("sVqh"),b=i("KxNG"),N={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_track_schedule"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"track_schedule"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_track_schedule_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_track_schedule"},arguments:[{kind:"Argument",name:{kind:"Name",value:"track_schedule"},value:{kind:"Variable",name:{kind:"Name",value:"track_schedule"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"track"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_instance_generation"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_is_open"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_is_fixed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_fixed_from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_fixed_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"direction"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"direction"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_source"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"option_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_available"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_setting_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_base"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_use_anniversary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_is_fixed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_fixed"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"due_date_offset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"repeating_is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_offset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"repeating_is_limited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_limit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_instance_generation"},arguments:[],directives:[]}]}}]}}]}}]},F={components:{AdditionalScheduleSettings:a.a,Button:r.a,ButtonGroup:l.a,ConfirmationModal:c.a,CreationRange:m.a,DueDateSettings:p.a,FormRow:h.FormRow,FrequencySettings:f.a,Toggles:k.a,Uniform:h.Uniform},props:{activityId:{type:Number,required:!0},activityState:{type:String,required:!0},defaultFixedDate:{type:Object},dynamicDateSources:{type:Array,required:!0},track:{type:Object,required:!0}},data(){return{confirmationModalOpen:!1,dueDateType:this.track.due_date_is_fixed?"fixed":"relative",dynamicDateSettingComponent:{name:this.getDynamicCustomSettingComponent(),data:this.getDynamicCustomSettingData(this.track),configData:this.getDynamicCustomSettingConfig()},dynamicDateSourceName:this.getDynamicDateSourceName(),formValuesToSave:null,hasMounted:!1,isSaving:!1,isUsingJobBasedDynamicSource:this.isDynamicDateSourceJobBased(),initialValues:this.getInitialValues(this.track),toggleValues:{dueDateIsEnabled:this.track.due_date_is_enabled,repeatingIsEnabled:this.track.repeating_is_enabled,scheduleIsOpen:this.track.schedule_is_open,scheduleIsFixed:this.track.schedule_is_fixed}}},computed:{isActive(){return this.activityState==b.ACTIVITY_STATUS_ACTIVE}},watch:{toggleValues(){this.hasUnsavedChanges(!0)}},mounted(){this.hasMounted=!0},methods:{onChange(e){if(this.hasMounted){if(!this.toggleValues.scheduleIsOpen&&this.toggleValues.scheduleIsFixed?this.dueDateType=e.dueDateType:this.dueDateType="relative",e.scheduleDynamic.dynamic_source){const t=this.getSelectedDynamicDateSourceFromValues(e);this.dynamicDateSettingComponent.name=t.custom_setting_component,this.dynamicDateSettingComponent.data=JSON.parse(t.custom_data),this.isUsingJobBasedDynamicSource=!this.toggleValues.scheduleIsFixed&&this.isDynamicDateSourceJobBased(t),this.dynamicDateSourceName=this.getDynamicDateSourceName(t)}this.hasUnsavedChanges(!0)}},getInitialValues(e){let t={relative:{value:14,range:b.RELATIVE_DATE_UNIT_DAY}};e.due_date_offset&&(t.relative.value=e.due_date_offset.count,t.relative.range=e.due_date_offset.unit);let i=e.schedule_dynamic_source?e.schedule_dynamic_source:this.dynamicDateSources[0],n={dynamicCustomSettings:this.getDynamicCustomSettingData(e),dynamic_source:i.resolver_class_name+"--"+i.option_key,fromDirection:b.RELATIVE_DATE_DIRECTION_BEFORE,fromOffset:{after:{range:b.RELATIVE_DATE_UNIT_DAY,value:1},before:{range:b.RELATIVE_DATE_UNIT_DAY,value:1}},toDirection:b.RELATIVE_DATE_DIRECTION_BEFORE,toOffset:{after:{range:b.RELATIVE_DATE_UNIT_DAY,value:1},before:{range:b.RELATIVE_DATE_UNIT_DAY,value:1}},useAnniversary:e.schedule_use_anniversary};if(e.schedule_dynamic_from){const t=e.schedule_dynamic_from.direction;0===e.schedule_dynamic_from.count?n.fromDirection=!1:t===b.RELATIVE_DATE_DIRECTION_BEFORE?(n.fromDirection=t,n.fromOffset.before.value=e.schedule_dynamic_from.count,n.fromOffset.before.range=e.schedule_dynamic_from.unit):t===b.RELATIVE_DATE_DIRECTION_AFTER&&(n.fromDirection=t,n.fromOffset.after.value=e.schedule_dynamic_from.count,n.fromOffset.after.range=e.schedule_dynamic_from.unit)}if(e.schedule_dynamic_to){const t=e.schedule_dynamic_to.direction;0===e.schedule_dynamic_to.count?n.toDirection=!1:t===b.RELATIVE_DATE_DIRECTION_BEFORE?(n.toDirection=t,n.toOffset.before.value=e.schedule_dynamic_to.count,n.toOffset.before.range=e.schedule_dynamic_to.unit):t===b.RELATIVE_DATE_DIRECTION_AFTER&&(n.toDirection=t,n.toOffset.after.value=e.schedule_dynamic_to.count,n.toOffset.after.range=e.schedule_dynamic_to.unit)}let a={repeatingIsLimited:!1,repeatingLimit:3,repeatingOffset:{creationOffset:{range:b.RELATIVE_DATE_UNIT_WEEK,value:4},creationWhenCompleteOffset:{range:b.RELATIVE_DATE_UNIT_WEEK,value:4},completeOffset:{range:b.RELATIVE_DATE_UNIT_WEEK,value:4}},repeatingType:"creationOffset"};if(e.repeating_type){const t=e.repeating_offset.count,i=e.repeating_offset.unit,n=e.repeating_type===b.SCHEDULE_REPEATING_TYPE_AFTER_CREATION_WHEN_COMPLETE?"creationWhenCompleteOffset":e.repeating_type===b.SCHEDULE_REPEATING_TYPE_AFTER_COMPLETION?"completeOffset":"creationOffset";a.repeatingOffset[n].value=t,a.repeatingOffset[n].range=i,a.repeatingType=n,e.repeating_is_limited&&(a.repeatingIsLimited=e.repeating_is_limited),e.repeating_limit&&(a.repeatingLimit=e.repeating_limit)}return{additionalSettings:{subjectInstanceGeneration:e.subject_instance_generation},fixedDueDate:e.due_date_fixed||this.defaultFixedDate,dueDateType:e.due_date_is_fixed?"fixed":"relative",dueDateOffset:t,repeatingValues:a,scheduleDynamic:n,scheduleFixed:{from:e.schedule_fixed_from||this.defaultFixedDate,to:e.schedule_fixed_to||this.defaultFixedDate}}},getMutationVariables(){const e=this.formValuesToSave;return{track_schedule:Object.assign({track_id:this.track.id},this.getScheduleVariables(e),this.getAdditionalSettingsVariables(e),this.getDueDateVariables(e),this.getRepeatingVariables(e))}},getAdditionalSettingsVariables:e=>({subject_instance_generation:e.additionalSettings.subjectInstanceGeneration}),getDueDateVariables(e){const t={due_date_is_enabled:this.toggleValues.dueDateIsEnabled};return this.toggleValues.dueDateIsEnabled?(!this.toggleValues.scheduleIsOpen&&this.toggleValues.scheduleIsFixed&&(t.due_date_is_fixed="fixed"===this.dueDateType),t.due_date_is_fixed?t.due_date_fixed=e.fixedDueDate:t.due_date_offset={count:Number(e.dueDateOffset.relative.value),unit:e.dueDateOffset.relative.range},t):t},getRepeatingVariables(e){const t={repeating_is_enabled:this.toggleValues.repeatingIsEnabled};if(this.toggleValues.repeatingIsEnabled){const i=e.repeatingValues.repeatingType,n="creationOffset"===i?b.SCHEDULE_REPEATING_TYPE_AFTER_CREATION:"creationWhenCompleteOffset"===i?b.SCHEDULE_REPEATING_TYPE_AFTER_CREATION_WHEN_COMPLETE:b.SCHEDULE_REPEATING_TYPE_AFTER_COMPLETION;t.repeating_type=n,t.repeating_offset={count:e.repeatingValues.repeatingOffset[i].value,unit:e.repeatingValues.repeatingOffset[i].range},t.repeating_is_limited=e.repeatingValues.repeatingIsLimited,e.repeatingValues.repeatingIsLimited&&(t.repeating_limit=e.repeatingValues.repeatingLimit)}return t},getScheduleVariables(e){const t={schedule_is_open:this.toggleValues.scheduleIsOpen,schedule_is_fixed:this.toggleValues.scheduleIsFixed};if(this.toggleValues.scheduleIsFixed){let i=e.scheduleFixed.from.timezone;t.schedule_fixed_from={iso:e.scheduleFixed.from.iso,timezone:i},this.toggleValues.scheduleIsOpen||(t.schedule_fixed_to={iso:e.scheduleFixed.to.iso,timezone:i})}else{t.schedule_use_anniversary=e.scheduleDynamic.useAnniversary,e.scheduleDynamic.fromDirection===b.RELATIVE_DATE_DIRECTION_BEFORE?t.schedule_dynamic_from={count:e.scheduleDynamic.fromOffset.before.value,unit:e.scheduleDynamic.fromOffset.before.range,direction:e.scheduleDynamic.fromDirection}:e.scheduleDynamic.fromDirection===b.RELATIVE_DATE_DIRECTION_AFTER?t.schedule_dynamic_from={count:e.scheduleDynamic.fromOffset.after.value,unit:e.scheduleDynamic.fromOffset.after.range,direction:e.scheduleDynamic.fromDirection}:t.schedule_dynamic_from={count:0,unit:"DAY",direction:b.RELATIVE_DATE_DIRECTION_BEFORE};const i=e.scheduleDynamic.dynamic_source.split("--"),n=Object.assign({},this.getDynamicCustomSettingConfig(),e.scheduleDynamic.dynamicCustomSettings);t.schedule_dynamic_source={resolver_class_name:i[0],option_key:i[1],custom_data:JSON.stringify(n)},t.due_date_offset=null,this.toggleValues.scheduleIsOpen||(e.scheduleDynamic.toDirection===b.RELATIVE_DATE_DIRECTION_BEFORE?t.schedule_dynamic_to={count:e.scheduleDynamic.toOffset.before.value,unit:e.scheduleDynamic.toOffset.before.range,direction:e.scheduleDynamic.toDirection}:e.scheduleDynamic.toDirection===b.RELATIVE_DATE_DIRECTION_AFTER?t.schedule_dynamic_to={count:e.scheduleDynamic.toOffset.after.value,unit:e.scheduleDynamic.toOffset.after.range,direction:e.scheduleDynamic.toDirection}:t.schedule_dynamic_to={count:0,unit:"DAY",direction:b.RELATIVE_DATE_DIRECTION_BEFORE})}return t},getDynamicCustomSettingData(e){let t={};return t=e.schedule_dynamic_source?JSON.parse(e.schedule_dynamic_source.custom_data):JSON.parse(this.dynamicDateSources[0].custom_data),t},getDynamicCustomSettingComponent(){let e=null;return e=this.track&&this.track.schedule_dynamic_source?this.track.schedule_dynamic_source.custom_setting_component:this.dynamicDateSources[0].custom_setting_component,e},getSelectedDynamicDateSourceFromValues(e){return this.dynamicDateSources.filter(t=>`${t.resolver_class_name}--${t.option_key}`==e.scheduleDynamic.dynamic_source).shift()},getDynamicCustomSettingConfig(){return{this_activity_id:this.activityId}},getDynamicDateSourceName(e){return e?e.display_name:this.track&&this.track.schedule_dynamic_source?this.track.schedule_dynamic_source.display_name:null},isDynamicCustomSettingSource(e){return null!==this.dynamicDateSources.filter(t=>`${t.resolver_class_name}--${t.option_key}`==e).shift().custom_setting_component},isDynamicDateSourceJobBased(e){return e?e.resolver_base==b.DATE_RESOLVER_JOB_BASED:!(!this.track||!this.track.schedule_dynamic_source)&&this.track.schedule_dynamic_source.resolver_base==b.DATE_RESOLVER_JOB_BASED},async save(){const e=this.getMutationVariables(),{data:t}=await this.$apollo.mutate({mutation:N,variables:e});return t.mod_perform_update_track_schedule.track},async trySave(){this.isSaving=!0;try{const e=await this.save();this.initialValues=this.getInitialValues(e),this.hideConfirmationModal(),this.showSuccessNotification(),this.isSaving=!1,this.hasUnsavedChanges(!1)}catch(e){this.hideConfirmationModal(),this.showErrorNotification(),this.isSaving=!1}},showConfirmationModal(e){this.formValuesToSave=e,this.confirmationModalOpen=!0},hideConfirmationModal(){this.formValuesToSave=null,this.confirmationModalOpen=!1},showErrorNotification(){Object(y.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},showSuccessNotification(){Object(y.notify)({message:this.$str("toast_success_save_schedule","mod_perform"),type:"success"})},validator(e){if(!this.toggleValues.dueDateIsEnabled)return{};const t=this.$str("due_date_error_must_be_after_creation_date","mod_perform"),i=this.$str("due_date_error_not_integer","mod_perform");if("fixed"===this.dueDateType){if(e.fixedDueDate.iso===e.scheduleFixed.to.iso||!Object(S.isIsoAfter)(e.fixedDueDate.iso,e.scheduleFixed.to.iso))return{fixedDueDate:t}}else{const n=Number(e.dueDateOffset.relative.value);if(!Number.isInteger(n))return{dueDateOffset:{relative:i}};if(n<=0)return{dueDateOffset:{relative:t}}}return{}},hasUnsavedChanges(e){this.$emit("unsaved-changes",e)}}},A=(i("2lg0"),i("KHd+")),C=function(e){e.options.__langStrings={mod_perform:["activity_instance_creation_heading","due_date_error_not_integer","due_date_error_must_be_after_creation_date","due_date","due_date_is_enabled","modal_confirm","schedule_confirm_title","schedule_confirm_title_active","schedule_confirm_title_draft","schedule_save_changes","schedule_is_fixed","schedule_is_open","toast_error_generic_update","toast_success_save_schedule"],core:["cancel"]}},E=Object(A.a)(F,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performAssignmentSchedule"},[i("h3",{staticClass:"tui-performAssignmentSchedule__heading"},[e._v("\n    "+e._s(e.$str("activity_instance_creation_heading","mod_perform"))+"\n  ")]),e._v(" "),i("Toggles",{model:{value:e.toggleValues,callback:function(t){e.toggleValues=t},expression:"toggleValues"}}),e._v(" "),i("Uniform",{class:"tui-performAssignmentSchedule__form",attrs:{"initial-values":e.initialValues,"input-width":"full",validate:e.validator},on:{submit:e.showConfirmationModal,change:e.onChange},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.reset;return[i("CreationRange",{staticClass:"tui-performAssignmentSchedule__form-section",attrs:{"is-open":e.toggleValues.scheduleIsOpen,"is-fixed":e.toggleValues.scheduleIsFixed,"dynamic-date-sources":e.dynamicDateSources,"dynamic-date-setting-component":e.dynamicDateSettingComponent}}),e._v(" "),i("FrequencySettings",{staticClass:"tui-performAssignmentSchedule__form-section",attrs:{"is-open":e.toggleValues.scheduleIsOpen,"is-repeating":e.toggleValues.repeatingIsEnabled}}),e._v(" "),i("DueDateSettings",{staticClass:"tui-performAssignmentSchedule__form-section",attrs:{"is-enabled":e.toggleValues.dueDateIsEnabled,"is-fixed":"fixed"===e.dueDateType,"schedule-is-limited-fixed":!e.toggleValues.scheduleIsOpen&&e.toggleValues.scheduleIsFixed}}),e._v(" "),i("AdditionalScheduleSettings",{staticClass:"tui-performAssignmentSchedule__form-additional",attrs:{"uses-job-based-dynamic-source":e.isUsingJobBasedDynamicSource,"dynamic-source-name":e.dynamicDateSourceName}}),e._v(" "),i("FormRow",{staticClass:"tui-performAssignmentSchedule__form-buttons"},[i("ButtonGroup",[i("Button",{attrs:{disabled:e.isSaving,styleclass:{primary:"true"},text:e.$str("schedule_save_changes","mod_perform"),formnovalidate:!0,type:"submit"}}),e._v(" "),i("Button",{attrs:{disabled:e.isSaving,text:e.$str("cancel","core")},on:{click:n}})],1)],1)]}}])}),e._v(" "),i("ConfirmationModal",{attrs:{title:e.$str("schedule_confirm_title","mod_perform"),"confirm-button-text":e.$str("modal_confirm","mod_perform"),open:e.confirmationModalOpen},on:{confirm:e.trySave,cancel:e.hideConfirmationModal}},[i("p",[e._v("\n      "+e._s(e.$str(e.isActive?"schedule_confirm_title_active":"schedule_confirm_title_draft","mod_perform"))+"\n    ")])])],1)}),[],!1,null,null,null);"function"==typeof C&&C(E),E.options.__hasBlocks={script:!0,template:!0};t.default=E.exports},eR12:function(e,t,i){"use strict";i.r(t);var n=i("vyVp"),a=i("C+/B"),s=i.n(a),r=i("nEm4"),o=i.n(r),l=i("i/kK"),d=i.n(l),c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_toggle_activity_multisection_setting"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"toggle_activity_setting"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_toggle_activity_multisection_setting"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"raw_created_at"},name:{kind:"Name",value:"created_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_updated_at"},name:{kind:"Name",value:"updated_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]}]}}]}}]}}]},u=i("lOlL"),m=i.n(u),_={components:{ConfirmationModal:s.a,Form:o.a,FormRow:d.a,ToggleSwitch:m.a},props:{activity:{type:Object,required:!0}},data(){return{isSaving:!1,modalOpen:!1,value:this.activity.settings.multisection}},methods:{openModal(){this.modalOpen=!0},modalCancelled(){this.modalOpen=!1,this.value=!this.value},modalConfirmed(){this.modalOpen=!1,this.save()},async save(){this.isSaving=!0;try{const{data:e}=await this.$apollo.mutate({mutation:c,variables:{input:{activity_id:this.activity.id,setting:this.value}},refetchAll:!1}),t=Object.assign({},this.activity.settings,{multisection:e.mod_perform_toggle_activity_multisection_setting.settings.multisection}),i=Object.assign({},e.mod_perform_toggle_activity_multisection_setting,{settings:t});this.$emit("change",i),Object(n.notify)({message:this.$str("toast_success_activity_update","mod_perform"),type:"success"})}catch(e){Object(n.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})}this.isSaving=!1}}},p=i("KHd+"),v=function(e){e.options.__langStrings={mod_perform:["multiple_sections","multiple_sections_disabled_confirmation_text","multiple_sections_enabled_confirmation_text","multiple_sections_confirmation_title","multiple_sections_label_help","modal_confirm","toast_success_activity_update","toast_error_generic_update"]}},f=Object(p.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-activityMultipleSectionToggle"},[i("Form",[i("FormRow",{attrs:{label:e.$str("multiple_sections","mod_perform"),helpmsg:e.$str("multiple_sections_label_help","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.label;return[i("ToggleSwitch",{attrs:{disabled:e.isSaving,"aria-label":n,"toggle-first":!0},on:{input:e.openModal},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})]}}])})],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.modalOpen,title:e.$str("multiple_sections_confirmation_title","mod_perform"),"confirm-button-text":e.$str("modal_confirm","mod_perform")},on:{confirm:e.modalConfirmed,cancel:e.modalCancelled}},[e._v("\n    "+e._s(e.value?e.$str("multiple_sections_enabled_confirmation_text","mod_perform"):e.$str("multiple_sections_disabled_confirmation_text","mod_perform"))+"\n  ")])],1)}),[],!1,null,null,null);"function"==typeof v&&v(f),f.options.__hasBlocks={script:!0,template:!0};t.default=f.exports},eRy6:function(e,t,i){"use strict";var n=i("5Ag4");i.n(n).a},eYNO:function(e,t){e.exports=tui.require("tui/components/dropdown/DropdownGroup")},eYZS:function(e,t,i){},ejU1:function(e,t,i){},f056:function(e,t,i){"use strict";var n=i("p4hk");i.n(n).a},"f8+O":function(e,t){e.exports=tui.require("mod_perform/components/element/participant_form/NoResponseSubmitted")},fCWf:function(e,t){e.exports=tui.require("tui/components/links/ActionLink")},fLIY:function(e,t,i){},fkPW:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/notification/RecipientsTable")},fooM:function(e,t,i){"use strict";i.r(t);var n=i("bOP/"),a=i.n(n),s=i("C/Jh"),r=i.n(s),o=i("C+/B"),l=i.n(o),d=i("gLvT"),c=i.n(d),u=i("KGcv"),m=i.n(u),_=i("tNJr"),p=i.n(_),v=i("X8xi"),f=i.n(v),g=i("vyVp"),k=i("KxNG"),h={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_clone_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_clone_activity_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_clone_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}}]}}]}}]}}]},y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_delete_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_delete_activity_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_delete_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[]}]}}]},S={components:{ActivateActivityModal:a.a,Users:r.a,ConfirmationModal:l.a,Dropdown:c.a,DropdownItem:m.a,MoreButton:p.a,TasksIcon:f.a},props:{activity:{required:!0,type:Object}},data:()=>({deleteModalOpen:!1,deleting:!1}),computed:{activityIsDraft(){return this.activity.state_details.name===k.ACTIVITY_STATUS_DRAFT},deleteConfirmationTitle(){return this.activityIsDraft?this.$str("modal_delete_draft_title","mod_perform"):this.$str("modal_delete_title","mod_perform")},participationManagementUrl(){return this.$url("/mod/perform/manage/participation/subject_instances.php",{activity_id:this.activity.id})},participationReportingUrl(){return this.$url("/mod/perform/reporting/participation/index.php",{activity_id:this.activity.id})}},methods:{async cloneActivity(){try{const e=await this.$apollo.mutate({mutation:h,variables:{input:{activity_id:this.activity.id}}});this.$emit("activity-cloned",{clone:e.data.mod_perform_clone_activity.activity,id:this.activity.id})}catch(e){this.showErrorNotification()}},closeDeleteModal(){this.deleteModalOpen=!1,this.deleting=!1},async deleteActivity(){this.deleting=!0;try{await this.$apollo.mutate({mutation:y,variables:{input:{activity_id:this.activity.id}}}),this.showDeleteSuccessNotification()}catch(e){this.showErrorNotification()}this.$emit("refetch"),this.closeDeleteModal()},showDeleteModal(){this.deleteModalOpen=!0},showDeleteSuccessNotification(){let e=this.$str("toast_success_activity_deleted","mod_perform");this.activityIsDraft&&(e=this.$str("toast_success_draft_activity_deleted","mod_perform")),Object(g.notify)({message:e,type:"success"})},showErrorNotification(){Object(g.notify)({message:this.$str("toast_error_generic_update","mod_perform",this.activity.name),type:"error"})}}},b=(i("UFn/"),i("KHd+")),N=function(e){e.options.__langStrings={mod_perform:["activity_action_activate","activity_action_clone","activity_action_delete","activity_action_options","manage_participation","modal_delete_confirmation_line","modal_delete_draft_message","modal_delete_draft_title","modal_delete_message","modal_delete_message_data_recovery_warning","modal_delete_title","participation_reporting","toast_error_generic_update","toast_success_activity_deleted","toast_success_draft_activity_deleted"],core:["delete"]}},F=Object(b.a)(S,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performActivityActions"},[e.activityIsDraft?e._e():i("a",{staticClass:"tui-performActivityActions__item",attrs:{href:e.participationManagementUrl,title:e.$str("manage_participation","mod_perform")}},[i("Users",{attrs:{alt:e.$str("manage_participation","mod_perform"),title:e.$str("manage_participation","mod_perform"),size:"200"}})],1),e._v(" "),e.activity.can_view_participation_reporting&&!e.activityIsDraft?i("a",{staticClass:"tui-performActivityActions__item",attrs:{href:e.participationReportingUrl,title:e.$str("participation_reporting","mod_perform")}},[i("TasksIcon",{attrs:{alt:e.$str("participation_reporting","mod_perform"),title:e.$str("participation_reporting","mod_perform"),size:"200"}})],1):e._e(),e._v(" "),e.activity.can_manage?i("Dropdown",{staticClass:"tui-performActivityActions__item",attrs:{position:"bottom-right"},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle;return[i("MoreButton",{attrs:{"no-padding":!0,"aria-label":e.$str("activity_action_options","mod_perform")},on:{click:n}})]}}],null,!1,3892238058)},[e._v(" "),e.activity.can_potentially_activate?i("DropdownItem",{on:{click:function(t){return e.$refs.activateActivityModal.open()}}},[e._v("\n      "+e._s(e.$str("activity_action_activate","mod_perform"))+"\n    ")]):e._e(),e._v(" "),e.activity.can_clone?i("DropdownItem",{on:{click:e.cloneActivity}},[e._v("\n      "+e._s(e.$str("activity_action_clone","mod_perform"))+"\n    ")]):e._e(),e._v(" "),i("DropdownItem",{on:{click:e.showDeleteModal}},[e._v("\n      "+e._s(e.$str("activity_action_delete","mod_perform"))+"\n    ")])],1):e._e(),e._v(" "),e.activity.can_potentially_activate?i("ActivateActivityModal",{ref:"activateActivityModal",attrs:{activity:e.activity},on:{refetch:function(t){return e.$emit("refetch")}}}):e._e(),e._v(" "),i("ConfirmationModal",{attrs:{open:e.deleteModalOpen,title:e.deleteConfirmationTitle,"confirm-button-text":e.$str("delete"),loading:e.deleting},on:{confirm:e.deleteActivity,cancel:e.closeDeleteModal}},[e.activityIsDraft?[i("p",[e._v(e._s(e.$str("modal_delete_draft_message","mod_perform")))])]:[i("p",[e._v(e._s(e.$str("modal_delete_message","mod_perform")))]),e._v(" "),i("p",[i("strong",[e._v("\n          "+e._s(e.$str("modal_delete_message_data_recovery_warning","mod_perform"))+"\n        ")])])],e._v(" "),i("p",[e._v(e._s(e.$str("modal_delete_confirmation_line","mod_perform")))])],2)],1)}),[],!1,null,null,null);"function"==typeof N&&N(F),F.options.__hasBlocks={script:!0,template:!0};t.default=F.exports},fqqR:function(e,t){e.exports=tui.require("mod_perform/components/report/manage_participation/SubjectInstanceOpenCloseActionModal")},fw38:function(e,t){e.exports=tui.require("tui/components/form/Select")},"g8/U":function(e,t){e.exports=tui.require("tui/components/layouts/PageHeading")},gH98:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/ResponseRelationshipSelector")},gLvT:function(e,t){e.exports=tui.require("tui/components/dropdown/Dropdown")},gNII:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/GeneralInfoTab")},gRxV:function(e,t,i){"use strict";i.r(t);var n=i("fCWf"),a=i.n(n),s=i("SNFb"),r=i.n(s),o=i("C+/B"),l=i.n(o),d=i("JXQf"),c=i.n(d),u=i("g8/U"),m=i.n(u),_=i("KxNG"),p=i("vyVp"),v=i("E7bt"),f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_add_participants"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_add_participants_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_add_participants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]}}]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_subject_instance_for_participation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_subject_instance_for_participant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]}}]},k={components:{ActivityParticipants:r.a,ActionLink:a.a,ConfirmationModal:l.a,Loader:c.a,PageHeading:m.a},props:{subjectInstanceId:{required:!0,type:Number},goBackLink:{required:!0,type:String}},data:()=>({subjectInstance:null,relationships:[],selectedUsers:[],openConfirmationModal:!1,isSaving:!1}),apollo:{subjectInstance:{query:g,variables(){return{subject_instance_id:this.subjectInstanceId}},update({mod_perform_subject_instance_for_participant:e}){return this.initialiseRelationships(e),e}}},computed:{confirmationMessage(){return 1===this.selectedUsers.length?this.$str("manual_participant_add_confirmation_message_singular","mod_perform"):this.$str("manual_participant_add_confirmation_message","mod_perform",this.selectedUsers.length)}},methods:{showConfirmModal(e){this.selectedUsers=this.getParticipantsToSave(e),this.openConfirmationModal=!0},closeConfirmModal(){this.selectedUsers=[],this.openConfirmationModal=!1},initialiseRelationships(e){const t={};e.activity.sections.map(e=>e.section_relationships.map(e=>e.core_relationship)).forEach(e=>{e.forEach(e=>{e.idnumber!==_.RELATIONSHIP_SUBJECT&&e.idnumber!==_.RELATIONSHIP_PERFORM_EXTERNAL&&(t[e.id]=e)})}),this.relationships=Object.values(t)},validate(e){return Object.values(e).some(e=>e.length>0)?{}:{error:this.$str("manual_participant_add_require_at_least_one","mod_perform")}},async save(){this.isSaving=!0;try{const{data:e}=await this.$apollo.mutate({mutation:f,variables:{input:{subject_instance_ids:[this.subjectInstanceId],participants:this.selectedUsers}},refetchAll:!1});this.$refs.form.hasChanges=!1,Object(v.redirectWithPost)(this.goBackLink,{participant_instance_created_count:e.mod_perform_add_participants.participant_instances.length})}catch(e){Object(p.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"}),this.isSaving=!1,this.closeConfirmModal()}},getParticipantsToSave(e){let t=[];return e.forEach(e=>{e.users.forEach(i=>{t.push({core_relationship_id:e.relationship_id,participant_id:i.user_id})})}),t}}},h=(i("Qfz1"),i("KHd+")),y=function(e){e.options.__langStrings={mod_perform:["add_participants_page_title","back_to_manage_participation","button_cancel","button_create","manual_participant_add_confirmation_message","manual_participant_add_confirmation_message_singular","manual_participant_add_confirmation_title","manual_participant_add_no_relationships","manual_participant_add_require_at_least_one","toast_error_generic_update"]}},S=Object(h.a)(k,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performAddParticipants"},[i("a",{attrs:{href:e.$url(e.goBackLink)}},[e._v("\n    "+e._s(e.$str("back_to_manage_participation","mod_perform"))+"\n  ")]),e._v(" "),i("div",{staticClass:"tui-performAddParticipants__content"},[i("PageHeading",{attrs:{title:e.$str("add_participants_page_title","mod_perform")}}),e._v(" "),i("Loader",{attrs:{loading:e.$apollo.loading}}),e._v(" "),e.subjectInstance?i("ActivityParticipants",{ref:"form",attrs:{"subject-instance":e.subjectInstance,relationships:e.relationships,"require-input":!1,"is-saving":e.isSaving,validate:e.validate},on:{submit:e.showConfirmModal},scopedSlots:e._u([0===e.relationships.length?{key:"meta",fn:function(){return[i("p",[e._v("\n          "+e._s(e.$str("manual_participant_add_no_relationships","mod_perform"))+"\n        ")])]},proxy:!0}:null,{key:"buttons",fn:function(){return[i("ActionLink",{attrs:{href:e.goBackLink,text:e.$str("button_cancel","mod_perform")}})]},proxy:!0}],null,!0)}):e._e()],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.openConfirmationModal,title:e.$str("manual_participant_add_confirmation_title","mod_perform"),"confirm-button-text":e.$str("button_create","mod_perform"),loading:e.isSaving},on:{confirm:e.save,cancel:e.closeConfirmModal}},[i("p",[e._v(e._s(e.confirmationMessage))])])],1)}),[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0};t.default=S.exports},"gZ/S":function(e,t,i){"use strict";i.r(t);var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_activate_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_activate_activity_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activate_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}}]}}]}}]}}]},a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_activity_users_to_assign_count"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activity_users_to_assign_count"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[]}]}}]},s=i("C+/B"),r=i.n(s),o=i("D31S"),l=i.n(o),d=i("vyVp"),c={components:{ConfirmationModal:r.a,InformationModal:l.a},props:{activity:{required:!0,type:Object},triggerOpen:Boolean},data:()=>({confirmActivateModalOpen:!1,draftNotReadyModalOpen:!1,usersToAssignCount:0,loading:!1}),watch:{triggerOpen(){this.triggerOpen&&this.open()},loading(){this.$emit("update-loading",this.loading)}},methods:{async open(){this.loading=!0;try{const{data:e}=await this.$apollo.query({query:a,variables:{activity_id:this.activity.id},fetchPolicy:"no-cache"});this.usersToAssignCount=e.mod_perform_activity_users_to_assign_count,null!=this.usersToAssignCount?this.openConfirmActivationModal():this.openDraftNotReadyModal()}catch(e){this.showErrorNotification(),this.$emit("refetch")}this.loading=!1},openConfirmActivationModal(){this.confirmActivateModalOpen=!0},closeConfirmActivationModal(){this.confirmActivateModalOpen=!1,this.$emit("close-activate-modal",!1)},openDraftNotReadyModal(){this.draftNotReadyModalOpen=!0},closeDraftNotReadyModal(){this.draftNotReadyModalOpen=!1,this.$emit("close-activate-modal",!1)},async activateActivity(){this.loading=!0;try{await this.$apollo.mutate({mutation:n,variables:{input:{activity_id:this.activity.id}}}),this.showSuccessNotification()}catch(e){this.showErrorNotification()}this.$emit("refetch"),this.$emit("unsaved-changes",!1),this.closeConfirmActivationModal(),this.loading=!1},showSuccessNotification(){Object(d.notify)({message:this.$str("toast_success_activity_activated","mod_perform",this.activity.name),type:"success"})},showErrorNotification(){Object(d.notify)({message:this.$str("toast_error_generic_update","mod_perform",this.activity.name),type:"error"})}}},u=i("KHd+"),m=function(e){e.options.__langStrings={mod_perform:["activation_criteria_assignments","activation_criteria_elements","activation_criteria_relationships","activation_criteria_schedule","activity_action_activate","button_close","modal_activate_message","modal_activate_message_question","modal_activate_message_users","modal_activate_title","modal_can_not_activate_message","modal_can_not_activate_title","participation_reporting","toast_error_generic_update","toast_success_activity_activated"]}},_=Object(u.a)(c,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",[e._t("trigger",null,{open:e.open,loading:e.loading}),e._v(" "),i("ConfirmationModal",{attrs:{open:e.confirmActivateModalOpen,title:e.$str("modal_activate_title","mod_perform"),"confirm-button-text":e.$str("activity_action_activate","mod_perform"),loading:e.loading},on:{confirm:e.activateActivity,cancel:e.closeConfirmActivationModal}},[i("p",[e._v("\n      "+e._s(e.$str("modal_activate_message","mod_perform"))+"\n    ")]),e._v(" "),i("p",{domProps:{innerHTML:e._s(e.$str("modal_activate_message_users","mod_perform",e.usersToAssignCount))}}),e._v(" "),i("p",[e._v("\n      "+e._s(e.$str("modal_activate_message_question","mod_perform"))+"\n    ")])]),e._v(" "),i("InformationModal",{attrs:{open:e.draftNotReadyModalOpen,title:e.$str("modal_can_not_activate_title","mod_perform")},on:{close:e.closeDraftNotReadyModal}},[i("p",[e._v(e._s(e.$str("modal_can_not_activate_message","mod_perform")))]),e._v(" "),i("ul",[i("li",[e._v(e._s(e.$str("activation_criteria_assignments","mod_perform")))]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_elements","mod_perform")))]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_relationships","mod_perform")))]),e._v(" "),i("li",[e._v(e._s(e.$str("activation_criteria_schedule","mod_perform")))])])])],2)}),[],!1,null,null,null);"function"==typeof m&&m(_),_.options.__hasBlocks={script:!0,template:!0};t.default=_.exports},h0pk:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant/JobAssignmentInformation")},hGI4:function(e,t,i){"use strict";i.r(t);var n=i("WBvU"),a=i("vF5l"),s=i.n(a),r=i("nXMa"),o=i.n(r),l=i("BN8m"),d=i.n(l),c=i("C+/B"),u=i.n(c),m=i("kKx+"),_=i.n(m),p=i("DaLk"),v=i.n(p),f=i("Rgjc"),g=i.n(f),k=i("bxeI"),h=i.n(k),y=i("JXQf"),S=i.n(y),b=i("tkAW"),N=i.n(b),F=i("u5iS"),A=i.n(F),C=i("Mnur"),E=i.n(C),I=i("zs4z"),T=i.n(I),x=i("HGXj"),O=i.n(x),w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_move_element_to_section"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_move_element_to_section_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_move_element_to_section"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"source_section_elements"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_edit_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_view_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_summary_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_title"},name:{kind:"Name",value:"title"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"identifier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_data"},name:{kind:"Name",value:"data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}}]}}]}}]},$={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_element_plugins"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_element_plugins"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"plugin_config"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"is_respondable"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"has_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"has_reporting_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title_text"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_title_required"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_response_required_enabled"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"admin_edit_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_view_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"admin_summary_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_form_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_print_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[]}]}}]}}]},D={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_section_admin"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"section_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_section_admin"},arguments:[{kind:"Argument",name:{kind:"Name",value:"section_id"},value:{kind:"Variable",name:{kind:"Name",value:"section_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_elements"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_title"},name:{kind:"Name",value:"title"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"identifier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_data"},name:{kind:"Name",value:"data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}}]}}]}}]},R={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_sections"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}}]}}]}}]},j={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_section_elements"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_update_section_elements_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_section_elements"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_elements"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"element_plugin"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"plugin_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_title"},name:{kind:"Name",value:"title"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"identifier"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"data"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_data"},name:{kind:"Name",value:"data"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"RAW"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_required"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}}]}}]}}]}}]},q=i("KxNG"),P=i("vyVp"),M=i("TXEh"),B={components:{Button:s.a,ButtonCancel:o.a,ButtonGroup:d.a,ConfirmationModal:u.a,ContentAddElementButton:_.a,Draggable:v.a,Droppable:g.a,FormRow:n.FormRow,FormSelect:n.FormSelect,Layout:h.a,Loader:S.a,Modal:N.a,ModalContent:A.a,ModalPresenter:E.a,PageBackLink:T.a,PerformAdminCustomElement:O.a,Uniform:n.Uniform},props:{activityState:{type:Object,required:!0},activityId:{type:String,required:!0},sectionId:{type:String,required:!0},title:{type:String,required:!0},isMultiSectionActive:{required:!0,type:Boolean},goBackLink:{type:Object,required:!0},activityContextId:{type:Number,required:!0}},data:()=>({elementPlugins:[],section:{title:"",section_elements:[]},sectionElements:[],sections:[],skipSectionsQuery:!0,editingIds:[],readOnlyIds:[],removeIds:[],errors:{},isSaving:!1,deleteModalOpen:!1,moveModalOpen:!1,elementToDelete:null,elementToMove:null,type:null,moveToSectionId:null}),apollo:{section:{query:D,variables(){return{section_id:this.sectionId}},update:e=>e.mod_perform_section_admin,fetchPolicy:"network-only",result({data:e}){this.updateSectionElementData(e.mod_perform_section_admin.section_elements)}},elementPlugins:{query:$,variables:()=>[],update:e=>e.mod_perform_element_plugins},sections:{query:R,variables(){return{activity_id:this.activityId}},update:e=>e.mod_perform_activity.sections,skip(){return this.skipSectionsQuery}}},computed:{isLoading(){return this.$apollo.loading||this.isSaving},hasUnsavedChanges(){return this.editingIds.length>0},isDraft(){return this.activityState.name===q.ACTIVITY_STATUS_DRAFT},otherSections(){return this.sections.map(e=>({id:e.id,label:e.display_title})).filter(e=>e.id!==this.sectionId)},moveModalId(){return this.$id("move-modal")}},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},beforeDestroy(){window.removeEventListener("beforeunload",this.unloadHandler)},methods:{add(e){const t={id:"unsaved-"+Object(M.uniqueId)(),element:{id:null,type:e,title:"",raw_title:"",identifier:"",data:{},raw_data:{}},sort_order:this.sectionElements.length+1,creating:!0};this.sectionElements.push(t),this.edit(t)},update(e,t,i){e.element=Object.assign(e.element,t,{raw_title:t.title,raw_data:t.data});const n={title:e.element.raw_title,data:JSON.stringify(e.element.raw_data)};null!=e.element.identifier&&(n.identifier=e.element.identifier),null!=e.element.is_required&&(n.is_required=e.element.is_required);const a={};e.creating?(delete e.creating,a.create_new=[Object.assign(n,{plugin_name:e.element.type.plugin_name,sort_order:this.getSortOrder(i)})],a.move=this.sectionElements.slice(i+1).filter(this.elementExists).map(e=>({section_element_id:e.id,sort_order:e.sort_order+1}))):a.update=[Object.assign(n,{element_id:e.element.id})],this.save(a,this.$str("toast_success_save_element","mod_perform")),this.display(e)},elementDoesNotExist:e=>"creating"in e,elementExists(e){return!this.elementDoesNotExist(e)},getSortOrder(e){return this.sectionElements.slice(0,e).filter(this.elementExists).length+1},edit(e){this.editingIds.push(e.id)},stopEditing(e){Object(M.pull)(this.editingIds,e.id)},isEditing(e){return this.editingIds.includes(e.id)},display(e){this.isDraft?(this.stopEditing(e),e.creating&&this.remove(e)):Object(M.pull)(this.readOnlyIds,e.id)},displayReadOnly(e){this.readOnlyIds.push(e.id)},isReadOnly(e){return this.readOnlyIds.includes(e.id)},remove(e){this.stopEditing(e),Object(M.pull)(this.sectionElements,e)},tryDelete(e,t){e.element.id?(this.deleteModalOpen=!0,this.elementToDelete=e,this.elementToDelete.index=t):this.remove(e)},showMoveModal(e,t){this.skipSectionsQuery=!1,this.moveModalOpen=!0,this.elementToMove=e,this.elementToMove.index=t},moveSelectedElement(){this.moveToSectionId&&this.elementToMove&&1===this.otherSections.filter(e=>e.id===this.moveToSectionId).length&&this.doMoveSelectedElement()},async doMoveSelectedElement(){this.isSaving=!0;try{const{data:e}=await this.$apollo.mutate({mutation:w,variables:{input:{element_id:this.elementToMove.element.id,source_section_id:this.sectionId,target_section_id:this.moveToSectionId}},refetchAll:!1});this.updateSectionElementData(e.mod_perform_move_element_to_section.source_section_elements),this.showSuccessNotification(this.$str("toast_success_move_element","mod_perform")),this.remove(this.elementToMove)}catch(e){this.showErrorNotification()}this.closeMoveModal(),this.isSaving=!1},async deleteSelectedElement(){this.isSaving=!0;const e=this.sectionElements.slice(this.elementToDelete.index+1).filter(this.elementExists).map((e,t)=>({section_element_id:e.id,sort_order:this.elementToDelete.sort_order+t}));await this.save({move:e,delete:[{section_element_id:this.elementToDelete.id}]},this.$str("toast_success_delete_element","mod_perform")),this.remove(this.elementToDelete),this.closeDeleteModal(),this.isSaving=!1},async reorderElements(e){this.isSaving=!0;const t={};t.move=e.filter(this.elementExists).map((e,t)=>({section_element_id:e.id,sort_order:t+1})),await this.save(t,null),this.isSaving=!1},closeDeleteModal(){this.deleteModalOpen=!1,this.elementToDelete=null},closeMoveModal(){this.moveModalOpen=!1,this.moveToSectionId=null},getSectionComponent(e){let t={component:"",settings:"",type:""};const{type:i}=e.element,n=this.elementPlugins.filter(e=>e.plugin_name==i.plugin_name).shift();return t.settings=n.plugin_config,this.isReadOnly(e)?(t.type="readOnly",t.component=tui.asyncComponent(n.admin_summary_component)):this.isEditing(e)?(t.type="editing",t.component=tui.asyncComponent(n.admin_edit_component)):(t.type="view",t.component=tui.asyncComponent(n.admin_view_component)),t},async save(e,t){this.isSaving=!0;try{const{data:i}=await this.$apollo.mutate({mutation:j,variables:{input:Object.assign(e,{section_id:this.sectionId})},refetchAll:!1}),n=i.mod_perform_update_section_elements.section;this.updateSectionElementData(n.section_elements),t&&this.showSuccessNotification(t),this.isSaving=!1}catch(e){this.showErrorNotification(),this.isSaving=!1}},unloadHandler(e){if(!this.hasUnsavedChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t},updateSectionElementData(e){const t=e.map(e=>{const t=this.sectionElements.find(t=>t.id===e.id);return t&&this.isEditing(t)?t:Object.assign({},e,{element:Object.assign({},e.element,{type:e.element.element_plugin,data:JSON.parse(e.element.data),raw_data:JSON.parse(e.element.raw_data)})})}),i=this.sectionElements.filter(this.elementDoesNotExist);this.sectionElements=t.concat(i).sort((e,t)=>{const i=e.sort_order-t.sort_order;return 0!==i?i:this.elementDoesNotExist(e)?-1:1})},showSuccessNotification(e){Object(P.notify)({message:e||this.$str("toast_success_save_element","mod_perform"),type:"success"})},showErrorNotification(){Object(P.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},validDragElement(e){return!this.isEditing(e)&&this.sectionElements.length>1},validateDropElement:e=>e.destination.sourceId==e.source.sourceId,handleDropElement(e){if(e.destination.sourceId==e.source.sourceId){const t=this.sectionElements.splice(e.source.index,1)[0];this.sectionElements.splice(e.destination.index,0,t),this.reorderElements(this.sectionElements)}},isElementEditable(){return"ACTIVE"!==this.activityState.name},normaliseIdentifierForElements:e=>null===e?"":e}},V=(i("6iqc"),i("KHd+")),L=function(e){e.options.__langStrings={core:["delete"],mod_perform:["modal_element_delete_message","modal_element_delete_title","modal_element_move_from","modal_element_move_message","modal_element_move_title","modal_element_move_to","move","move_element","required_fields","toast_error_generic_update","toast_success_delete_element","toast_success_move_element","toast_success_save_element","unsaved_changes_warning"]}},U=Object(V.a)(B,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Layout",{staticClass:"tui-performSectionContent",attrs:{loading:e.isLoading,title:e.title},scopedSlots:e._u([{key:"content-nav",fn:function(){return[i("PageBackLink",{attrs:{link:e.goBackLink.url,text:e.goBackLink.text}})]},proxy:!0},{key:"content",fn:function(){return[i("div",{staticClass:"tui-performSectionContent__title-required",attrs:{"aria-hidden":"true"}},[i("span",{staticClass:"tui-performSectionContent__title-requiredStar"},[e._v("\n        *\n      ")]),e._v("\n      "+e._s(e.$str("required_fields","mod_perform"))+"\n    ")]),e._v(" "),e.isDraft?i("div",{staticClass:"tui-performSectionContent__form"},[i("Droppable",{attrs:{"source-id":e.$id("element-list"),"source-name":"Element List","accept-drop":e.validateDropElement,"reorder-only":!0},on:{drop:e.handleDropElement},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.attrs,a=t.events,s=t.dropTarget,r=t.placeholder;return[i("div",e._g(e._b({staticClass:"tui-performSectionContent__dragList"},"div",n,!1),a),[i("render",{attrs:{vnode:s}}),e._v(" "),e._l(e.sectionElements,(function(t,n){return i("Draggable",{key:t.id,attrs:{index:n,value:t.id,"aria-label":e.$str("move_element","mod_perform",t.element.title),type:"element",disabled:!e.validDragElement(t)},scopedSlots:e._u([{key:"default",fn:function(a){var s=a.dragging,r=a.attrs,o=a.events,l=a.moveMenu,d=a.anyDragging;return[i("div",e._g(e._b({staticClass:"tui-performSectionContent__draggableItem"},"div",r,!1),o),[i("render",{attrs:{vnode:l}}),e._v(" "),e.elementPlugins.length?i("PerformAdminCustomElement",{attrs:{"activity-state":e.activityState,"is-multi-section-active":e.isMultiSectionActive,draggable:(!d||s)&&e.validDragElement(t)&&!e.$apollo.loading,dragging:s,"section-component":e.getSectionComponent(t),"section-element":t,"section-id":e.sectionId,"activity-context-id":e.activityContextId},on:{update:function(i){return e.update(t,i,n)},edit:function(i){return e.edit(t)},display:function(i){return e.display(t)},"display-read":function(i){return e.displayReadOnly(t)},remove:function(i){return e.tryDelete(t,n)},move:function(i){return e.showMoveModal(t,n)}}}):e._e()],1)]}}],null,!0)})})),e._v(" "),i("render",{attrs:{vnode:r}})],2)]}}],null,!1,1180840454)}),e._v(" "),i("ContentAddElementButton",{attrs:{"element-plugins":e.elementPlugins},on:{"add-element-item":e.add}})],1):i("div",{staticClass:"tui-performSectionContent__form"},[e._l(e.sectionElements,(function(t,n){return[e.elementPlugins.length?i("PerformAdminCustomElement",{key:t.id,attrs:{"activity-state":e.activityState,"is-multi-section-active":e.isMultiSectionActive,"section-component":e.getSectionComponent(t),"section-element":t,"section-id":e.sectionId},on:{update:function(i){return e.update(t,i,n)},edit:function(i){return e.edit(t)},display:function(i){return e.display(t)},"display-read":function(i){return e.displayReadOnly(t)},remove:function(i){return e.tryDelete(t,n)}}}):e._e()]}))],2)]},proxy:!0},{key:"modals",fn:function(){return[i("ConfirmationModal",{attrs:{open:e.deleteModalOpen,title:e.$str("modal_element_delete_title","mod_perform"),"confirm-button-text":e.$str("delete","core"),loading:e.isSaving},on:{confirm:e.deleteSelectedElement,cancel:e.closeDeleteModal}},[i("p",[e._v(e._s(e.$str("modal_element_delete_message","mod_perform")))])]),e._v(" "),i("ModalPresenter",{attrs:{open:e.moveModalOpen},on:{"request-close":e.closeMoveModal}},[i("Modal",{attrs:{size:"normal","aria-labelledby":e.moveModalId}},[i("ModalContent",{attrs:{"close-button":!1,title:e.$str("modal_element_move_title","mod_perform"),"title-id":e.moveModalId},on:{dismiss:e.closeMoveModal}},[i("p",[e._v("\n            "+e._s(e.$str("modal_element_move_message","mod_perform"))+"\n          ")]),e._v(" "),i("Loader",{attrs:{loading:e.$apollo.loading}},[i("Uniform",[i("FormRow",{attrs:{label:e.$str("modal_element_move_from","mod_perform")}},[e._v("\n                "+e._s(e.title)+"\n              ")]),e._v(" "),i("FormRow",{attrs:{label:e.$str("modal_element_move_to","mod_perform")},scopedSlots:e._u([{key:"default",fn:function(t){t.id,t.label;return[i("FormSelect",{attrs:{name:e.$str("modal_element_move_to","mod_perform"),options:e.otherSections},model:{value:e.moveToSectionId,callback:function(t){e.moveToSectionId=t},expression:"moveToSectionId"}})]}}])}),e._v(" "),i("FormRow",[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:"true"},disabled:e.isSaving||!e.moveToSectionId,text:e.$str("move","mod_perform")},on:{click:e.moveSelectedElement}}),e._v(" "),i("ButtonCancel",{attrs:{disabled:e.isSaving},on:{click:e.closeMoveModal}})],1)],1)],1)],1)],1)],1)],1)]},proxy:!0}])})}),[],!1,null,null,null);"function"==typeof L&&L(U),U.options.__hasBlocks={script:!0,template:!0};t.default=U.exports},hjVT:function(e,t,i){"use strict";i.r(t);var n=i("kUb+"),a=i.n(n),s=i("vF5l"),r=i.n(s),o=i("5h9J"),l=i.n(o),d=i("Bx/y"),c=i.n(d),u=i("io3G"),m=i.n(u),_=i("tkAW"),p=i.n(_),v=i("u5iS"),f=i.n(v),g=i("Mnur"),k=i.n(g),h={components:{ActionCard:a.a,Button:r.a,ButtonIcon:l.a,DownloadIcon:c.a,ExportConfirmModal:m.a,Modal:p.a,ModalContent:f.a,ModalPresenter:k.a},props:{additionalExportHrefParams:{type:Object,required:!0},rowCount:{type:Number,required:!0},embeddedShortname:{type:String,required:!0},filterHash:{type:String,required:!0},exportRowLimit:{type:Number,required:!0}},data:()=>({exportConfirmModal:!1,exportLimitExceededModal:!1}),computed:{exportRowLimitExceeded(){return this.rowCount>this.exportRowLimit},exportHref(){if(this.exportRowLimitExceeded)return null;let e=this.additionalExportHrefParams;return Object.assign(e,{action:"bulk",export:"Export",format:"csv",filtered_report_export_type:this.embeddedShortname,filtered_report_filter_hash:this.filterHash}),this.$url("/mod/perform/reporting/performance/export.php",e)},countString(){return 1===this.rowCount?this.$str("x_record_selected","mod_perform",this.rowCount):this.$str("x_records_selected","mod_perform",this.rowCount)}},methods:{tryConfirmExport(){this.exportRowLimitExceeded?this.openExportLimitExceededModal():this.openExportConfirmModal()},openExportConfirmModal(){this.exportConfirmModal=!0},closeExportConfirmModal(){this.exportConfirmModal=!1},openExportLimitExceededModal(){this.exportLimitExceededModal=!0},closeExportLimitExceededModal(){this.exportLimitExceededModal=!1}}},y=(i("xF3i"),i("KHd+")),S=function(e){e.options.__langStrings={mod_perform:["button_cancel","export","export_all","export_confirm_modal_title","export_confirm_modal_text","export_limit_exceeded_modal_title","export_limit_exceeded_modal_text","x_record_selected","x_records_selected"],totara_core:["close"]}},b=Object(y.a)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ActionCard",{staticClass:"tui-elementResponseReportingActionCard",scopedSlots:e._u([{key:"card-body",fn:function(){return[i("span",{domProps:{innerHTML:e._s(e.countString)}})]},proxy:!0},{key:"card-action",fn:function(){return[i("ButtonIcon",{attrs:{"aria-label":e.$str("export_all","mod_perform"),styleclass:{primary:!0,small:!0},text:e.$str("export_all","mod_perform")},on:{click:e.tryConfirmExport}},[i("DownloadIcon")],1),e._v(" "),i("ExportConfirmModal",{attrs:{open:e.exportConfirmModal,"export-href":e.exportHref},on:{"request-close":e.closeExportConfirmModal}}),e._v(" "),i("ModalPresenter",{attrs:{open:e.exportLimitExceededModal},on:{"request-close":e.closeExportLimitExceededModal}},[i("Modal",{staticClass:"tui-elementResponseReportingExportConfirmModal",attrs:{"aria-labelledby":e.$id("question-element-preview-modal"),size:"normal"}},[i("ModalContent",{attrs:{title:e.$str("export_limit_exceeded_modal_title","mod_perform"),"title-id":e.$id("element-response-export-limit-exceeded-modal"),"close-button":""},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("Button",{attrs:{text:e.$str("close","totara_core")},on:{click:e.closeExportLimitExceededModal}})]},proxy:!0}])},[i("p",[e._v("\n            "+e._s(e.$str("export_limit_exceeded_modal_text","mod_perform",e.exportRowLimit))+"\n          ")])])],1)],1)]},proxy:!0}])})}),[],!1,null,null,null);"function"==typeof S&&S(b),b.options.__hasBlocks={script:!0,template:!0};t.default=b.exports},hjaT:function(e,t){e.exports=tui.require("tui/components/form/Checkbox")},"hp/q":function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("KGot"),r=i.n(s),o=i("rsf9"),l=i.n(o),d=i("29lC"),c=i.n(d),u=i("5qAA"),m=i.n(u),_=i("JXQf"),p=i.n(_),v=i("Eb8+"),f=i.n(v),g=i("PNtU"),k=i.n(g),h=i("Mnur"),y=i.n(h),S=i("tKZN"),b=i.n(S),N=i("7tcR"),F=i.n(N),A=i("yikf"),C=i.n(A),E={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_my_subject_instances"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_subject_instance_filters"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pagination"}},type:{kind:"NamedType",name:{kind:"Name",value:"core_pagination_input"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_my_subject_instances"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"pagination"},value:{kind:"Variable",name:{kind:"Name",value:"pagination"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subject"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_overdue"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"job_assignment"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"anonymous_responses"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"participant_instances"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_overdue"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_for_current_user"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"can_participate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"participant_sections"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"availability_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_overdue"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant_id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"participant"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"is_for_current_user"},arguments:[],directives:[]}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"next_cursor"},arguments:[],directives:[]}]}}]}}]},I={components:{ActivitiesFilter:c.a,Button:a.a,Cell:r.a,ExpandCell:l.a,HeaderCell:m.a,Loader:p.a,Lock:f.a,Lozenge:k.a,ModalPresenter:y.a,RelationshipSelector:F.a,SectionsList:b.a,Table:C.a},props:{currentUserId:{required:!0,type:Number},about:{type:String,validator:e=>["self","others"].includes(e)},viewUrl:{type:String,required:!0},printUrl:{type:String,required:!0},filterOptions:Object},data:()=>({subjectInstances:[],isRelationshipSelectorShown:!1,selectedParticipantSections:[],selectedSubjectUser:{},singleSectionViewOnlyActivities:[],relationshipSelectorUrl:"",userFilters:{activityType:"",ownProgress:"",overdueOnly:!1},pagination:{nextCursor:"",total:0}}),computed:{aboutFilter(){return[this.about.toUpperCase()]},isAboutOthers(){return"others"===this.about},hasSubjectInstanceWithJobAssignment(){return this.subjectInstances.some(e=>e.subject&&null!==e.subject.job_assignment&&null!==e.subject.job_assignment.idnumber)},hasFilter(){return""!=this.userFilters.activityType||""!=this.userFilters.ownProgress||this.userFilters.overdueOnly},showFilter(){return this.hasFilter||this.subjectInstances.length>0},showLoadMore(){return this.subjectInstances.length>0&&""!==this.pagination.nextCursor},emptyListText(){return this.hasFilter?this.$str("user_activities_list_none_filtered","mod_perform"):this.isAboutOthers?this.$str("user_activities_list_none_about_others","mod_perform"):this.$str("user_activities_list_none_about_self","mod_perform")},currentFilterOptions(){let e={about:this.aboutFilter,activity_type:this.userFilters.activityType||null,participant_progress:this.userFilters.ownProgress||null};return this.userFilters.overdueOnly&&(e.overdue=!0),e}},apollo:{subjectInstances:{query:E,variables(){return{filters:this.currentFilterOptions}},update:e=>e.mod_perform_my_subject_instances.items,result({data:e}){this.pagination={nextCursor:e.mod_perform_my_subject_instances.next_cursor||"",total:e.mod_perform_my_subject_instances.total||0}}}},methods:{getViewActivityUrl(e){const t=this.getFirstSectionToParticipate(e.sections);return t?this.$url(this.viewUrl,{participant_section_id:t.id}):""},getJobAssignmentDescription(e){if(!e)return this.$str("all_job_assignments","mod_perform");let t=e.fullname;return t&&(t=t.trim()),t&&t.length>0?t:this.$str("unnamed_job_assignment","mod_perform",e.idnumber)},getFirstSectionToParticipate(e){let t=null;return e.forEach(e=>{let i=e.participant_sections.find(e=>e.participant_instance.is_for_current_user);i&&null===t&&(t=i)}),t},showRelationshipSelector(e,t){this.selectedSubjectUser=e.subject.subject_user,this.selectedParticipantSections=[],e.sections.forEach(e=>{e.participant_sections.forEach(e=>{this.selectedParticipantSections.push(e)})}),this.relationshipSelectorUrl=t?this.printUrl:this.viewUrl,this.isRelationshipSelectorShown=!0},hideRelationshipSelector(){this.isRelationshipSelectorShown=!1},getStatusText(e){switch(e){case"NOT_STARTED":return this.$str("user_activities_status_not_started","mod_perform");case"IN_PROGRESS":return this.$str("user_activities_status_in_progress","mod_perform");case"COMPLETE":return this.$str("user_activities_status_complete","mod_perform");case"PROGRESS_NOT_APPLICABLE":return this.$str("user_activities_status_not_applicable","mod_perform");case"NOT_SUBMITTED":return this.$str("user_activities_status_not_submitted","mod_perform");default:return""}},getYourProgressText(e){return this.filterToCurrentUser(e).map(e=>this.getParticipantStatusText(e.progress_status)).join(", ")},getParticipantStatusText(e){switch(e){case"NOT_STARTED":return this.$str("participant_instance_status_not_started","mod_perform");case"IN_PROGRESS":return this.$str("participant_instance_status_in_progress","mod_perform");case"COMPLETE":return this.$str("participant_instance_status_complete","mod_perform");case"PROGRESS_NOT_APPLICABLE":return this.$str("participant_instance_status_progress_not_applicable","mod_perform");case"NOT_SUBMITTED":return this.$str("participant_instance_status_not_submitted","mod_perform");default:return""}},allYourInstancesAreClosed(e){return!e.find(e=>parseInt(e.participant_id)===this.currentUserId&&e.availability_status&&"CLOSED"!==e.availability_status)},allYourInstancesAreOverdue(e){return!e.find(e=>parseInt(e.participant_id)===this.currentUserId&&!e.is_overdue)},getActivityTitle(e){var t=e.activity.name.trim(),i=e.created_at?e.created_at.trim():"";return i?this.$str("activity_title_with_subject_creation_date","mod_perform",{title:t,date:i}):t},getRelationshipText(e){return this.filterToCurrentUser(e).map(e=>e.core_relationship.name).join(", ")},getExpandLabel(e){const t=this.getActivityTitle(e.subject);return this.isAboutOthers?this.$str("activity_title_for_subject","mod_perform",{activity:t,user:e.subject.subject_user.fullname}):t},currentUserHasMultipleRelationships(e){return this.filterToCurrentUser(e).length>1},filterToCurrentUser:e=>e.filter(e=>e.is_for_current_user),flagActivitySingleSectionViewOnly(e){this.singleSectionViewOnlyActivities.push(e)},isSingleSectionViewOnly(e){return this.singleSectionViewOnlyActivities.includes(e)},printActivity(e){if(this.currentUserHasMultipleRelationships(e.subject.participant_instances))return void this.showRelationshipSelector(e,!0);const t=this.getFirstSectionToParticipate(e.sections),i=this.$url(this.printUrl,{participant_section_id:t.id});window.open(i)},applyFilters(e){this.userFilters=e,this.nextCursor=""},loadMore(){this.$apollo.queries.subjectInstances.fetchMore({variables:{filters:this.currentFilterOptions,pagination:{cursor:this.pagination.nextCursor}},updateQuery:(e,{fetchMoreResult:t})=>({mod_perform_my_subject_instances:{items:[...e.mod_perform_my_subject_instances.items,...t.mod_perform_my_subject_instances.items],next_cursor:t.mod_perform_my_subject_instances.next_cursor||"",total:t.mod_perform_my_subject_instances.total||0}})})}}},T=(i("n/29"),i("KHd+")),x=function(e){e.options.__langStrings={mod_perform:["activity_title_for_subject","activity_title_with_subject_creation_date","all_job_assignments","is_overdue","participant_instance_status_complete","participant_instance_status_in_progress","participant_instance_status_not_started","participant_instance_status_not_submitted","participant_instance_status_progress_not_applicable","print_activity","unnamed_job_assignment","user_activities_closed","user_activities_complete_before","user_activities_created_at","user_activities_filter","user_activities_job_assignment_header","user_activities_list_none_about_others","user_activities_list_none_about_self","user_activities_list_none_filtered","user_activities_single_section_view_only_activity","user_activities_status_complete","user_activities_status_header_activity","user_activities_status_header_participation","user_activities_status_header_relationship","user_activities_status_in_progress","user_activities_status_not_applicable","user_activities_status_not_started","user_activities_status_not_submitted","user_activities_subject_header","user_activities_title_header","user_activities_type_header"],totara_core:["loadmore"]}},O=Object(T.a)(I,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivityList"},[e.showFilter?i("ActivitiesFilter",{attrs:{"filter-options":e.filterOptions,shown:e.subjectInstances.length,total:e.pagination.total},on:{"update-filters":e.applyFilters}}):e._e(),e._v(" "),i("Loader",{attrs:{loading:e.$apollo.loading}},[e.$apollo.loading?e._e():i("Table",{attrs:{data:e.subjectInstances,"no-items-text":e.emptyListText,"expandable-rows":!0},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("ExpandCell",{attrs:{header:!0}}),e._v(" "),i("HeaderCell",{attrs:{size:e.isAboutOthers?"3":"7"}},[e._v("\n          "+e._s(e.$str("user_activities_title_header","mod_perform"))+"\n        ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n          "+e._s(e.$str("user_activities_type_header","mod_perform"))+"\n        ")]),e._v(" "),e.isAboutOthers?i("HeaderCell",{attrs:{size:"2"}},[e._v("\n          "+e._s(e.$str("user_activities_subject_header","mod_perform"))+"\n        ")]):e._e(),e._v(" "),e.hasSubjectInstanceWithJobAssignment?i("HeaderCell",{attrs:{size:"2"}},[e._v("\n          "+e._s(e.$str("user_activities_job_assignment_header","mod_perform"))+"\n        ")]):e._e(),e._v(" "),e.isAboutOthers?i("HeaderCell",{attrs:{size:"2"}},[e._v("\n          "+e._s(e.$str("user_activities_status_header_relationship","mod_perform"))+"\n        ")]):e._e(),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n          "+e._s(e.$str("user_activities_status_header_activity","mod_perform"))+"\n        ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n          "+e._s(e.$str("user_activities_status_header_participation","mod_perform"))+"\n        ")])]},proxy:!0},{key:"row",fn:function(t){var n=t.row,a=t.expand,s=t.expandState;return[i("ExpandCell",{attrs:{"aria-label":e.getExpandLabel(n),"expand-state":s,size:"1"},on:{click:function(e){return a()}}}),e._v(" "),i("Cell",{attrs:{size:e.isAboutOthers?"3":"7","column-header":e.$str("user_activities_title_header","mod_perform"),valign:"center"}},[e.currentUserHasMultipleRelationships(n.subject.participant_instances)?i("Button",{staticClass:"tui-performUserActivityList__selectRelationshipLink",attrs:{styleclass:{transparent:!0},text:e.getActivityTitle(n.subject)},on:{click:function(t){return t.preventDefault(),e.showRelationshipSelector(n)}}}):i("a",{attrs:{href:e.getViewActivityUrl(n)}},[e._v("\n            "+e._s(e.getActivityTitle(n.subject))+"\n          ")])],1),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_type_header","mod_perform")}},[e._v("\n          "+e._s(n.subject.activity.type.display_name)+"\n        ")]),e._v(" "),e.isAboutOthers?i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_subject_header","mod_perform"),valign:"center"}},[e._v("\n          "+e._s(n.subject.subject_user.fullname)+"\n        ")]):e._e(),e._v(" "),e.hasSubjectInstanceWithJobAssignment?i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_job_assignment_header","mod_perform"),valign:"center"}},[e._v("\n          "+e._s(e.getJobAssignmentDescription(n.subject.job_assignment))+"\n        ")]):e._e(),e._v(" "),e.isAboutOthers?i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_status_header_relationship","mod_perform"),valign:"center"}},[e._v("\n          "+e._s(e.getRelationshipText(n.subject.participant_instances))+"\n        ")]):e._e(),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_status_header_activity","mod_perform"),valign:"center"}},[e._v("\n          "+e._s(e.getStatusText(n.subject.progress_status))+"\n          "),n.subject.is_overdue?i("Lozenge",{attrs:{type:"alert",text:e.$str("is_overdue","mod_perform")}}):e._e(),e._v(" "),"CLOSED"===n.subject.availability_status?i("Lock",{attrs:{alt:e.$str("user_activities_closed","mod_perform"),title:e.$str("user_activities_closed","mod_perform")}}):e._e()],1),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_activities_status_header_participation","mod_perform"),valign:"center"}},[e._v("\n          "+e._s(e.getYourProgressText(n.subject.participant_instances))+"\n          "),e.allYourInstancesAreOverdue(n.subject.participant_instances)?i("Lozenge",{attrs:{type:"alert",text:e.$str("is_overdue","mod_perform")}}):e._e(),e._v(" "),e.allYourInstancesAreClosed(n.subject.participant_instances)?i("Lock",{attrs:{alt:e.$str("user_activities_closed","mod_perform"),title:e.$str("user_activities_closed","mod_perform")}}):e._e()],1)]}},{key:"expand-content",fn:function(t){var n=t.row;return[i("div",{staticClass:"tui-performUserActivityList__expandedRow"},[i("p",{staticClass:"tui-performUserActivityList__expandedRow-dateSummary"},[e._v("\n            "+e._s(e.$str("user_activities_created_at","mod_perform",n.subject.created_at))+"\n            "),n.subject.due_date?i("span",[e._v("\n              "+e._s(e.$str("user_activities_complete_before","mod_perform",n.subject.due_date))+"\n            ")]):e._e(),e._v(" "),e.isSingleSectionViewOnly(n.subject.activity.id)?i("span",[e._v("\n              "+e._s(e.$str("user_activities_single_section_view_only_activity","mod_perform"))+"\n            ")]):e._e()]),e._v(" "),i("SectionsList",{attrs:{"activity-id":n.subject.activity.id,"subject-sections":n.sections,"is-multi-section-active":n.subject.activity.settings.multisection,"view-url":e.viewUrl,"current-user-id":e.currentUserId,"subject-user":n.subject.subject_user,"anonymous-responses":n.subject.activity.anonymous_responses},on:{"single-section-view-only":e.flagActivitySingleSectionViewOnly}}),e._v(" "),i("Button",{attrs:{text:e.$str("print_activity","mod_perform"),styleclass:{small:!0}},on:{click:function(t){return e.printActivity(n)}}})],1)]}}],null,!1,2453764763)}),e._v(" "),e.showLoadMore?i("div",{staticClass:"tui-performUserActivityList__loadMore"},[i("Button",{attrs:{text:e.$str("loadmore","totara_core")},on:{click:e.loadMore}})],1):e._e()],1),e._v(" "),i("ModalPresenter",{attrs:{open:e.isRelationshipSelectorShown},on:{"request-close":e.hideRelationshipSelector}},[i("RelationshipSelector",{attrs:{"current-user-id":e.currentUserId,"participant-sections":e.selectedParticipantSections,"is-for-section":!1,"subject-user":e.selectedSubjectUser,"view-url":e.relationshipSelectorUrl},model:{value:e.isRelationshipSelectorShown,callback:function(t){e.isRelationshipSelectorShown=t},expression:"isRelationshipSelectorShown"}})],1)],1)}),[],!1,null,null,null);"function"==typeof x&&x(O),O.options.__hasBlocks={script:!0,template:!0};t.default=O.exports},hqJQ:function(e,t){e.exports=tui.require("tui/components/icons/DateFrequencyRepeating")},hyIR:function(e,t,i){},"i/kK":function(e,t){e.exports=tui.require("tui/components/form/FormRow")},i5xl:function(e,t,i){},iAar:function(e,t,i){},iFIC:function(e,t){e.exports=tui.require("tui/components/form/Repeater")},iLf5:function(e,t,i){},icJw:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/Schedule")},io3G:function(e,t){e.exports=tui.require("mod_perform/components/report/element_response/ExportConfirmModal")},iycM:function(e,t){e.exports=tui.require("tui/components/form/InputSet")},"j//g":function(e,t,i){"use strict";i.r(t);var n=i("f8+O"),a={components:{NoResponseSubmitted:i.n(n).a},props:{responseLines:{type:Array,required:!0}}},s=i("KHd+"),r=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-participantFormResponseDisplay"},[e.responseLines.length>0?e._l(e.responseLines,(function(t,n){return i("div",{key:n},[e._v("\n      "+e._s(t)+"\n    ")])})):i("NoResponseSubmitted")],2)}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};t.default=r.exports},"j/oy":function(e,t,i){"use strict";i.r(t);var n={props:{type:Object}},a=(i("YlPD"),i("KHd+")),s=Object(a.a)(n,(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"tui-performElementParticipantResponse"},[this._t("content")],2)}),[],!1,null,null,null);s.options.__hasBlocks={script:!0,template:!0};t.default=s.exports},j7Iq:function(e,t,i){"use strict";i.r(t);var n=i("j/oy"),a=i("s0yi"),s=i.n(a),r=i("lLj0"),o=i.n(r),l=i("WBvU"),d={components:{ElementParticipantResponse:n.default,FormRow:l.FormRow,ParticipantUserHeader:s.a,WarningIcon:o.a},props:{viewOnly:Boolean,sectionElement:{type:Object,required:!0},anonymousResponses:{type:Boolean,required:!0}},computed:{responderGroups(){return this.sectionElement.other_responder_groups.map(e=>{const t=e.responses.map(e=>Object.assign({},e,{response_data:JSON.parse(e.response_data)}));return Object.assign({},e,{responses:t})})},anonymousGroupLabel(){return this.viewOnly?this.$str("responses","mod_perform"):this.$str("response_other","mod_perform")}},methods:{hasResponses:e=>e.length>0}},c=(i("cK46"),i("KHd+")),u=function(e){e.options.__langStrings={mod_perform:["responses","response_other","user_activities_other_response_response","user_activities_other_response_no_participants_identified"]}},m=Object(c.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-otherParticipantResponses"},[e.anonymousResponses?e._l(e.responderGroups,(function(t,n){return i("FormRow",{key:n,attrs:{label:e.anonymousGroupLabel}},[i("div",{staticClass:"tui-otherParticipantResponses__anonymousResponse"},e._l(t.responses,(function(t,n){return i("div",{key:n,staticClass:"tui-otherParticipantResponses__anonymousResponse-participant"},[i("ElementParticipantResponse",{scopedSlots:e._u([{key:"content",fn:function(){return[i(e.sectionElement.responseDisplayComponent,{tag:"component",attrs:{element:e.sectionElement.element,data:t.response_data,"response-lines":t.response_data_formatted_lines}})]},proxy:!0}],null,!0)})],1)})),0)])})):e._l(e.responderGroups,(function(t,n){return i("FormRow",{key:n,attrs:{label:e.$str("user_activities_other_response_response","mod_perform",{relationship:t.relationship_name})}},[e.hasResponses(t.responses)?i("div",{staticClass:"tui-otherParticipantResponses__response"},e._l(t.responses,(function(t,n){return i("div",{key:n,staticClass:"tui-otherParticipantResponses__response-participant"},[i("ParticipantUserHeader",{attrs:{"user-name":t.participant_instance.participant.fullname,"profile-picture":t.participant_instance.participant.profileimageurlsmall,size:"xxsmall"}}),e._v(" "),i("ElementParticipantResponse",{scopedSlots:e._u([{key:"content",fn:function(){return[i(e.sectionElement.responseDisplayComponent,{tag:"component",attrs:{element:e.sectionElement.element,data:t.response_data,"response-lines":t.response_data_formatted_lines}})]},proxy:!0}],null,!0)})],1)})),0):i("div",{staticClass:"tui-otherParticipantResponses__noParticipant"},[e._v("\n        "+e._s(e.$str("user_activities_other_response_no_participants_identified","mod_perform"))+"\n      ")])])}))],2)}),[],!1,null,null,null);"function"==typeof u&&u(m),m.options.__hasBlocks={script:!0,template:!0};t.default=m.exports},jJ8l:function(e,t){e.exports=tui.require("tui/components/card/Card")},jcvR:function(e,t,i){"use strict";i.r(t);var n={props:{isRequired:Boolean}},a=(i("Uo+B"),i("KHd+")),s=function(e){e.options.__langStrings={core:["required"],mod_perform:["section_element_response_optional"]}},r=Object(a.a)(n,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("span",{staticClass:"tui-performRequiredOptionalIndicator"},[e.isRequired?i("span",{staticClass:"tui-performRequiredOptionalIndicator--required",attrs:{title:e.$str("required","core")}},[i("span",{attrs:{"aria-hidden":"true"}},[e._v("*")]),e._v(" "),i("span",{staticClass:"sr-only"},[e._v(e._s(e.$str("required","core")))])]):e._e(),e._v(" "),e.isRequired?e._e():i("span",{staticClass:"tui-performRequiredOptionalIndicator--optional"},[e._v("\n    ("+e._s(e.$str("section_element_response_optional","mod_perform"))+")\n  ")])])}),[],!1,null,null,null);"function"==typeof s&&s(r),r.options.__hasBlocks={script:!0,template:!0};t.default=r.exports},ji1A:function(e,t,i){"use strict";var n=i("tBqJ");i.n(n).a},jxQq:function(e,t,i){"use strict";i.r(t),i.d(t,"RELATIONSHIP_SUBJECT",(function(){return n})),i.d(t,"RELATIONSHIP_PERFORM_EXTERNAL",(function(){return a})),i.d(t,"ACTIVITY_NAME_MAX_LENGTH",(function(){return s})),i.d(t,"ACTIVITY_STATUS_ACTIVE",(function(){return r})),i.d(t,"ACTIVITY_STATUS_DRAFT",(function(){return o})),i.d(t,"INSTANCE_AVAILABILITY_STATUS_OPEN",(function(){return l})),i.d(t,"INSTANCE_AVAILABILITY_STATUS_CLOSED",(function(){return d})),i.d(t,"RELATIVE_DATE_DIRECTION_AFTER",(function(){return c})),i.d(t,"RELATIVE_DATE_DIRECTION_BEFORE",(function(){return u})),i.d(t,"RELATIVE_DATE_UNIT_DAY",(function(){return m})),i.d(t,"RELATIVE_DATE_UNIT_WEEK",(function(){return _})),i.d(t,"SCHEDULE_REPEATING_TYPE_AFTER_CREATION",(function(){return p})),i.d(t,"SCHEDULE_REPEATING_TYPE_AFTER_CREATION_WHEN_COMPLETE",(function(){return v})),i.d(t,"SCHEDULE_REPEATING_TYPE_AFTER_COMPLETION",(function(){return f})),i.d(t,"SUBJECT_INSTANCE_GENERATION_ONE_PER_SUBJECT",(function(){return g})),i.d(t,"SUBJECT_INSTANCE_GENERATION_ONE_PER_JOB",(function(){return k})),i.d(t,"DATE_RESOLVER_EMPTY_BASE",(function(){return h})),i.d(t,"DATE_RESOLVER_USER_BASED",(function(){return y})),i.d(t,"DATE_RESOLVER_JOB_BASED",(function(){return S})),i.d(t,"VISIBILITY_CONDITION_NONE",(function(){return b})),i.d(t,"VISIBILITY_CONDITION_VIEWER_RESPONSE_CLOSED",(function(){return N})),i.d(t,"VISIBILITY_CONDITION_ALL_PARTICIPANT_CLOSED",(function(){return F})),i.d(t,"PROGRESS_NOT_APPLICABLE",(function(){return A})),i.d(t,"DEFAULT_ITEMS_PER_PAGE",(function(){return C}));const n="subject",a="perform_external",s=1024,r="ACTIVE",o="DRAFT",l="OPEN",d="CLOSED",c="AFTER",u="BEFORE",m="DAY",_="WEEK",p="AFTER_CREATION",v="AFTER_CREATION_WHEN_COMPLETE",f="AFTER_COMPLETION",g="ONE_PER_SUBJECT",k="ONE_PER_JOB",h="EMPTY_BASE",y="USER_BASED",S="JOB_BASED",b=0,N=1,F=2,A="PROGRESS_NOT_APPLICABLE",C=20},jzcV:function(e,t,i){"use strict";i.r(t);var n=i("D3AF"),a=i.n(n),s=i("vF5l"),r=i.n(s),o=i("5h9J"),l=i.n(o),d=i("KGot"),c=i.n(d),u=i("C+/B"),m=i.n(u),_=i("vH83"),p=i.n(_),v=i("gLvT"),f=i.n(v),g=i("KGcv"),k=i.n(g),h=i("5qAA"),y=i.n(h),S=i("Oi9v"),b=i.n(S),N=i("UzeO"),F=i.n(N),A=i("yikf"),C=i.n(A),E=i("icJw"),I=i.n(E),T=i("KxNG"),x={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_default_track_settings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_integer"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_default_track"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_assign_positions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_assign_organisations"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_instance_generation"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_is_open"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_is_fixed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"schedule_fixed_from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_fixed_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_from"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"direction"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_to"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"direction"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_dynamic_source"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"option_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_available"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_setting_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_base"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"schedule_use_anniversary"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_is_fixed"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"due_date_fixed"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"due_date_offset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"repeating_is_enabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_offset"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"unit"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"repeating_is_limited"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"repeating_limit"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_instance_generation"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assignments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"size"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"mod_perform_available_dynamic_date_sources"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"resolver_class_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"option_key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_available"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_setting_component"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"custom_data"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"resolver_base"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"mod_perform_default_fixed_date_setting"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"iso"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"timezone"},arguments:[],directives:[]}]}}]}}]},O={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_add_track_assignments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assignments"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_track_assignments_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_add_track_assignments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"assignments"},value:{kind:"Variable",name:{kind:"Name",value:"assignments"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_assign_organisations"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_assign_positions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assignments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"size"},arguments:[],directives:[]}]}}]}}]}}]}}]},w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_remove_track_assignments"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"assignments"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_track_assignments_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_remove_track_assignments"},arguments:[{kind:"Argument",name:{kind:"Name",value:"assignments"},value:{kind:"Variable",name:{kind:"Name",value:"assignments"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_assign_organisations"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_assign_positions"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"assignments"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"group"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type_label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"size"},arguments:[],directives:[]}]}}]}}]}}]}}]},$={components:{AudienceAdder:a.a,Button:r.a,ButtonIcon:l.a,Cell:c.a,ConfirmationModal:m.a,DeleteIcon:p.a,Dropdown:f.a,DropdownItem:k.a,HeaderCell:y.a,Table:C.a,Schedule:I.a,OrganisationAdder:b.a,PositionAdder:F.a},props:{activityId:{type:Number,required:!0},activityState:{type:String,required:!0},activityContextId:Number,activityHasUnsavedChanges:Boolean},data(){return{track:null,dynamicDateSources:[],defaultFixedDateSetting:null,trackSettings:null,assignments:[],noAssignments:[{group:{name:this.$str("user_group_assignment_no_users","mod_perform")}}],audienceAddedIds:[],orgAddedIds:[],posAddedIds:[],isAudienceAdderOpen:!1,isOrgAdderOpen:!1,isPosAdderOpen:!1,confirmationModalOpen:!1,assignmentToRemove:null,adminEnum:1,cohortEnum:1,orgEnum:2,posEnum:3}},computed:{dropdownPosition:()=>screen.width>600?"bottom-right":"bottom-left",isActive(){return this.activityState==T.ACTIVITY_STATUS_ACTIVE}},watch:{track(){this.track&&(this.assignments=this.track.assignments,this.audienceAddedIds=this.assignments.filter(e=>e.group.type===this.cohortEnum).map(e=>e.group.id),this.orgAddedIds=this.assignments.filter(e=>e.group.type===this.orgEnum).map(e=>e.group.id),this.posAddedIds=this.assignments.filter(e=>e.group.type===this.posEnum).map(e=>e.group.id)),this.assignments},trackSettings(e){this.track=e.track,this.defaultFixedDateSetting=e.defaultFixedDateSetting,this.track.schedule_dynamic_source&&!1===this.track.schedule_dynamic_source.is_available?this.dynamicDateSources=this.addedDeletedDateSourceToList(e.dynamicDateSources):this.dynamicDateSources=e.dynamicDateSources}},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},beforeDestroy(){window.removeEventListener("beforeunload",this.unloadHandler)},methods:{openAdder(){this.isAudienceAdderOpen=!0},closeAdder(){this.isAudienceAdderOpen=!1},openOrgAdder(){this.isOrgAdderOpen=!0},closeOrgAdder(){this.isOrgAdderOpen=!1},openPosAdder(){this.isPosAdderOpen=!0},closePosAdder(){this.isPosAdderOpen=!1},updateSelectionFromAdder(e,t,i){const n=e.data.filter(e=>-1==t.indexOf(e.id)).map(e=>({id:e.id,type:i})),a={track_id:this.track.id,type:this.adminEnum,groups:n};this.updateAssignmentsInRepository(O,"mod_perform_add_track_assignments",a),this.$_postProcess(i,e)},$_postProcess(e,t){e===this.cohortEnum&&(this.audienceAddedIds=t.ids,this.isAudienceAdderOpen=!1),e===this.orgEnum&&(this.orgAddedIds=t.ids,this.isOrgAdderOpen=!1),e===this.posEnum&&(this.posAddedIds=t.ids,this.isPosAdderOpen=!1)},removeAssignment(){if(!this.assignmentToRemove)return;const e={track_id:this.track.id,type:this.assignmentToRemove.assignmentType,groups:[{id:this.assignmentToRemove.groupId,type:this.assignmentToRemove.groupType}]};this.updateAssignmentsInRepository(w,"mod_perform_remove_track_assignments",e)},addedDeletedDateSourceToList(e){const t=this.$str("deleted_dynamic_source_label","mod_perform",this.track.schedule_dynamic_source.display_name),i=[Object.assign({},this.track.schedule_dynamic_source,{display_name:t})];return i.push.apply(i,e),i},async updateAssignmentsInRepository(e,t,i){const n={assignments:i};try{const{data:i}=await this.$apollo.mutate({mutation:e,variables:n,refetchAll:!1}),a=i[t];this.hideRemoveConfirmationModal(),a?(this.track=a,this.$emit("mutation-success")):this.$emit("mutation-error")}catch(e){console.log("update track assignments error",e),this.$emit("mutation-error")}},showRemoveConfirmationModal(e,t,i){this.assignmentToRemove={assignmentType:e,groupId:t,groupType:i},this.confirmationModalOpen=!0},hideRemoveConfirmationModal(){this.assignmentToRemove=null,this.confirmationModalOpen=!1},hasUnsavedChanges(e){this.$emit("unsaved-changes",e)},unloadHandler(e){if(!this.activityHasUnsavedChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t}},apollo:{trackSettings:{query:x,fetchPolicy:"network-only",variables(){return{activity_id:this.activityId}},update:e=>({track:e.mod_perform_default_track,dynamicDateSources:e.mod_perform_available_dynamic_date_sources,defaultFixedDateSetting:e.mod_perform_default_fixed_date_setting})}}},D=(i("vlZ8"),i("KHd+")),R=function(e){e.options.__langStrings={core:["delete"],mod_perform:["deleted_dynamic_source_label","unsaved_changes_warning","user_group_assignment_add_group","user_group_assignment_confirm_modal_remove","user_group_assignment_confirm_remove_active","user_group_assignment_confirm_remove_draft","user_group_assignment_confirm_remove_title","user_group_assignment_group_cohort","user_group_assignment_group_organisation","user_group_assignment_group_position","user_group_assignment_name","user_group_assignment_no_users","user_group_assignment_title","user_group_assignment_type","user_group_assignment_usercount","view_actions"]}},j=Object(D.a)($,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManageActivityAssignmentsForm"},[i("h3",{staticClass:"tui-performManageActivityAssignmentsForm__heading"},[e._v("\n    "+e._s(e.$str("user_group_assignment_title","mod_perform"))+"\n  ")]),e._v(" "),i("div",{staticClass:"tui-performManageActivityAssignmentsForm__add"},[i("Dropdown",{staticClass:"tui-performManageActivityAssignmentsForm__add-dropdown",attrs:{separator:!0,position:e.dropdownPosition},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle,a=t.isOpen;return[i("Button",{attrs:{"aria-expanded":a?"true":"false",text:e.$str("user_group_assignment_add_group","mod_perform"),caret:!0,styleclass:{primary:!0}},on:{click:n}})]}}])},[e._v(" "),i("DropdownItem",{on:{click:e.openAdder}},[e._v("\n        "+e._s(e.$str("user_group_assignment_group_cohort","mod_perform"))+"\n      ")]),e._v(" "),e.track&&e.track.can_assign_organisations?i("DropdownItem",{on:{click:e.openOrgAdder}},[e._v("\n        "+e._s(e.$str("user_group_assignment_group_organisation","mod_perform"))+"\n      ")]):e._e(),e._v(" "),e.track&&e.track.can_assign_positions?i("DropdownItem",{on:{click:e.openPosAdder}},[e._v("\n        "+e._s(e.$str("user_group_assignment_group_position","mod_perform"))+"\n      ")]):e._e()],1)],1),e._v(" "),i("AudienceAdder",{attrs:{open:e.isAudienceAdderOpen,"existing-items":e.audienceAddedIds,"context-id":e.activityContextId},on:{added:function(t){return e.updateSelectionFromAdder(t,e.audienceAddedIds,e.cohortEnum)},cancel:e.closeAdder}}),e._v(" "),i("OrganisationAdder",{attrs:{open:e.isOrgAdderOpen,"existing-items":e.orgAddedIds},on:{added:function(t){return e.updateSelectionFromAdder(t,e.orgAddedIds,e.orgEnum)},cancel:e.closeOrgAdder}}),e._v(" "),i("PositionAdder",{attrs:{open:e.isPosAdderOpen,"existing-items":e.posAddedIds},on:{added:function(t){return e.updateSelectionFromAdder(t,e.posAddedIds,e.posEnum)},cancel:e.closePosAdder}}),e._v(" "),i("Table",{staticClass:"tui-performManageActivityAssignmentsForm__table",attrs:{data:e.assignments.length>0?e.assignments:e.noAssignments},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",{attrs:{size:"11",valign:"center"}},[e._v("\n        "+e._s(e.$str("user_group_assignment_name","mod_perform"))+"\n      ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2",valign:"center"}},[e._v("\n        "+e._s(e.$str("user_group_assignment_type","mod_perform"))+"\n      ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2",valign:"center"}},[e._v("\n        "+e._s(e.$str("user_group_assignment_usercount","mod_perform"))+"\n      ")]),e._v(" "),i("HeaderCell",{attrs:{size:"1",valign:"center"}})]},proxy:!0},{key:"row",fn:function(t){var n=t.row;return[[i("Cell",{attrs:{size:"11",valign:"center","column-header":e.$str("user_group_assignment_name","mod_perform")}},[e._v("\n          "+e._s(n.group.name)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"2",valign:"center","column-header":e.$str("user_group_assignment_type","mod_perform")}},[e._v("\n          "+e._s(n.group.type_label)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"2",valign:"center","column-header":e.$str("user_group_assignment_usercount","mod_perform")}},[e._v("\n          "+e._s(n.group.size)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"1",valign:"center",align:"end","column-header":e.$str("view_actions","mod_perform")}},[n.group.id?i("ButtonIcon",{attrs:{"aria-label":e.$str("delete","core"),styleclass:{small:!0,transparent:!0}},on:{click:function(t){return e.showRemoveConfirmationModal(n.type,n.group.id,n.group.type)}}},[i("DeleteIcon")],1):e._e()],1)]]}}])}),e._v(" "),e.track?i("Schedule",{attrs:{track:e.track,"dynamic-date-sources":e.dynamicDateSources,"default-fixed-date":e.defaultFixedDateSetting,"activity-id":e.activityId,"activity-state":e.activityState},on:{"unsaved-changes":e.hasUnsavedChanges}}):e._e(),e._v(" "),i("ConfirmationModal",{attrs:{title:e.$str("user_group_assignment_confirm_remove_title","mod_perform"),"confirm-button-text":e.$str("user_group_assignment_confirm_modal_remove","mod_perform"),open:e.confirmationModalOpen},on:{confirm:e.removeAssignment,cancel:e.hideRemoveConfirmationModal}},[e.isActive?i("p",[e._v("\n      "+e._s(e.$str("user_group_assignment_confirm_remove_active","mod_perform"))+"\n    ")]):i("p",[e._v("\n      "+e._s(e.$str("user_group_assignment_confirm_remove_draft","mod_perform"))+"\n    ")])])],1)}),[],!1,null,null,null);"function"==typeof R&&R(j),j.options.__hasBlocks={script:!0,template:!0};t.default=j.exports},k1c4:function(e,t,i){},k9Iw:function(e,t,i){"use strict";i.r(t);var n=i("NAOU"),a=i.n(n),s=i("D9If"),r={components:{GridItem:i.n(s).a,Grid:a.a},props:{elementsSummary:{type:Object,required:!0}}},o=(i("6aIU"),i("KHd+")),l=function(e){e.options.__langStrings={mod_perform:["section_element_summary_required_questions","section_element_summary_optional_questions","section_element_summary_other_content_elements"]}},d=Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Grid",{attrs:{"stack-at":764}},[i("GridItem",{attrs:{units:4}},[i("div",[e._v("\n      "+e._s(e.$str("section_element_summary_required_questions","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performActivitySectionElementSummary__count"},[e._v("\n      "+e._s(e.elementsSummary.required_question_count)+"\n    ")])]),e._v(" "),i("GridItem",{attrs:{units:4}},[i("div",[e._v("\n      "+e._s(e.$str("section_element_summary_optional_questions","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performActivitySectionElementSummary__count"},[e._v("\n      "+e._s(e.elementsSummary.optional_question_count)+"\n    ")])]),e._v(" "),i("GridItem",{attrs:{units:4}},[i("div",[e._v("\n      "+e._s(e.$str("section_element_summary_other_content_elements","mod_perform"))+"\n    ")]),e._v(" "),i("div",{staticClass:"tui-performActivitySectionElementSummary__count"},[e._v("\n      "+e._s(e.elementsSummary.other_element_count)+"\n    ")])])],1)}),[],!1,null,null,null);"function"==typeof l&&l(d),d.options.__hasBlocks={script:!0,template:!0};t.default=d.exports},"kKx+":function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ContentAddElementButton")},"kUb+":function(e,t){e.exports=tui.require("tui/components/card/ActionCard")},"kV+/":function(e,t){e.exports=tui.require("tui/components/toggle/ToggleButton")},l2F4:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("BN8m"),r=i.n(s),o=i("tkAW"),l=i.n(o),d=i("u5iS"),c=i.n(d),u=i("Mnur"),m=i.n(u),_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_manually_change_participant_instance"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_manually_change_participant_instance_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manually_change_participant_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]},p=i("vyVp"),v=i("E7bt"),f=i("KxNG"),g={components:{Button:a.a,ButtonGroup:r.a,Modal:l.a,ModalContent:c.a,ModalPresenter:m.a},props:{modalOpen:{type:Boolean},participantInstanceId:{type:String},isOpen:{type:Boolean},reportType:{type:String}},methods:{modalClose(){this.$emit("modal-close")},showErrorNotification(){Object(p.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},async changeAvailability(){try{let e=this.isOpen?f.INSTANCE_AVAILABILITY_STATUS_CLOSED:f.INSTANCE_AVAILABILITY_STATUS_OPEN;await this.$apollo.mutate({mutation:_,variables:{input:{participant_instance_id:this.participantInstanceId,availability:e}}}),this.$emit("modal-close"),Object(v.redirectWithPost)(window.location,{is_open:!this.isOpen,report_type:this.reportType})}catch(e){this.showErrorNotification()}}}},k=i("KHd+"),h=function(e){e.options.__langStrings={mod_perform:["button_cancel","button_close","button_reopen","participant_instances_close_message_line1","participant_instances_close_message_line2","participant_instances_close_title","participant_instances_reopen_title","participant_instances_reopen_message_line1","participant_instances_reopen_message_line2"]}},y=Object(k.a)(g,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ModalPresenter",{attrs:{open:e.modalOpen},on:{"request-close":e.modalClose}},[i("Modal",{attrs:{size:"normal","aria-labelledby":e.$id("report_open_close")}},[i("ModalContent",{attrs:{title:e.$str(e.isOpen?"participant_instances_close_title":"participant_instances_reopen_title","mod_perform"),"title-id":e.$id("report_open_close")},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str(e.isOpen?"button_close":"button_reopen","mod_perform")},on:{click:function(t){return e.changeAvailability()}}}),e._v(" "),i("Button",{attrs:{text:e.$str("button_cancel","mod_perform")},on:{click:function(t){return e.modalClose()}}})],1)]},proxy:!0}])},[e.isOpen?[i("p",[e._v("\n          "+e._s(e.$str("participant_instances_close_message_line1","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("participant_instances_close_message_line2","mod_perform"))+"\n        ")])]:[i("p",[e._v("\n          "+e._s(e.$str("participant_instances_reopen_message_line1","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("participant_instances_reopen_message_line2","mod_perform"))+"\n        ")])]],2)],1)],1)}),[],!1,null,null,null);"function"==typeof h&&h(y),y.options.__hasBlocks={script:!0,template:!0};t.default=y.exports},lKYa:function(e,t,i){},lLj0:function(e,t){e.exports=tui.require("tui/components/icons/Warning")},lOlL:function(e,t){e.exports=tui.require("tui/components/toggle/ToggleSwitch")},lWyS:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ActivityMultipleSectionToggle")},lgOp:function(e,t,i){"use strict";i.r(t);var n=i("5h9J"),a=i.n(n),s=i("tqxB"),r=i.n(s),o=i("Mnur"),l=i.n(o),d=i("37B8"),c=i.n(d),u=i("6K0l"),m=i.n(u),_={components:{ButtonIcon:a.a,ExportRowAction:r.a,ModalPresenter:l.a,PreviewIcon:c.a,QuestionElementPreviewModal:m.a},props:{elementId:{required:!0,type:Number}},data:()=>({openPreviewModal:!1}),computed:{exportHrefParams(){return{element_id:this.elementId}}},methods:{closePreviewModal(){this.openPreviewModal=!1},showPreviewModal(){this.openPreviewModal=!0}}},p=i("KHd+"),v=function(e){e.options.__langStrings={mod_perform:["preview"]}},f=Object(p.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("ButtonIcon",{attrs:{"aria-label":e.$str("preview","mod_perform"),styleclass:{transparentNoPadding:!0}},on:{click:e.showPreviewModal}},[i("PreviewIcon")],1),e._v(" "),i("ExportRowAction",{attrs:{"additional-export-href-params":e.exportHrefParams}}),e._v(" "),i("ModalPresenter",{attrs:{open:e.openPreviewModal},on:{"request-close":e.closePreviewModal}},[i("QuestionElementPreviewModal",{attrs:{"element-id":e.elementId},on:{"modal-close":e.closePreviewModal}})],1)],1)}),[],!1,null,null,null);"function"==typeof v&&v(f),f.options.__hasBlocks={script:!0,template:!0};t.default=f.exports},mTJD:function(e,t,i){},mawr:function(e,t){e.exports=tui.require("mod_perform/components/report/manage_participation/SectionOpenCloseActionModal")},"mhw/":function(e,t,i){},"mn/Y":function(e,t,i){"use strict";var n=i("1fSv");i.n(n).a},mrdf:function(e,t,i){"use strict";var n=i("i5xl");i.n(n).a},msfZ:function(e,t,i){var n={"./activities_list/ActivityActions":"fooM","./activities_list/ActivityActions.vue":"fooM","./activities_list/AdminActivityFilters":"bPHd","./activities_list/AdminActivityFilters.vue":"bPHd","./element/ElementParticipantForm":"xP5P","./element/ElementParticipantForm.vue":"xP5P","./element/ElementParticipantResponse":"j/oy","./element/ElementParticipantResponse.vue":"j/oy","./element/PerformAdminCustomElement":"adT2","./element/PerformAdminCustomElement.vue":"adT2","./element/PerformAdminCustomElementEdit":"2QG0","./element/PerformAdminCustomElementEdit.vue":"2QG0","./element/PerformAdminCustomElementSummary":"81hr","./element/PerformAdminCustomElementSummary.vue":"81hr","./element/participant_form/HtmlResponseDisplay":"v6iO","./element/participant_form/HtmlResponseDisplay.vue":"v6iO","./element/participant_form/NoResponseSubmitted":"J0b9","./element/participant_form/NoResponseSubmitted.vue":"J0b9","./element/participant_form/ResponseDisplay":"j//g","./element/participant_form/ResponseDisplay.vue":"j//g","./manage_activity/ActivateActivityModal":"gZ/S","./manage_activity/ActivateActivityModal.vue":"gZ/S","./manage_activity/ActivityStatusBanner":"HQOn","./manage_activity/ActivityStatusBanner.vue":"HQOn","./manage_activity/CreateActivityForm":"ruQM","./manage_activity/CreateActivityForm.vue":"ruQM","./manage_activity/GeneralInfoTab":"UYTS","./manage_activity/GeneralInfoTab.vue":"UYTS","./manage_activity/assignment/AssignmentsTab":"jzcV","./manage_activity/assignment/AssignmentsTab.vue":"jzcV","./manage_activity/assignment/Schedule":"e7Z5","./manage_activity/assignment/Schedule.vue":"e7Z5","./manage_activity/assignment/schedule/AssignmentScheduleAdditionalSettings":"WtS6","./manage_activity/assignment/schedule/AssignmentScheduleAdditionalSettings.vue":"WtS6","./manage_activity/assignment/schedule/AssignmentScheduleCreationRange":"e5h7","./manage_activity/assignment/schedule/AssignmentScheduleCreationRange.vue":"e5h7","./manage_activity/assignment/schedule/AssignmentScheduleDueDate":"+Hk5","./manage_activity/assignment/schedule/AssignmentScheduleDueDate.vue":"+Hk5","./manage_activity/assignment/schedule/AssignmentScheduleFrequencySettings":"Gyls","./manage_activity/assignment/schedule/AssignmentScheduleFrequencySettings.vue":"Gyls","./manage_activity/assignment/schedule/AssignmentScheduleToggles":"ONfz","./manage_activity/assignment/schedule/AssignmentScheduleToggles.vue":"ONfz","./manage_activity/assignment/schedule/custom_settings/ActivitySelector":"zclK","./manage_activity/assignment/schedule/custom_settings/ActivitySelector.vue":"zclK","./manage_activity/content/ActivityContentTab":"vp1m","./manage_activity/content/ActivityContentTab.vue":"vp1m","./manage_activity/content/ActivityMultipleSectionToggle":"eR12","./manage_activity/content/ActivityMultipleSectionToggle.vue":"eR12","./manage_activity/content/ActivitySection":"oOnd","./manage_activity/content/ActivitySection.vue":"oOnd","./manage_activity/content/ActivitySectionElementSummary":"k9Iw","./manage_activity/content/ActivitySectionElementSummary.vue":"k9Iw","./manage_activity/content/ActivitySectionRelationship":"4HqM","./manage_activity/content/ActivitySectionRelationship.vue":"4HqM","./manage_activity/content/ContentAddElementButton":"XDmp","./manage_activity/content/ContentAddElementButton.vue":"XDmp","./manage_activity/content/ParticipantsPopover":"a1wA","./manage_activity/content/ParticipantsPopover.vue":"a1wA","./manage_activity/content/WorkflowSettings":"1NcW","./manage_activity/content/WorkflowSettings.vue":"1NcW","./manage_activity/notification/NotificationSection":"FONq","./manage_activity/notification/NotificationSection.vue":"FONq","./manage_activity/notification/NotificationsTab":"EliJ","./manage_activity/notification/NotificationsTab.vue":"EliJ","./manage_activity/notification/RecipientsTable":"QPJV","./manage_activity/notification/RecipientsTable.vue":"QPJV","./manage_activity/notification/TriggersTable":"OiWw","./manage_activity/notification/TriggersTable.vue":"OiWw","./manage_activity/participation/InstanceInfoCard":"pVBh","./manage_activity/participation/InstanceInfoCard.vue":"pVBh","./manage_activity/participation/ParticipantInstanceInfoCard":"C2Qw","./manage_activity/participation/ParticipantInstanceInfoCard.vue":"C2Qw","./manage_activity/participation/SelectActivityModal":"pYwm","./manage_activity/participation/SelectActivityModal.vue":"pYwm","./manage_activity/participation/SubjectInstanceInfoCard":"nydd","./manage_activity/participation/SubjectInstanceInfoCard.vue":"nydd","./manage_activity/participation/Toasts":"+FpX","./manage_activity/participation/Toasts.vue":"+FpX","./report/element_response/ElementActions":"lgOp","./report/element_response/ElementActions.vue":"lgOp","./report/element_response/ExportActionCard":"hjVT","./report/element_response/ExportActionCard.vue":"hjVT","./report/element_response/ExportConfirmModal":"rgbN","./report/element_response/ExportConfirmModal.vue":"rgbN","./report/element_response/ExportRowAction":"uDke","./report/element_response/ExportRowAction.vue":"uDke","./report/element_response/QuestionElementPreviewModal":"AhV7","./report/element_response/QuestionElementPreviewModal.vue":"AhV7","./report/element_response/SubjectInstanceActions":"qa8l","./report/element_response/SubjectInstanceActions.vue":"qa8l","./report/element_response/SubjectUserActions":"sL7E","./report/element_response/SubjectUserActions.vue":"sL7E","./report/manage_participation/Actions":"0ngu","./report/manage_participation/Actions.vue":"0ngu","./report/manage_participation/ParticipantOpenCloseActionModal":"l2F4","./report/manage_participation/ParticipantOpenCloseActionModal.vue":"l2F4","./report/manage_participation/SectionOpenCloseActionModal":"PT33","./report/manage_participation/SectionOpenCloseActionModal.vue":"PT33","./report/manage_participation/SubjectInstanceOpenCloseActionModal":"qS45","./report/manage_participation/SubjectInstanceOpenCloseActionModal.vue":"qS45","./report/performance/ReportingIdFilterBanner":"TqL4","./report/performance/ReportingIdFilterBanner.vue":"TqL4","./report/performance/ResponseByContent":"UB0E","./report/performance/ResponseByContent.vue":"UB0E","./user_activities/ActivityContent":"R0bL","./user_activities/ActivityContent.vue":"R0bL","./user_activities/ActivityContentPrint":"03eI","./user_activities/ActivityContentPrint.vue":"03eI","./user_activities/ManualParticipantsSelectionBanner":"byy7","./user_activities/ManualParticipantsSelectionBanner.vue":"byy7","./user_activities/RequiredOptionalIndicator":"jcvR","./user_activities/RequiredOptionalIndicator.vue":"jcvR","./user_activities/ResponseRelationshipSelector":"oqEP","./user_activities/ResponseRelationshipSelector.vue":"oqEP","./user_activities/layout/LayoutOneColumnSidePanelActivities":"Fbz3","./user_activities/layout/LayoutOneColumnSidePanelActivities.vue":"Fbz3","./user_activities/list/Activities":"hp/q","./user_activities/list/Activities.vue":"hp/q","./user_activities/list/ActivitiesFilter":"yQFu","./user_activities/list/ActivitiesFilter.vue":"yQFu","./user_activities/list/HistoricActivities":"tDCQ","./user_activities/list/HistoricActivities.vue":"tDCQ","./user_activities/list/MyHistoricActivities":"sINS","./user_activities/list/MyHistoricActivities.vue":"sINS","./user_activities/list/OtherHistoricActivities":"133O","./user_activities/list/OtherHistoricActivities.vue":"133O","./user_activities/list/RelationshipSelector":"05h+","./user_activities/list/RelationshipSelector.vue":"05h+","./user_activities/list/Sections":"q81d","./user_activities/list/Sections.vue":"q81d","./user_activities/participant/JobAssignmentInformation":"UF8y","./user_activities/participant/JobAssignmentInformation.vue":"UF8y","./user_activities/participant/OtherParticipantResponses":"j7Iq","./user_activities/participant/OtherParticipantResponses.vue":"j7Iq","./user_activities/participant/ParticipantGeneralInformation":"O4KQ","./user_activities/participant/ParticipantGeneralInformation.vue":"O4KQ","./user_activities/participant/ParticipantUserHeader":"QhoR","./user_activities/participant/ParticipantUserHeader.vue":"QhoR","./user_activities/participant/ResponsesAreVisibleToDescription":"78jW","./user_activities/participant/ResponsesAreVisibleToDescription.vue":"78jW","./user_activities/participant_selector/ActivityParticipants":"WOU5","./user_activities/participant_selector/ActivityParticipants.vue":"WOU5","./user_activities/participant_selector/ExternalUserSelector":"8FGy","./user_activities/participant_selector/ExternalUserSelector.vue":"8FGy","./user_activities/participant_selector/UserSelector":"tRCs","./user_activities/participant_selector/UserSelector.vue":"tRCs"};function a(e){var t=s(e);return i(t)}function s(e){if(!i.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=s,e.exports=a,a.id="msfZ"},"n/29":function(e,t,i){"use strict";var n=i("lKYa");i.n(n).a},nBTD:function(e,t){e.exports=tui.require("tui/components/form/FieldError")},nEm4:function(e,t){e.exports=tui.require("tui/components/form/Form")},nXMa:function(e,t){e.exports=tui.require("tui/components/buttons/Cancel")},ncps:function(e,t,i){"use strict";var n=i("rGKm");i.n(n).a},nlOa:function(e,t,i){"use strict";i.r(t);var n=i("g8/U"),a={components:{PageHeading:i.n(n).a}},s=(i("wNUA"),i("KHd+")),r=function(e){e.options.__langStrings={mod_perform:["external_participation_invalid_heading","external_participation_invalid_message"]}},o=Object(s.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tui-performUserActivityInvalid"},[t("PageHeading",{attrs:{title:this.$str("external_participation_invalid_heading","mod_perform")}}),this._v(" "),t("div",[this._v("\n    "+this._s(this.$str("external_participation_invalid_message","mod_perform"))+"\n  ")])],1)}),[],!1,null,null,null);"function"==typeof r&&r(o),o.options.__hasBlocks={script:!0,template:!0};t.default=o.exports},nnnb:function(e,t){e.exports=tui.require("tui/components/icons/DragHandle")},"nu/z":function(e,t){e.exports=tui.require("mod_perform/components/user_activities/ActivityContent")},nydd:function(e,t,i){"use strict";i.r(t);var n=i("Lrk7"),a=i("/Ngp"),s=i.n(a),r=i("JXQf"),o=i.n(r),l={components:{InstanceInfoCard:s.a,Loader:o.a},props:{subjectInstanceId:{type:Number,required:!0},showAllLink:{type:String,required:!0}},data:()=>({subjectInstance:null}),computed:{infoLines(){if(null===this.subjectInstance)return[];let e="";return this.subjectInstance.job_assignment&&(e=this.subjectInstance.job_assignment.fullname),[{label:this.$str("instance_info_card_subject_full_name","mod_perform"),text:this.subjectInstance.subject_user.fullname},{label:this.$str("subject_instance_card_job_assignment","mod_perform"),text:e},{label:this.$str("subject_instance_card_instance_count","mod_perform"),text:this.subjectInstance.instance_count},{label:this.$str("instance_info_card_creation_date","mod_perform"),text:this.subjectInstance.created_at}]}},apollo:{subjectInstance:{query:n.a,variables(){return{subject_instance_id:this.subjectInstanceId}},update:e=>e.mod_perform_subject_instance_for_participant}}},d=i("KHd+"),c=function(e){e.options.__langStrings={mod_perform:["instance_info_card_creation_date","instance_info_card_show_all_button","instance_info_card_subject_full_name","subject_instance_card_instance_count","subject_instance_card_job_assignment","subject_instance_card_title"]}},u=Object(d.a)(l,(function(){var e=this.$createElement,t=this._self._c||e;return t("Loader",{attrs:{loading:this.$apollo.loading}},[t("InstanceInfoCard",{attrs:{title:this.$str("subject_instance_card_title","mod_perform"),"info-lines":this.infoLines,"show-all-link":this.showAllLink}})],1)}),[],!1,null,null,null);"function"==typeof c&&c(u),u.options.__hasBlocks={script:!0,template:!0};t.default=u.exports},o01z:function(e,t){e.exports=tui.require("tui/components/sidepanel/SidePanelNav")},oMuj:function(e,t){e.exports=tui.require("tui/components/form/InputText")},oOnd:function(e,t,i){"use strict";i.r(t);var n=i("9Afl"),a=i.n(n),s=i("F6B7"),r=i.n(s),o=i("vF5l"),l=i.n(o),d=i("BN8m"),c=i.n(d),u=i("jJ8l"),m=i.n(u),_=i("C+/B"),p=i.n(_),v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_delete_section"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_delete_section_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_delete_section"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[]}]}}]},f=i("gLvT"),g=i.n(f),k=i("KGcv"),h=i.n(k),y=i("bF0+"),S=i.n(y),b=i("NAOU"),N=i.n(b),F=i("D9If"),A=i.n(F),C=i("oMuj"),E=i.n(C),I=i("tNJr"),T=i.n(I),x=i("tXLW"),O=i.n(x),w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_update_section_settings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"update_section_settings_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_update_section_settings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}},{kind:"Field",alias:{kind:"Name",value:"raw_created_at"},name:{kind:"Name",value:"created_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]},{kind:"Field",alias:{kind:"Name",value:"raw_updated_at"},name:{kind:"Name",value:"updated_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"TIMESTAMP"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}}]}}]}}]}}]},$=i("KxNG"),D=i("fCWf");var R={components:{ActionLink:i.n(D).a,ActivitySectionElementSummary:a.a,ActivitySectionRelationship:r.a,Button:l.a,ButtonGroup:c.a,Card:m.a,ConfirmationModal:p.a,Dropdown:g.a,DropdownItem:h.a,EditIcon:S.a,Grid:N.a,GridItem:A.a,InputText:E.a,MoreButton:T.a,ParticipantsPopover:O.a},props:{autoSave:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},section:{type:Object,required:!0},lastSection:{type:Boolean,required:!0},isAdding:{type:Boolean,required:!0},sortOrder:{type:Number,required:!0},relationships:{type:Array,required:!0},sectionCount:{type:Number,required:!0},activityName:{type:String,required:!0},multipleSectionsEnabled:{type:Boolean},activityState:{type:Object,required:!0}},data(){return{savedSection:this.section,displayedParticipants:this.getParticipantsFromSection(this.section),title:this.section.title,isSaving:!1,TITLE_INPUT_MAX_LENGTH:1024,deleteSectionModalOpen:!1,deleting:!1}},computed:{isEditing(){return!this.autoSave&&this.editMode},savedParticipants(){return this.getParticipantsFromSection(this.savedSection)},hasChanges(){return!!this.isNew||(this.title!==this.savedSection.title||(this.displayedParticipants.length!==this.savedParticipants.length||!this.displayedParticipants.every(e=>this.savedParticipants.find(t=>t.core_relationship.id===e.core_relationship.id&&t.can_view===e.can_view&&t.can_answer===e.can_answer))))},displayedAnsweringParticipantsSorted(){return this.displayedParticipantsSorted.filter(e=>e.can_answer)},displayedViewOnlyParticipantsSorted(){return this.displayedParticipantsSorted.filter(e=>!e.can_answer)},displayedParticipantsSorted(){return this.displayedParticipants.slice().sort((e,t)=>e.core_relationship.sort_order-t.core_relationship.sort_order)},isNew(){return this.savedSection.raw_created_at===this.savedSection.raw_updated_at},canDelete(){return this.sectionCount>1},isDraft(){return this.activityState.name===$.ACTIVITY_STATUS_DRAFT}},watch:{editMode(e,t){e&&!t&&this.$nextTick(()=>{this.focusTitleInput()})},section:function(){this.title=this.section.title,this.displayedParticipants=this.getParticipantsFromSection(this.section)}},mounted(){this.editMode&&this.focusTitleInput()},updated(){this.$emit("has-unsaved-changes")},methods:{getParticipantsFromSection:e=>e.section_relationships?e.section_relationships:[],getTitle(){return this.section.title},getSectionRelationships(){return this.displayedParticipants.map(e=>({core_relationship_id:e.core_relationship.id,can_view:e.can_view,can_answer:e.can_answer}))},updateSection(e){const t=Object.assign({},this.savedSection,e);this.$emit("input",t)},updateTitle(e){this.title=e},enableEditing(){this.$emit("toggle-edit-mode",!0)},disableEditing(){this.$emit("toggle-edit-mode",!1)},updateDisplayedParticipants(e,t){this.displayedParticipants=this.displayedParticipants.concat(t.map(t=>({can_answer:!e,can_view:e,core_relationship:t}))),this.autoSave&&this.trySave()},updateParticipantData(e){this.displayedParticipants=this.displayedParticipants.map(t=>t.core_relationship.id===e.core_relationship.id?e:t),this.autoSave&&this.trySave()},removeDisplayedParticipant(e){this.displayedParticipants=this.displayedParticipants.filter(t=>t.core_relationship.id!==e.core_relationship.id),this.autoSave&&this.trySave()},resetSectionChanges(){this.displayedParticipants=this.getParticipantsFromSection(this.savedSection),this.title=this.savedSection.title,this.disableEditing()},async trySave(){this.isSaving=!0;try{const e=await this.save();this.updateTitle(e.section.title),this.updateSection(e),this.$emit("mutation-success")}catch(e){this.displayedParticipants=this.getParticipantsFromSection(this.section),this.$emit("mutation-error",e)}this.isSaving=!1,this.disableEditing()},async save(){const{data:e}=await this.$apollo.mutate({mutation:w,variables:{input:{section_id:this.section.id,title:this.title,relationships:this.getSectionRelationships()}},refetchAll:!1}),t=e.mod_perform_update_section_settings;return this.savedSection=t.section,t},showDeleteModal(){this.deleteSectionModalOpen=!0},closeDeleteSectionModal(){this.deleteSectionModalOpen=!1,this.deleting=!1},async deleteSection(){this.deleting=!0;try{await this.$apollo.mutate({mutation:v,variables:{input:{section_id:this.section.id}}}),this.$emit("delete-section"),this.$emit("mutation-success")}catch(e){this.$emit("mutation-error",e)}this.closeDeleteSectionModal()},focusTitleInput(){this.$refs.titleInput.$el.focus()}}},j=(i("TFH/"),i("KHd+")),q=function(e){e.options.__langStrings={core:["cancel","delete"],mod_perform:["activity_participant_view_other_responses","activity_participants_heading","activity_participants_view_only_heading","activity_section_done","edit_content_elements","edit_section","modal_section_delete_message","modal_section_delete_title","no_participants_added","section_action_add_above","section_action_add_below","section_action_delete","section_dropdown_menu","section_title","unsaved_changes_warning","untitled_section","view_content_elements"]}},P=Object(j.a)(R,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(e.autoSave?"div":"Card",{tag:"Component",staticClass:"tui-performActivitySection",class:[!e.autoSave&&"tui-performActivitySection__multiple"],attrs:{"no-border":e.autoSave}},[i("div",{class:{"tui-performActivitySection--editing":e.editMode&&!e.autoSave}},[e.autoSave||e.editMode?e._e():i("Grid",[i("GridItem",{attrs:{units:e.isDraft?10:12}},[i("h4",{staticClass:"tui-performActivitySection__title"},[e._v("\n          "+e._s(e.savedSection.display_title)+"\n        ")])]),e._v(" "),e.isDraft?i("GridItem",{attrs:{units:2}},[i("div",{staticClass:"tui-performActivitySection__action-buttons"},[i("EditIcon",{staticClass:"tui-performActivitySection__action-edit",attrs:{"aria-label":e.$str("edit_section","mod_perform")},on:{click:e.enableEditing}}),e._v(" "),i("Dropdown",{attrs:{position:"bottom-right"},scopedSlots:e._u([{key:"trigger",fn:function(t){var n=t.toggle;return[i("MoreButton",{attrs:{"aria-label":e.$str("section_dropdown_menu","mod_perform"),"no-padding":!0},on:{click:n}})]}}],null,!1,3709095304)},[e._v(" "),i("DropdownItem",{attrs:{disabled:e.isAdding},on:{click:function(t){return e.$emit("add_above")}}},[e._v("\n              "+e._s(e.$str("section_action_add_above","mod_perform"))+"\n            ")]),e._v(" "),e.lastSection?e._e():i("DropdownItem",{attrs:{disabled:e.isAdding},on:{click:function(t){return e.$emit("add_below")}}},[e._v("\n              "+e._s(e.$str("section_action_add_below","mod_perform"))+"\n            ")]),e._v(" "),e.canDelete?i("DropdownItem",{on:{click:e.showDeleteModal}},[e._v("\n              "+e._s(e.$str("section_action_delete","mod_perform"))+"\n            ")]):e._e()],1)],1)]):e._e()],1),e._v(" "),!e.autoSave&&e.editMode?i("InputText",{ref:"titleInput",attrs:{value:e.title,placeholder:e.$str("untitled_section","mod_perform"),"aria-label":e.$str("section_title","mod_perform"),maxlength:e.TITLE_INPUT_MAX_LENGTH},on:{input:function(t){e.title=t}}}):e._e(),e._v(" "),i("div",{staticClass:"tui-performActivitySection__participant-groups",class:{"tui-performActivitySection__participant-groups--editing":e.isEditing}},[i("Grid",{attrs:{"stack-at":764}},[i("GridItem",{staticClass:"tui-performActivitySection__participant-group",attrs:{units:6}},[i("h4",{staticClass:"tui-performActivitySection__participant-heading"},[e._v("\n            "+e._s(e.$str("activity_participants_heading","mod_perform"))+"\n          ")]),e._v(" "),(e.autoSave||e.editMode)&&e.isDraft?e._e():i("span",{staticClass:"tui-performActivitySection__can-view-others-legend"},[e._v("\n            "+e._s(e.$str("activity_participant_view_other_responses","mod_perform"))+"\n          ")]),e._v(" "),i("div",{staticClass:"tui-performActivitySection__participant-items"},e._l(e.displayedAnsweringParticipantsSorted,(function(t){return i("ActivitySectionRelationship",{key:t.core_relationship.id,attrs:{participant:t,editable:(e.autoSave||e.editMode)&&e.isDraft},on:{"participant-removed":e.removeDisplayedParticipant,"can-view-changed":e.updateParticipantData}})})),1),e._v(" "),0!==e.displayedAnsweringParticipantsSorted.length||(e.autoSave||e.editMode)&&e.isDraft?e._e():i("div",[i("span",{staticClass:"tui-performActivitySection__participant-info"},[e._v("\n              "+e._s(e.$str("no_participants_added","mod_perform"))+"\n            ")])]),e._v(" "),(e.autoSave||e.editMode)&&e.isDraft?i("ParticipantsPopover",{attrs:{relationships:e.relationships,"active-participants":e.displayedParticipants},on:{"update-participants":function(t){return e.updateDisplayedParticipants(!1,t)}}}):e._e()],1),e._v(" "),i("GridItem",{staticClass:"tui-performActivitySection__participant-group",attrs:{units:6}},[i("h4",{staticClass:"tui-performActivitySection__participant-heading"},[e._v("\n            "+e._s(e.$str("activity_participants_view_only_heading","mod_perform"))+"\n          ")]),e._v(" "),i("div",{staticClass:"tui-performActivitySection__participant-items"},e._l(e.displayedViewOnlyParticipantsSorted,(function(t){return i("ActivitySectionRelationship",{key:t.core_relationship.id,attrs:{participant:t,"is-view-only-participant":"",editable:(e.autoSave||e.editMode)&&e.isDraft},on:{"participant-removed":e.removeDisplayedParticipant}})})),1),e._v(" "),0!==e.displayedViewOnlyParticipantsSorted.length||(e.autoSave||e.editMode)&&e.isDraft?e._e():i("div",[i("span",{staticClass:"tui-performActivitySection__participant-info"},[e._v("\n              "+e._s(e.$str("no_participants_added","mod_perform"))+"\n            ")])]),e._v(" "),(e.autoSave||e.editMode)&&e.isDraft?i("ParticipantsPopover",{attrs:{relationships:e.relationships,"is-view-only-participants":"","active-participants":e.displayedParticipants},on:{"update-participants":function(t){return e.updateDisplayedParticipants(!0,t)}}}):e._e()],1)],1)],1)],1),e._v(" "),!e.autoSave&&e.editMode?i("ButtonGroup",{staticClass:"tui-performActivitySection__saveButtons"},[i("Button",{attrs:{styleclass:{primary:!0,small:!0},text:e.$str("activity_section_done","mod_perform"),disabled:e.isSaving||!e.editMode||!e.hasChanges},on:{click:e.trySave}}),e._v(" "),i("Button",{attrs:{text:e.$str("cancel","core"),styleclass:{small:!0},disabled:e.isSaving||!e.editMode},on:{click:e.resetSectionChanges}})],1):e._e(),e._v(" "),i("hr",{staticClass:"tui-performActivitySection__divider"}),e._v(" "),i("div",{staticClass:"tui-performActivitySection__content",class:{"tui-performActivitySection__content--autoSave":e.autoSave}},[i("Grid",{attrs:{"stack-at":700}},[i("GridItem",{attrs:{grows:"",units:9}},[e.section.section_elements_summary?i("ActivitySectionElementSummary",{attrs:{"elements-summary":e.section.section_elements_summary}}):e._e()],1),e._v(" "),i("GridItem",{attrs:{grows:"",units:3}},[i("div",{staticClass:"tui-performActivitySection__content-buttons"},[i("ActionLink",{attrs:{href:e.$url("/mod/perform/manage/activity/section.php",{section_id:e.section.id}),text:e.isDraft?e.$str("edit_content_elements","mod_perform"):e.$str("view_content_elements","mod_perform"),styleclass:{small:!0}}})],1)])],1)],1),e._v(" "),i("ConfirmationModal",{attrs:{open:e.deleteSectionModalOpen,title:e.$str("modal_section_delete_title","mod_perform"),"confirm-button-text":e.$str("delete","core"),loading:e.deleting},on:{confirm:e.deleteSection,cancel:e.closeDeleteSectionModal}},[[i("p",[e._v(e._s(e.$str("modal_section_delete_message","mod_perform")))])]],2)],1)}),[],!1,null,null,null);"function"==typeof q&&q(P),P.options.__hasBlocks={script:!0,template:!0};t.default=P.exports},ohrl:function(e,t,i){"use strict";var n=i("Oa7+");i.n(n).a},ojeY:function(e,t,i){"use strict";var n=i("1fhJ");i.n(n).a},olVF:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/assignment/schedule/AssignmentScheduleCreationRange")},oqEP:function(e,t,i){"use strict";i.r(t);var n=i("49h4"),a=i.n(n),s=i("JXQf"),r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_responding_relationships_involved_in_subject_instance"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_responding_relationships_involved_in_subject_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}}]},o={components:{Loader:i.n(s).a,SelectFilter:a.a},props:{value:{type:String,default:null},subjectInstanceId:{type:[Number,String],required:!0},anonymousResponses:{type:Boolean,required:!0}},data:()=>({relationships:[]}),computed:{options(){const e=this.relationships.map(e=>({id:e.name,label:e.name}));return e.unshift({id:null,label:this.$str("all_relationships_select_option_label","mod_perform")}),e}},apollo:{relationships:{query:r,variables(){return{subject_instance_id:this.subjectInstanceId}},update(e){const t=e.mod_perform_responding_relationships_involved_in_subject_instance;return null===this.value||t.some(e=>e.name===this.value)||this.$emit("input",null),t}}}},l=i("KHd+"),d=function(e){e.options.__langStrings={mod_perform:["all_relationships_select_option_label","all_responses_anonymised","responses_by_relationship"]}},c=Object(l.a)(o,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[e.anonymousResponses?i("span",[i("strong",[e._v(e._s(e.$str("all_responses_anonymised","mod_perform")))])]):i("Loader",{attrs:{loading:e.$apollo.loading}},[i("SelectFilter",{attrs:{value:e.value,label:e.$str("responses_by_relationship","mod_perform"),options:e.options,"show-label":!0,stacked:!0},on:{input:function(t){return e.$emit("input",t)}}})],1)],1)}),[],!1,null,null,null);"function"==typeof d&&d(c),c.options.__hasBlocks={script:!0,template:!0};t.default=c.exports},"p/9T":function(e,t,i){},p4hk:function(e,t,i){},pVBh:function(e,t,i){"use strict";i.r(t);var n=i("kUb+"),a=i.n(n),s=i("fCWf"),r={components:{ActionLink:i.n(s).a,ActionCard:a.a},props:{title:{type:String,required:!0},infoLines:{type:Array,required:!0},showAllLink:{type:String,required:!0}}},o=(i("eRy6"),i("KHd+")),l=function(e){e.options.__langStrings={mod_perform:["instance_info_card_show_all_button"]}},d=Object(o.a)(r,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ActionCard",{staticClass:"tui-instanceInfoCard",scopedSlots:e._u([{key:"card-body",fn:function(){return[i("div",[i("h3",{staticClass:"tui-instanceInfoCard__title"},[e._v("\n        "+e._s(e.title)+"\n      ")]),e._v(" "),i("div",{staticClass:"tui-instanceInfoCard__info-section"},e._l(e.infoLines,(function(t){return i("p",{key:t.label,staticClass:"tui-instanceInfoCard__info-row"},[i("span",{staticClass:"tui-instanceInfoCard__info-label"},[i("strong",[e._v(e._s(t.label))])]),e._v(" "),i("span",{staticClass:"tui-instanceInfoCard__info-value"},[e._v("\n            "+e._s(t.text)+"\n          ")])])})),0)])]},proxy:!0},{key:"card-action",fn:function(){return[i("ActionLink",{attrs:{href:e.showAllLink,text:e.$str("instance_info_card_show_all_button","mod_perform"),styleclass:{small:!0}}})]},proxy:!0}])})}),[],!1,null,null,null);"function"==typeof l&&l(d),d.options.__hasBlocks={script:!0,template:!0};t.default=d.exports},pYwm:function(e,t,i){"use strict";i.r(t);var n=i("fCWf"),a=i.n(n),s=i("vF5l"),r=i.n(s),o=i("JXQf"),l=i.n(o),d=i("tkAW"),c=i.n(d),u=i("u5iS"),m=i.n(u),_=i("Mnur"),p=i.n(_),v=i("fw38"),f=i.n(v),g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_participant_manageable_activities"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_participant_manageable_activities"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]},k={components:{ActionLink:a.a,Button:r.a,Loader:l.a,Modal:c.a,ModalContent:m.a,ModalPresenter:p.a,Select:f.a},props:{value:{type:Boolean,required:!0}},data:()=>({isOpen:!1,selectedActivityId:null,activities:[]}),computed:{mightHaveOptions(){return!!this.$apollo.loading||this.activities.length>0},options(){return this.activities.map(e=>({id:e.id,label:e.name}))},continueHref(){return this.selectedActivityId?this.$url("/mod/perform/manage/participation/subject_instances.php?activity_id="+this.selectedActivityId):"#"}},mounted(){this.value&&this.open()},apollo:{activities:{query:g,update(e){const t=e.mod_perform_participant_manageable_activities;return t.length>0&&(this.selectedActivityId=t[0].id),t}}},methods:{open(){this.isOpen=!0},close(){this.isOpen=!1,this.$emit("input",!1)}}},h=i("KHd+"),y=function(e){e.options.__langStrings={mod_perform:["button_close","button_continue","manage_participation","manage_participation_select_activity","manage_participation_no_activities"]}},S=Object(h.a)(k,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ModalPresenter",{attrs:{open:e.isOpen},on:{"request-close":e.close}},[i("Modal",[i("ModalContent",{attrs:{title:e.$str("manage_participation_select_activity","mod_perform")},scopedSlots:e._u([{key:"buttons",fn:function(){return[e.mightHaveOptions?i("ActionLink",{attrs:{href:e.continueHref,text:e.$str("button_continue","mod_perform"),disabled:!e.selectedActivityId,styleclass:{primary:!0}}}):e._e(),e._v(" "),i("Button",{attrs:{text:e.$str("button_close","mod_perform")},on:{click:e.close}})]},proxy:!0}])},[i("Loader",{attrs:{loading:e.$apollo.loading}},[e.mightHaveOptions?i("Select",{attrs:{options:e.options,name:"manage-participation-activity-select"},model:{value:e.selectedActivityId,callback:function(t){e.selectedActivityId=t},expression:"selectedActivityId"}}):i("p",[e._v("\n          "+e._s(e.$str("manage_participation_no_activities","mod_perform"))+"\n        ")])],1)],1)],1)],1)}),[],!1,null,null,null);"function"==typeof y&&y(S),S.options.__hasBlocks={script:!0,template:!0};t.default=S.exports},q81d:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("KGot"),r=i.n(s),o=i("Eb8+"),l=i.n(o),d=i("PNtU"),c=i.n(d),u=i("Mnur"),m=i.n(u),_=i("s0yi"),p=i.n(_),v=i("7tcR"),f=i.n(v),g=i("yikf"),k=i.n(g),h={components:{Button:a.a,Cell:r.a,Lock:l.a,Lozenge:c.a,ModalPresenter:m.a,ParticipantUserHeader:p.a,RelationshipSelector:f.a,Table:k.a},props:{currentUserId:{required:!0,type:Number},isMultiSectionActive:{required:!0,type:Boolean},subjectSections:{required:!0,type:Array},viewUrl:{required:!0,type:String},subjectUser:{required:!0,type:Object},anonymousResponses:{required:!0,type:Boolean},activityId:{required:!0,type:String}},data:()=>({isRelationshipSelectorShown:!1,selectedParticipantSections:[]}),computed:{subjectSectionsSubset(){return this.subjectSections.map(e=>{const t=e.participant_sections.map(e=>{let t,i,n={};const a=e.participant_instance.is_for_current_user;return!a&&this.anonymousResponses||(t=e.participant_instance.core_relationship.name,i=e.participant_instance.core_relationship.id,n=e.participant_instance.participant),{id:e.id,isForCurrentUser:a,progressStatus:e.progress_status,availabilityStatus:e.availability_status,isOverdue:e.is_overdue,canAnswer:e.can_answer,participant:n,relationship:t,relationship_id:i}}),i=t.filter(e=>!this.anonymousResponses||e.isForCurrentUser),n=this.filterToCanAnswer(i),a=this.filterToCurrentUser(n).length>0;return{canParticipate:e.can_participate,canCurrentUserAnswer:a,participation:i,participationToDisplay:n,summary:this.getParticipantSummary(t),participant_sections:e.participant_sections,section:e.section}})}},mounted(){this.checkSingleSectionViewOnly()},methods:{getStatusText(e){switch(e){case"NOT_STARTED":return this.$str("user_activities_status_not_started","mod_perform");case"IN_PROGRESS":return this.$str("user_activities_status_in_progress","mod_perform");case"COMPLETE":return this.$str("user_activities_status_complete","mod_perform");case"NOT_SUBMITTED":return this.$str("user_activities_status_not_submitted","mod_perform");default:return""}},getFirstSectionIdToParticipate(e){let t=e.participation.find(e=>e.isForCurrentUser);if(!t)throw"Section for user not found.";return t.id},currentUserHasMultipleRelationships(e){return this.filterToCurrentUser(e.participation).length>1},showRelationshipSelector(e){this.selectedParticipantSections=[],e.participant_sections.forEach(e=>{this.selectedParticipantSections.push(e)}),this.isRelationshipSelectorShown=!0},hideRelationshipSelector(){this.isRelationshipSelectorShown=!1},filterToCurrentUser:e=>e.filter(e=>e.isForCurrentUser),filterToCanAnswer:e=>e.filter(e=>e.canAnswer),getParticipantSummary(e){const t=this.filterToCanAnswer(e);return{totalRespondents:t.length,totalCompleted:t.filter(e=>"COMPLETE"===e.progressStatus).length}},checkSingleSectionViewOnly(){1!==this.subjectSectionsSubset.length||this.subjectSectionsSubset[0].canCurrentUserAnswer||this.$emit("single-section-view-only",this.activityId)}}},y=(i("ohrl"),i("KHd+")),S=function(e){e.options.__langStrings={mod_perform:["is_overdue","user_activities_closed","user_activities_section_view_only","user_activities_status_complete","user_activities_status_header_relationship","user_activities_status_header_section_progress","user_activities_status_in_progress","user_activities_status_not_started","user_activities_status_not_submitted","user_activities_subject_header","user_activities_total_completed","user_activities_total_respondents","user_activities_you"]}},b=Object(y.a)(h,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivityListSections"},[e._l(e.subjectSectionsSubset,(function(t){return i("div",{key:t.section.id,staticClass:"tui-performUserActivityListSection"},[e.isMultiSectionActive?i("h3",{staticClass:"tui-performUserActivityListSection__header"},[t.canParticipate?[e.currentUserHasMultipleRelationships(t)?i("Button",{staticClass:"tui-performUserActivityListSection__selectRelationshipLink",attrs:{styleclass:{transparent:!0},text:t.section.display_title},on:{click:function(i){return e.showRelationshipSelector(t)}}}):i("a",{attrs:{href:e.$url(e.viewUrl,{participant_section_id:e.getFirstSectionIdToParticipate(t)})}},[e._v("\n          "+e._s(t.section.display_title)+"\n        ")]),e._v(" "),t.canCurrentUserAnswer?e._e():i("span",[e._v("\n          "+e._s(e.$str("user_activities_section_view_only","mod_perform"))+"\n        ")])]:[e._v("\n        "+e._s(t.section.display_title)+"\n      ")]],2):e._e(),e._v(" "),!e.anonymousResponses||t.participationToDisplay.length>0?i("Table",{staticClass:"tui-performUserActivityListSection__data",attrs:{data:t.participationToDisplay,"border-bottom-hidden":!0,"border-separator-hidden":!0,"border-top-hidden":!e.isMultiSectionActive},scopedSlots:e._u([{key:"row",fn:function(t){var n=t.row;return[i("Cell",{attrs:{size:"4","column-header":e.$str("user_activities_status_header_relationship","mod_perform"),heavy:n.isForCurrentUser,valign:"center"}},[e._v("\n          "+e._s(n.relationship)+"\n        ")]),e._v(" "),i("Cell",{attrs:{size:"4","column-header":e.$str("user_activities_subject_header","mod_perform"),heavy:n.isForCurrentUser,valign:"center"}},[i("ParticipantUserHeader",{attrs:{"user-name":n.isForCurrentUser?e.$str("user_activities_you","mod_perform"):n.participant.fullname,"profile-picture":n.participant.profileimageurlsmall,size:"xxsmall"}})],1),e._v(" "),i("Cell",{attrs:{size:"4","column-header":e.$str("user_activities_status_header_section_progress","mod_perform"),heavy:n.isForCurrentUser,valign:"center"}},[e._v("\n          "+e._s(e.getStatusText(n.progressStatus))+"\n          "),"CLOSED"===n.availabilityStatus?i("Lock",{attrs:{alt:e.$str("user_activities_closed","mod_perform"),title:e.$str("user_activities_closed","mod_perform")}}):e._e(),e._v(" "),n.isOverdue?i("Lozenge",{attrs:{type:"alert",text:e.$str("is_overdue","mod_perform")}}):e._e()],1)]}}],null,!0)}):e._e(),e._v(" "),e.anonymousResponses?[i("hr"),e._v(" "),i("div",{staticClass:"tui-performUserActivityListSection__summary"},[i("p",[e._v("\n          "+e._s(e.$str("user_activities_total_respondents","mod_perform",t.summary.totalRespondents))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("user_activities_total_completed","mod_perform",t.summary.totalCompleted))+"\n        ")])])]:e._e()],2)})),e._v(" "),i("ModalPresenter",{attrs:{open:e.isRelationshipSelectorShown},on:{"request-close":e.hideRelationshipSelector}},[i("RelationshipSelector",{attrs:{"current-user-id":e.currentUserId,"participant-sections":e.selectedParticipantSections,"is-for-section":!0,"subject-user":e.subjectUser,"view-url":e.viewUrl},model:{value:e.isRelationshipSelectorShown,callback:function(t){e.isRelationshipSelectorShown=t},expression:"isRelationshipSelectorShown"}})],1)],2)}),[],!1,null,null,null);"function"==typeof S&&S(b),b.options.__hasBlocks={script:!0,template:!0};t.default=b.exports},qBWj:function(e,t,i){"use strict";i.r(t);var n=i("g8/U"),a={components:{PageHeading:i.n(n).a},props:{reviewUrl:{required:!0,type:Boolean},isClosed:{required:!0,type:Boolean}}},s=(i("OgUY"),i("KHd+")),r=function(e){e.options.__langStrings={mod_perform:["external_participation_success_heading","external_participation_success_message","external_participation_success_message_closed","external_participation_success_review_link_text"]}},o=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivitySuccess"},[i("PageHeading",{attrs:{title:e.$str("external_participation_success_heading","mod_perform")}}),e._v(" "),i("div",[e._v("\n    "+e._s(e.$str("external_participation_success_message","mod_perform"))+"\n  ")]),e._v(" "),e.isClosed?i("div",[e._v("\n    "+e._s(e.$str("external_participation_success_message_closed","mod_perform"))+"\n  ")]):i("div",[i("a",{attrs:{href:e.reviewUrl}},[e._v("\n      "+e._s(e.$str("external_participation_success_review_link_text","mod_perform"))+"\n    ")])])],1)}),[],!1,null,null,null);"function"==typeof r&&r(o),o.options.__hasBlocks={script:!0,template:!0};t.default=o.exports},qCQ6:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant/ParticipantGeneralInformation")},qS45:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("BN8m"),r=i.n(s),o=i("tkAW"),l=i.n(o),d=i("u5iS"),c=i.n(d),u=i("Mnur"),m=i.n(u),_={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_manually_change_subject_instance"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_manually_change_subject_instance_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_manually_change_subject_instance"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subject_instance"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}]}}]},p=i("vyVp"),v=i("E7bt"),f=i("KxNG"),g={components:{Button:a.a,ButtonGroup:r.a,Modal:l.a,ModalContent:c.a,ModalPresenter:m.a},props:{modalOpen:{type:Boolean},subjectInstanceId:{type:String},isOpen:{type:Boolean},reportType:{type:String}},methods:{modalClose(){this.$emit("modal-close")},showErrorNotification(){Object(p.notify)({message:this.$str("toast_error_generic_update","mod_perform"),type:"error"})},async changeAvailability(){try{let e=this.isOpen?f.INSTANCE_AVAILABILITY_STATUS_CLOSED:f.INSTANCE_AVAILABILITY_STATUS_OPEN;await this.$apollo.mutate({mutation:_,variables:{input:{subject_instance_id:this.subjectInstanceId,availability:e}}}),this.$emit("modal-close"),Object(v.redirectWithPost)(window.location,{is_open:!this.isOpen,report_type:this.reportType})}catch(e){this.showErrorNotification()}}}},k=i("KHd+"),h=function(e){e.options.__langStrings={mod_perform:["button_cancel","button_close","button_reopen","subject_instance_closed_message_line1","subject_instance_closed_message_line2","subject_instance_closed_title","subject_instance_reopen_title","subject_instance_reopen_message_line1","subject_instance_reopen_message_line2","subject_instance_reopen_message_line3","toast_error_generic_update"]}},y=Object(k.a)(g,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ModalPresenter",{attrs:{open:e.modalOpen},on:{"request-close":e.modalClose}},[i("Modal",{attrs:{size:"normal","aria-labelledby":e.$id("report_open_close")}},[i("ModalContent",{attrs:{title:e.$str(e.isOpen?"subject_instance_closed_title":"subject_instance_reopen_title","mod_perform"),"title-id":e.$id("report_open_close")},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("ButtonGroup",[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str(e.isOpen?"button_close":"button_reopen","mod_perform")},on:{click:function(t){return e.changeAvailability()}}}),e._v(" "),i("Button",{attrs:{text:e.$str("button_cancel","mod_perform")},on:{click:function(t){return e.modalClose()}}})],1)]},proxy:!0}])},[e.isOpen?[i("p",[e._v("\n          "+e._s(e.$str("subject_instance_closed_message_line1","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("subject_instance_closed_message_line2","mod_perform"))+"\n        ")])]:[i("p",[e._v("\n          "+e._s(e.$str("subject_instance_reopen_message_line1","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("subject_instance_reopen_message_line2","mod_perform"))+"\n        ")]),e._v(" "),i("p",[e._v("\n          "+e._s(e.$str("subject_instance_reopen_message_line3","mod_perform"))+"\n        ")])]],2)],1)],1)}),[],!1,null,null,null);"function"==typeof h&&h(y),y.options.__hasBlocks={script:!0,template:!0};t.default=y.exports},qa8l:function(e,t,i){"use strict";i.r(t);var n=i("tqxB"),a={components:{ExportRowAction:i.n(n).a},props:{subjectInstanceId:{required:!0,type:Number}},computed:{exportHrefParams(){return{subject_instance_id:this.subjectInstanceId}}}},s=i("KHd+"),r=Object(s.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("ExportRowAction",{attrs:{"additional-export-href-params":this.exportHrefParams}})],1)}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};t.default=r.exports},rGKm:function(e,t,i){},rgbN:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("tkAW"),r=i.n(s),o=i("u5iS"),l=i.n(o),d=i("Mnur"),c=i.n(d),u={components:{Button:a.a,Modal:r.a,ModalContent:l.a,ModalPresenter:c.a},props:{open:{type:Boolean,required:!0},exportHref:{type:String,required:!0}},data:()=>({buttonsDisabled:!1}),methods:{doExport(){this.buttonsDisabled=!0,window.location=this.exportHref,this.closeModal(),this.buttonsDisabled=!1},closeModal(){this.$emit("request-close")}}},m=i("KHd+"),_=function(e){e.options.__langStrings={mod_perform:["button_cancel","export","export_confirm_modal_title","export_confirm_modal_text"]}},p=Object(m.a)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ModalPresenter",{attrs:{open:e.open},on:{"request-close":e.closeModal}},[i("Modal",{staticClass:"tui-elementResponseReportingExportConfirmModal",attrs:{"aria-labelledby":e.$id("question-element-preview-modal"),size:"normal"}},[i("ModalContent",{attrs:{title:e.$str("export_confirm_modal_title","mod_perform"),"title-id":e.$id("element-response-reporting-export-confirm-modal")},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("Button",{attrs:{disabled:e.buttonsDisabled,styleclass:{primary:!0},text:e.$str("export","mod_perform")},on:{click:e.doExport}}),e._v(" "),i("Button",{attrs:{disabled:e.buttonsDisabled,text:e.$str("button_cancel","mod_perform")},on:{click:e.closeModal}})]},proxy:!0}])},[i("p",[e._v("\n        "+e._s(e.$str("export_confirm_modal_text","mod_perform"))+"\n      ")])])],1)],1)}),[],!1,null,null,null);"function"==typeof _&&_(p),p.options.__hasBlocks={script:!0,template:!0};t.default=p.exports},rjlk:function(e,t){e.exports=tui.require("tui/components/sidepanel/SidePanelNavButtonItem")},rsf9:function(e,t){e.exports=tui.require("tui/components/datatable/ExpandCell")},ruKP:function(e,t){e.exports=tui.require("tui/components/form/Textarea")},ruQM:function(e,t,i){"use strict";i.r(t);var n=i("vF5l"),a=i.n(n),s=i("nXMa"),r=i.n(s),o=i("WBvU"),l=i("vGF0"),d=i.n(l),c=i("tkAW"),u=i.n(c),m=i("u5iS"),_=i.n(m),p=i("KxNG"),v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_create_activity"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"name"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"description"}},type:{kind:"NamedType",name:{kind:"Name",value:"param_text"}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_create_activity"},arguments:[{kind:"Argument",name:{kind:"Name",value:"name"},value:{kind:"Variable",name:{kind:"Name",value:"name"}}},{kind:"Argument",name:{kind:"Name",value:"description"},value:{kind:"Variable",name:{kind:"Name",value:"description"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}}]}}]}}]}}]},f={components:{Button:a.a,CancelButton:r.a,Uniform:o.Uniform,FormRow:o.FormRow,FormRowDetails:d.a,FormText:o.FormText,FormSelect:o.FormSelect,FormTextarea:o.FormTextarea,Modal:u.a,ModalContent:_.a},props:{types:Array},data:()=>({initialValues:{type:null},isSaving:!1,mutationError:null}),computed:{activityTypes(){return[{id:null,label:this.$str("create_activity_select_placeholder","mod_perform")}].concat(this.types)}},created(){this.ACTIVITY_NAME_MAX_LENGTH=p.ACTIVITY_NAME_MAX_LENGTH},methods:{async trySave(e){this.isSaving=!0;try{const t=await this.save(e);this.$emit("mutation-success",t)}catch(e){this.$emit("mutation-error",e),this.isSaving=!1}},async save(e){const{data:t}=await this.$apollo.mutate({mutation:v,variables:e});return t.mod_perform_create_activity.activity}}},g=i("KHd+"),k=function(e){e.options.__langStrings={mod_perform:["activity_type_help_text","add_activity","button_create","create_activity_select_placeholder","create_activity_title","create_activity_type","general_info_label_activity_description","you_can_add_this_later"]}},h=Object(g.a)(f,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{attrs:{"aria-labelledby":e.$id("title")}},[i("ModalContent",{attrs:{title:e.$str("add_activity","mod_perform"),"title-id":e.$id("title"),"close-button":!1},on:{dismiss:function(t){return e.$emit("cancel")}},scopedSlots:e._u([{key:"buttons",fn:function(){return[i("Button",{attrs:{styleclass:{primary:!0},text:e.$str("button_create","mod_perform"),disabled:e.isSaving},on:{click:function(t){return e.$refs.form.submit()}}}),e._v(" "),i("CancelButton",{attrs:{disabled:e.isSaving},on:{click:function(t){return e.$emit("request-close")}}})]},proxy:!0}])},[i("Uniform",{ref:"form",attrs:{"initial-values":e.initialValues},on:{submit:e.trySave}},[i("FormRow",{attrs:{label:e.$str("create_activity_title","mod_perform"),required:""}},[i("FormText",{attrs:{name:"name",maxlength:e.ACTIVITY_NAME_MAX_LENGTH,"char-length":"full",validations:function(e){return[e.required()]}}})],1),e._v(" "),i("FormRow",{attrs:{label:e.$str("general_info_label_activity_description","mod_perform")}},[i("FormTextarea",{attrs:{name:"description","char-length":"full","aria-describedby":e.$id("desc-desc")}}),e._v(" "),i("FormRowDetails",{attrs:{id:e.$id("desc-desc")}},[e._v("\n          "+e._s(e.$str("you_can_add_this_later","mod_perform"))+"\n        ")])],1),e._v(" "),i("FormRow",{attrs:{label:e.$str("create_activity_type","mod_perform"),required:!0}},[i("FormSelect",{attrs:{name:"type","aria-describedby":e.$id("select-desc"),options:e.activityTypes,"char-length":"10",validations:function(e){return[e.required()]}}}),e._v(" "),i("FormRowDetails",{attrs:{id:e.$id("select-desc")}},[e._v("\n          "+e._s(e.$str("activity_type_help_text","mod_perform"))+"\n        ")])],1)],1)],1)],1)}),[],!1,null,null,null);"function"==typeof k&&k(h),h.options.__hasBlocks={script:!0,template:!0};t.default=h.exports},s0yi:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant/ParticipantUserHeader")},sINS:function(e,t,i){"use strict";i.r(t);var n=i("KGot"),a=i.n(n),s=i("5qAA"),r=i.n(s),o=i("yikf"),l=i.n(o),d={components:{Cell:a.a,HeaderCell:r.a,Table:l.a},props:{myHistoricActivities:{required:!0,type:Array}}},c=(i("ji1A"),i("KHd+")),u=function(e){e.options.__langStrings={mod_perform:["user_historic_activities_activity_title_header","user_historic_activities_type_header","user_historic_activities_status_header"]}},m=Object(c.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Table",{staticClass:"tui-performMyHistoricActivityList",attrs:{data:e.myHistoricActivities},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",{attrs:{size:"8"}},[e._v("\n      "+e._s(e.$str("user_historic_activities_activity_title_header","mod_perform"))+"\n    ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n      "+e._s(e.$str("user_historic_activities_type_header","mod_perform"))+"\n    ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n      "+e._s(e.$str("user_historic_activities_status_header","mod_perform"))+"\n    ")])]},proxy:!0},{key:"row",fn:function(t){var n=t.row;return[i("Cell",{attrs:{size:"8","column-header":e.$str("user_historic_activities_activity_title_header","mod_perform"),valign:"center"}},[i("a",{attrs:{href:n.activity_link}},[e._v("\n        "+e._s(n.activity_name)+"\n      ")])]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_historic_activities_type_header","mod_perform")}},[e._v("\n      "+e._s(n.type)+"\n    ")]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("user_historic_activities_status_header","mod_perform"),valign:"center"}},[e._v("\n      "+e._s(n.status)+"\n    ")])]}}])})}),[],!1,null,null,null);"function"==typeof u&&u(m),m.options.__hasBlocks={script:!0,template:!0};t.default=m.exports},sL7E:function(e,t,i){"use strict";i.r(t);var n=i("tqxB"),a={components:{ExportRowAction:i.n(n).a},props:{subjectUserId:{required:!0,type:Number}},computed:{exportHrefParams(){return{subject_user_id:this.subjectUserId}}}},s=i("KHd+"),r=Object(s.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("ExportRowAction",{attrs:{"additional-export-href-params":this.exportHrefParams}})],1)}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};t.default=r.exports},sVqh:function(e,t){e.exports=tui.require("tui/date")},sYsA:function(e,t){e.exports=tui.require("tui/components/reform/FieldArray")},sr8J:function(e,t,i){"use strict";i.r(t);var n=i("2LpK"),a=i.n(n),s=i("G0MF"),r=i.n(s),o=i("vF5l"),l=i.n(o),d=i("KGot"),c=i.n(d),u=i("Awxv"),m=i.n(u),_=i("5qAA"),p=i.n(_),v=i("bxeI"),f=i.n(v),g=i("JXQf"),k=i.n(g),h=i("Mnur"),y=i.n(h),S=i("yikf"),b=i.n(S),N=i("vyVp"),F=i("E7bt"),A=i("KxNG"),C={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_paginated_activities"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"query_options_input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_activity_page_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_paginated_activities"},arguments:[{kind:"Argument",name:{kind:"Name",value:"query_options"},value:{kind:"Variable",name:{kind:"Name",value:"query_options_input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"items"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[{kind:"Argument",name:{kind:"Name",value:"format"},value:{kind:"EnumValue",value:"DATE"}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"updated_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view_participation_reporting"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_potentially_activate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_activate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_manage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_clone"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"total"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"next_cursor"},arguments:[],directives:[]}]}}]}}]},E=i("+kGl"),I={components:{ActivityActions:a.a,ActivityFilters:r.a,Button:l.a,Cell:c.a,CreateActivityForm:m.a,HeaderCell:p.a,Layout:f.a,Loader:k.a,ModalPresenter:y.a,Table:b.a},props:{editUrl:{required:!0,type:String},canAdd:{required:!0,type:Boolean}},data:()=>({paginatedActivities:{items:[],total:null,next_cursor:null},activityTypes:[],pageCount:0,modalOpen:!1,appliedFilters:null,appliedSorting:null,filtersHaveChanged:!1}),computed:{hasMoreActivities(){return null!==this.paginatedActivities.next_cursor&&this.paginatedActivities.next_cursor.length>0},activitiesExist(){return null!=this.appliedFilters||!this.$apollo.loading&&this.paginatedActivities.items.length>0}},methods:{creationError(){Object(N.notify)({message:this.$str("toast_error_create_activity","mod_perform"),type:"error"})},showCreateModal(){this.modalOpen=!0},modalRequestClose(){this.modalOpen=!1},activityCreated(e){this.redirectToManageActivity(e.id)},activityCloned({clone:e,id:t}){this.redirectToManageActivity(e.id,{activity_cloned:!0,cloned_activity_id:t})},redirectToManageActivity(e,t){const i=this.getEditActivityUrl(e);t?Object(F.redirectWithPost)(i,t):window.location=i},getEditActivityUrl(e){return this.$url(this.editUrl,{activity_id:e})},refetchActivities(){let e=this.getPaginationOption({limit:this.pageCount*A.DEFAULT_ITEMS_PER_PAGE}),t=this.pageCount;this.$apollo.queries.paginatedActivities.refetch(e).then(()=>{this.pageCount=t})},getPaginationOption({limit:e,cursor:t}){if(this.filtersHaveChanged)return this.filtersHaveChanged=!1,{query_options_input:{pagination:{cursor:null},filters:this.appliedFilters,sort_by:this.appliedSorting}};t||(t=null);let i={cursor:t};return e&&(i.limit=e),{query_options_input:{pagination:i,filters:this.appliedFilters,sort_by:this.appliedSorting}}},loadMore(){this.$apollo.queries.paginatedActivities.fetchMore({variables:this.getPaginationOption({cursor:this.paginatedActivities.next_cursor}),updateQuery:(e,{fetchMoreResult:t})=>(t.mod_perform_paginated_activities.items.unshift(...this.paginatedActivities.items),t)})},applyFilters({filters:e,sorting:t}){this.appliedFilters=e,this.appliedSorting=t,this.filtersHaveChanged=!0,this.pageCount=0,this.refetchActivities()}},apollo:{paginatedActivities:{query:C,variables:()=>({query_options_input:{pagination:{cursor:null}}}),update(e){return this.pageCount++,e.mod_perform_paginated_activities}},activityTypes:{query:E.a,update:({mod_perform_activity_types:e})=>e.map(e=>({id:e.id,label:e.display_name})).sort((e,t)=>e.label.localeCompare(t.label))}}},T=(i("WNR0"),i("KHd+")),x=function(e){e.options.__langStrings={mod_perform:["add_activity","manage_activity_list_none_created","manage_activity_list_none_filtered","perform:manage_activity","showing_activities","toast_error_create_activity","view_actions","view_creation_date","view_name","view_status","view_type"],totara_core:["loadmore"]}},O=Object(T.a)(I,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Layout",{staticClass:"tui-performManageActivityList",attrs:{title:e.$str("perform:manage_activity","mod_perform")},scopedSlots:e._u([{key:"header-buttons",fn:function(){return[e.canAdd?i("Button",{attrs:{styleclass:{primary:!0},disabled:e.$apollo.loading,text:e.$str("add_activity","mod_perform")},on:{click:function(t){return e.showCreateModal()}}}):e._e()]},proxy:!0},{key:"modals",fn:function(){return[i("ModalPresenter",{attrs:{open:e.modalOpen},on:{"request-close":e.modalRequestClose}},[i("CreateActivityForm",{attrs:{types:e.activityTypes},on:{"mutation-success":e.activityCreated,"mutation-error":e.creationError}})],1)]},proxy:!0},{key:"content",fn:function(){return[i("div",{staticClass:"tui-performManageActivityList__content"},[e.activitiesExist?i("ActivityFilters",{attrs:{types:e.activityTypes,shown:e.paginatedActivities.items.length,total:e.paginatedActivities.total},on:{update:e.applyFilters}}):e._e(),e._v(" "),i("Loader",{attrs:{loading:e.$apollo.loading}},[i("Table",{staticClass:"tui-performManageActivityList__table",attrs:{data:e.paginatedActivities.items,"no-items-text":e.activitiesExist?e.$str("manage_activity_list_none_filtered","mod_perform"):e.$str("manage_activity_list_none_created","mod_perform")},scopedSlots:e._u([{key:"header-row",fn:function(){return[i("HeaderCell",{attrs:{size:"8"}},[e._v("\n              "+e._s(e.$str("view_name","mod_perform"))+"\n            ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n              "+e._s(e.$str("view_type","mod_perform"))+"\n            ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n              "+e._s(e.$str("view_creation_date","mod_perform"))+"\n            ")]),e._v(" "),i("HeaderCell",{attrs:{size:"2"}},[e._v("\n              "+e._s(e.$str("view_status","mod_perform"))+"\n            ")]),e._v(" "),i("HeaderCell",{attrs:{size:"1"}})]},proxy:!0},{key:"row",fn:function(t){var n=t.row;return[i("Cell",{attrs:{size:"8","column-header":e.$str("view_name","mod_perform")}},[n.can_manage?i("a",{attrs:{href:e.getEditActivityUrl(n.id)}},[e._v(e._s(n.name))]):i("div",[e._v(e._s(n.name))])]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("view_type","mod_perform")}},[e._v("\n              "+e._s(n.type.display_name)+"\n            ")]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("view_creation_date","mod_perform")}},[e._v("\n              "+e._s(n.created_at)+"\n            ")]),e._v(" "),i("Cell",{attrs:{size:"2","column-header":e.$str("view_status","mod_perform")}},[e._v("\n              "+e._s(n.state_details.display_name)+"\n            ")]),e._v(" "),i("Cell",{attrs:{size:"1","column-header":e.$str("view_actions","mod_perform")}},[i("ActivityActions",{attrs:{activity:n},on:{refetch:e.refetchActivities,"activity-cloned":e.activityCloned}})],1)]}}])}),e._v(" "),!e.$apollo.loading&&e.hasMoreActivities?i("div",{staticClass:"tui-performManageActivityList__loadMore"},[i("Button",{attrs:{text:e.$str("loadmore","totara_core")},on:{click:e.loadMore}})],1):e._e()],1)],1)]},proxy:!0}])})}),[],!1,null,null,null);"function"==typeof x&&x(O),O.options.__hasBlocks={script:!0,template:!0};t.default=O.exports},swk3:function(e,t,i){"use strict";var n=i("1RJV");i.n(n).a},tBqJ:function(e,t,i){},tDCQ:function(e,t,i){"use strict";i.r(t);var n=i("JXQf"),a=i.n(n),s=i("vyhd"),r=i.n(s),o=i("REqq"),l=i.n(o),d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_historic_activities"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_historic_activities"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activity_link"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]}]}}]}}]},c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_other_historic_activities"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_other_historic_activities"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"activity_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activity_link"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"relationship_to"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"status"},arguments:[],directives:[]}]}}]}}]},u={components:{MyHistoricActivities:r.a,OtherHistoricActivities:l.a,Loader:a.a},props:{currentUserId:{required:!0,type:Number}},data:()=>({historicActivities:[],otherHistoricActivities:[]}),apollo:{historicActivities:{query:d,fetchPolicy:"network-only",update:e=>e.mod_perform_historic_activities},otherHistoricActivities:{query:c,fetchPolicy:"network-only",update:e=>e.mod_perform_other_historic_activities}}},m=(i("ncps"),i("KHd+")),_=function(e){e.options.__langStrings={mod_perform:["user_historic_activities_title","user_historic_activities_about_others_title"]}},p=Object(m.a)(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Loader",{attrs:{loading:e.$apollo.loading}},[i("h4",{staticClass:"tui-performUserHistoricActivities__heading"},[e._v("\n    "+e._s(e.$str("user_historic_activities_title","mod_perform"))+"\n  ")]),e._v(" "),e.$apollo.loading?e._e():i("MyHistoricActivities",{attrs:{"my-historic-activities":e.historicActivities}}),e._v(" "),i("h4",{staticClass:"tui-performUserHistoricActivities__heading"},[e._v("\n    "+e._s(e.$str("user_historic_activities_about_others_title","mod_perform"))+"\n  ")]),e._v(" "),e.$apollo.loading?e._e():i("OtherHistoricActivities",{attrs:{"other-historic-activities":e.otherHistoricActivities}})],1)}),[],!1,null,null,null);"function"==typeof _&&_(p),p.options.__hasBlocks={script:!0,template:!0};t.default=p.exports},tKZN:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/Sections")},tNJr:function(e,t){e.exports=tui.require("tui/components/buttons/MoreIcon")},tRCs:function(e,t,i){"use strict";i.r(t);var n=i("+MEP"),a=i.n(n),s=i("Aros"),r=i.n(s),o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_selectable_users"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_selectable_users_filters"}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_selectable_users"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"card_display"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"profile_picture_alt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_picture_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profile_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_fields"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"associate_url"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"value"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"label"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"is_custom"},arguments:[],directives:[]}]}}]}}]}}]}}]},l=i("TXEh"),d={components:{MiniProfileCard:a.a,TagList:r.a},props:{subjectInstanceId:{required:!0,type:[Number,String]},value:{type:Array,default:()=>[]},excludeUsers:{type:Array,default:()=>[]}},data:()=>({fullnameFilter:"",fullnameFilterDebounced:"",users:[]}),apollo:{users:{query:o,variables(){return{subject_instance_id:this.subjectInstanceId,filters:{fullname:this.fullnameFilterDebounced,exclude_users:this.excludeUsers}}},update:e=>e.mod_perform_selectable_users}},computed:{usersDropdownList(){return this.users.filter(e=>!this.value.some(t=>t.id===e.id))},usersTagList(){return this.value.map(e=>({id:e.id,text:e.card_display.display_fields[0].value}))}},methods:{select(e){this.fullnameFilter="",this.fullnameFilterDebounced="",this.$emit("input",this.value.concat([e]))},remove(e){this.$emit("input",this.value.filter(t=>t.id!==e.id))},updateFilter(e){this.fullnameFilter=e,this.updateFilterDebounced(e)},updateFilterDebounced:Object(l.debounce)((function(e){this.fullnameFilterDebounced=e}),500)}},c=i("KHd+"),u=Object(c.a)(d,(function(){var e=this.$createElement,t=this._self._c||e;return t("TagList",{attrs:{tags:this.usersTagList,items:this.usersDropdownList,filter:this.fullnameFilter},on:{select:this.select,remove:this.remove,filter:this.updateFilter},scopedSlots:this._u([{key:"item",fn:function(e){var i=e.item;return[t("MiniProfileCard",{attrs:{"no-border":!0,"no-padding":!0,"read-only":!0,display:i.card_display}})]}}])})}),[],!1,null,null,null);u.options.__hasBlocks={script:!0,template:!0};t.default=u.exports},tXLW:function(e,t){e.exports=tui.require("mod_perform/components/manage_activity/content/ParticipantsPopover")},tkAW:function(e,t){e.exports=tui.require("tui/components/modal/Modal")},tqxB:function(e,t){e.exports=tui.require("mod_perform/components/report/element_response/ExportRowAction")},txsu:function(e,t){e.exports=tui.require("tui/components/tabs/Tabs")},"u/Qm":function(e,t,i){},u5iS:function(e,t){e.exports=tui.require("tui/components/modal/ModalContent")},uDke:function(e,t,i){"use strict";i.r(t);var n=i("5h9J"),a=i.n(n),s=i("Bx/y"),r=i.n(s),o=i("io3G"),l=i.n(o),d={components:{ButtonIcon:a.a,ExportConfirmModal:l.a,DownloadIcon:r.a},props:{additionalExportHrefParams:{type:Object,required:!0}},data:()=>({exportConfirmModal:!1}),computed:{exportHref(){let e=this.additionalExportHrefParams;return Object.assign(e,{action:"item",export:"Export",format:"csv"}),this.$url("/mod/perform/reporting/performance/export.php",e)}},methods:{openExportConfirmModal(){this.exportConfirmModal=!0},closeExportConfirmModal(){this.exportConfirmModal=!1}}},c=i("KHd+"),u=function(e){e.options.__langStrings={mod_perform:["button_export"]}},m=Object(c.a)(d,(function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("ButtonIcon",{attrs:{"aria-label":this.$str("button_export","mod_perform"),styleclass:{transparentNoPadding:!0}},on:{click:this.openExportConfirmModal}},[t("DownloadIcon")],1),this._v(" "),t("ExportConfirmModal",{attrs:{open:this.exportConfirmModal,"export-href":this.exportHref},on:{"request-close":this.closeExportConfirmModal}})],1)}),[],!1,null,null,null);"function"==typeof u&&u(m),m.options.__hasBlocks={script:!0,template:!0};t.default=m.exports},v6iO:function(e,t,i){"use strict";i.r(t);var n=i("f8+O"),a={components:{NoResponseSubmitted:i.n(n).a},props:{data:String},mounted(){this.$_scan()},updated(){this.$_scan()},methods:{$_scan(){this.$nextTick().then(()=>{let e=this.$refs.content;e&&tui.scan(e)})}}},s=i("KHd+"),r=Object(s.a)(a,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tui-participantFormHtmlResponseDisplay"},[this.data&&this.data.length>0?t("div",{ref:"content",domProps:{innerHTML:this._s(this.data)}}):t("NoResponseSubmitted")],1)}),[],!1,null,null,null);r.options.__hasBlocks={script:!0,template:!0};t.default=r.exports},vF5l:function(e,t){e.exports=tui.require("tui/components/buttons/Button")},vGF0:function(e,t){e.exports=tui.require("tui/components/form/FormRowDetails")},vH83:function(e,t){e.exports=tui.require("tui/components/icons/Delete")},vNE0:function(e,t,i){},vlZ8:function(e,t,i){"use strict";var n=i("wiUy");i.n(n).a},vp1m:function(e,t,i){"use strict";i.r(t);var n=i("lWyS"),a=i.n(n),s=i("HGaK"),r=i.n(s),o=i("PNFE"),l=i.n(o),d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"mod_perform_add_section"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"mod_perform_add_section_input"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_add_section"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"section"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"display_title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"sort_order"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"section_relationships"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_answer"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"core_relationship"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"section_elements_summary"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"required_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"optional_question_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"other_element_count"},arguments:[],directives:[]}]}}]}}]}}]}}]},c=i("5h9J"),u=i.n(c),m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_relationships"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"activity_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_relationships"},arguments:[{kind:"Argument",name:{kind:"Name",value:"activity_id"},value:{kind:"Variable",name:{kind:"Name",value:"activity_id"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"idnumber"},arguments:[],directives:[]}]}}]}}]},_=i("JLSV"),p=i.n(_),v=i("KxNG"),f={components:{ActivityMultipleSectionToggle:a.a,ActivitySection:r.a,AddIcon:l.a,ButtonIcon:u.a,WorkflowSettings:p.a},props:{value:{type:Object,required:!0},activityHasUnsavedChanges:Boolean},data(){return{sectionStates:this.createSectionStates(this.value),relationships:[],isAdding:!1}},computed:{autoSave(){return!this.value.settings.multisection},hasUnsavedChanges(){return!this.autoSave&&this.sectionStates.some(e=>e.editMode)&&this.$refs.activitySection.some(e=>e.hasChanges)},activityState(){return this.value.state_details},isDraft(){return this.activityState.name===v.ACTIVITY_STATUS_DRAFT}},mounted(){window.addEventListener("beforeunload",this.unloadHandler)},beforeDestroy(){window.removeEventListener("beforeunload",this.unloadHandler)},methods:{updateSection(e,t){const i=this.value.sections.slice();i[t]=e;const n=Object.assign({},this.value,{sections:i});this.updateActivity(n),this.updateSectionState(e,t)},toggleSectionStateEditMode(e,t){this.sectionStates[t].editMode=e},updateSectionState(e,t){this.sectionStates[t].section=e},createSectionStates(e){return e.sections&&e.sections.length>0?e.sections.map(e=>this.createSectionState(e,!1)):[]},createSectionState:(e,t)=>({editMode:t,sortOrder:e.sort_order,section:e}),updateMultiSection(e){this.sectionStates=this.createSectionStates(e),this.updateActivity(e),this.toggleSectionStateEditMode(e.settings.multisection,0)},updateActivity(e){const t=Object.assign({},this.value,e);this.$emit("input",t)},async trySave(){try{const e=this.value;this.updateActivity(e),this.$emit("mutation-success")}catch(e){this.$emit("mutation-error",e)}},addSectionAbove(e){this.addSection(e)},addSectionBelow(e){this.addSection(e+1)},async addSection(e){this.isAdding=!0;const t=null!==e?this.sectionStates[e].sortOrder:null;try{const{data:{mod_perform_add_section:{section:i}}}=await this.$apollo.mutate({mutation:d,variables:{input:{activity_id:this.value.id,add_before:t}},refetchAll:!0});null!==e?this.insertSectionAt(i,e):this.insertSectionAtEnd(i),this.scrollToSection(i)}catch(e){this.$emit("mutation-error",e)}this.isAdding=!1},insertSectionAt(e,t){this.sectionStates.forEach((t,i)=>{t.sortOrder>=e.sort_order&&this.sectionStates[i].sortOrder++}),this.sectionStates.splice(t,0,this.createSectionState(e,!0))},insertSectionAtEnd(e){this.sectionStates.push(this.createSectionState(e,!0))},scrollToSection(e){this.$nextTick(()=>{this.$refs.activitySection.forEach((t,i)=>{t.sortOrder===e.sort_order&&this.$refs.activitySection[i].$el.scrollIntoView()})})},unloadHandler(e){if(!this.activityHasUnsavedChanges)return;const t=this.$str("unsaved_changes_warning","mod_perform");return e.preventDefault(),e.returnValue=t,t},deleteSection(e){this.sectionStates.splice(e,1);let t=this.sectionStates.map(e=>e.section);this.updateActivity({sections:t})},detectChanges(){this.$emit("unsaved-changes",this.hasUnsavedChanges)}},apollo:{relationships:{query:m,variables(){return{activity_id:this.value.id}},update:e=>e.mod_perform_relationships}}},g=(i("Oct9"),i("KHd+")),k=function(e){e.options.__langStrings={mod_perform:["activity_content_tab_heading","add_section","unsaved_changes_warning"]}},h=Object(g.a)(f,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performManageActivityContent"},[i("WorkflowSettings",{attrs:{activity:e.value},on:{change:function(t){return e.updateActivity(t)}}}),e._v(" "),i("h3",{staticClass:"tui-performManageActivityContent__heading"},[e._v("\n    "+e._s(e.$str("activity_content_tab_heading","mod_perform"))+"\n  ")]),e._v(" "),e.isDraft?i("ActivityMultipleSectionToggle",{attrs:{activity:e.value},on:{change:function(t){return e.updateMultiSection(t)}}}):e._e(),e._v(" "),i("div",{staticClass:"tui-performManageActivityContent__items"},e._l(e.sectionStates,(function(t,n){return i("ActivitySection",{key:t.section.id,ref:"activitySection",refInFor:!0,attrs:{"auto-save":e.autoSave,"edit-mode":t.editMode,section:t.section,"last-section":n===e.sectionStates.length-1,"is-adding":e.isAdding,"sort-order":t.sortOrder,"section-count":e.sectionStates.length,relationships:e.relationships,"activity-name":e.value.name,"multiple-sections-enabled":e.value.settings.multisection,"activity-state":e.activityState},on:{input:function(t){return e.updateSection(t,n)},"toggle-edit-mode":function(t){return e.toggleSectionStateEditMode(t,n)},"mutation-success":function(t){return e.$emit("mutation-success")},"mutation-error":function(t){return e.$emit("mutation-error")},add_above:function(t){return e.addSectionAbove(n)},add_below:function(t){return e.addSectionBelow(n)},"delete-section":function(t){return e.deleteSection(n)},"has-unsaved-changes":e.detectChanges}})})),1),e._v(" "),e.value.settings.multisection&&e.isDraft?i("ButtonIcon",{attrs:{disabled:e.isAdding,"aria-label":e.$str("add_section","mod_perform"),text:e.$str("add_section","mod_perform")},on:{click:function(t){return e.addSection(null)}}},[i("AddIcon",{attrs:{size:"200"}})],1):e._e()],1)}),[],!1,null,null,null);"function"==typeof k&&k(h),h.options.__hasBlocks={script:!0,template:!0};t.default=h.exports},vwAc:function(e,t,i){},vyVp:function(e,t){e.exports=tui.require("tui/notifications")},vyhd:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/list/MyHistoricActivities")},w3ef:function(e,t,i){"use strict";var n=i("EEfk");i.n(n).a},w57E:function(e,t,i){"use strict";i.r(t);var n=i("JXQf"),a=i.n(n),s=i("zdti"),r=i.n(s),o=i("nu/z"),l=i.n(o),d=i("Nou5"),c=i.n(d),u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_subject_instance_for_external_participant_nosession"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"core_id"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"token"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_subject_instance_for_external_participant"},arguments:[{kind:"Argument",name:{kind:"Name",value:"subject_instance_id"},value:{kind:"Variable",name:{kind:"Name",value:"subject_instance_id"}}},{kind:"Argument",name:{kind:"Name",value:"token"},value:{kind:"Variable",name:{kind:"Name",value:"token"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"progress_status"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"created_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"instance_count"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"activity"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"settings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"close_on_completion"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"multisection"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"visibility_condition"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"participant_description"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"view_only_participant_description"},arguments:[],directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"anonymous_responses"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"subject_user"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"fullname"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"profileimageurlsmall"},arguments:[],directives:[]}]}}]}}]}}]},m=i("Lrk7"),_={components:{Loader:a.a,NotificationBanner:r.a,ActivityContent:l.a,ActivityContentPrint:c.a},props:{currentUserId:{required:!1,type:Number,default:null},userActivitiesUrl:{required:!1,type:String},participantInstanceId:{required:!1,type:Number},participantSectionId:{required:!1,type:Number},subjectInstanceId:{required:!1,type:Number},token:{required:!1,type:String,default:""},print:Boolean,printedOnDate:String},data:()=>({jobAssignments:[],userActivity:null,subjectInstance:null}),apollo:{subjectInstance:{query(){return this.isExternalParticipant?u:m.a},skip(){return!this.subjectInstanceId},variables(){return{subject_instance_id:this.subjectInstanceId,token:this.token}},update(e){return this.isExternalParticipant?e.mod_perform_subject_instance_for_external_participant:e.mod_perform_subject_instance_for_participant}}},computed:{isExternalParticipant(){return this.token.length>0},activityNotFound(){return null===this.subjectInstanceId||!this.$apollo.loading&&null===this.subjectInstance}},watch:{subjectInstance(){this.jobAssignments=this.subjectInstance&&!this.isExternalParticipant?this.subjectInstance.static_instances:[]}}},p=i("KHd+"),v=function(e){e.options.__langStrings={mod_perform:["user_activities_activity_does_not_exist"]}},f=Object(p.a)(_,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivity"},[i("Loader",{attrs:{loading:e.$apollo.loading}}),e._v(" "),e.activityNotFound?i("NotificationBanner",{attrs:{dismissable:!1,message:e.$str("user_activities_activity_does_not_exist","mod_perform"),type:"error"}}):e.print&&e.subjectInstance?i("ActivityContentPrint",{attrs:{activity:e.subjectInstance.activity,"participant-instance-id":e.participantInstanceId,"subject-user":e.subjectInstance.subject_user,"created-at":e.subjectInstance.created_at,"due-date":e.subjectInstance.due_date,"job-assignments":e.jobAssignments,"printed-on-date":e.printedOnDate}}):!e.print&&e.subjectInstance?i("ActivityContent",{attrs:{"current-user-id":e.currentUserId,"user-activities-url":e.userActivitiesUrl,activity:e.subjectInstance.activity,"created-at":e.subjectInstance.created_at,"participant-instance-id":e.participantInstanceId,"participant-section-id":e.participantSectionId,"subject-user":e.subjectInstance.subject_user,token:e.token,"job-assignments":e.jobAssignments}}):e._e()],1)}),[],!1,null,null,null);"function"==typeof v&&v(f),f.options.__hasBlocks={script:!0,template:!0};t.default=f.exports},wHjO:function(e,t,i){},wNUA:function(e,t,i){"use strict";var n=i("ZISq");i.n(n).a},wS5V:function(e,t,i){"use strict";var n=i("wgyU");i.n(n).a},wgyU:function(e,t,i){},wiUy:function(e,t,i){},wqLF:function(e,t,i){},xF3i:function(e,t,i){"use strict";var n=i("cY/X");i.n(n).a},xP5P:function(e,t,i){"use strict";i.r(t);var n=i("i/kK"),a={components:{FormRow:i.n(n).a},props:{name:String,type:Object,error:String,accessibleLabel:String,required:Boolean,optional:Boolean,ariaDescribedby:String,activeSectionIsClosed:Boolean,fromPrint:Boolean}},s=(i("zQG5"),i("KHd+")),r=function(e){e.options.__langStrings={mod_perform:["your_response"]}},o=Object(s.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performElementResponse"},[e.activeSectionIsClosed||e.fromPrint?[i("div",{staticClass:"tui-performElementResponse__section"},[i("div",{staticClass:"tui-performElementResponse__label"},[e._v("\n        "+e._s(e.$str("your_response","mod_perform"))+"\n      ")]),e._v(" "),e._t("content")],2)]:[e.error?i("div",[e._v(e._s(e.error))]):e._e(),e._v(" "),i("FormRow",{attrs:{label:e.$str("your_response","mod_perform"),"accessible-label":e.accessibleLabel,required:e.required,optional:e.optional,"aria-describedby":e.ariaDescribedby},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.labelId;return[e._t("content",null,{labelId:i})]}}],null,!0)})]],2)}),[],!1,null,null,null);"function"==typeof r&&r(o),o.options.__hasBlocks={script:!0,template:!0};t.default=o.exports},y3p0:function(e,t,i){"use strict";var n=i("Lp7x");i.n(n).a},yQFu:function(e,t,i){"use strict";i.r(t);var n=i("59Wj"),a=i.n(n),s=i("49h4"),r=i.n(s),o=i("lOlL"),l=i.n(o),d={components:{FilterBar:a.a,SelectFilter:r.a,ToggleSwitch:l.a},props:{filterOptions:Object,shown:{type:Number,required:!0},total:{type:Number,required:!0}},data:()=>({selectedFilters:{activityType:null,ownProgress:null,overdueOnly:!1}}),computed:{activityTypeFilterOptions(){return this.mapFilterOptions(this.filterOptions.activityTypes)},progressFilterOptions(){return this.mapFilterOptions(this.filterOptions.progressOptions)}},watch:{selectedFilters:{deep:!0,handler(){this.$emit("update-filters",this.selectedFilters)}}},methods:{mapFilterOptions(e){let t=e;return t=Object.keys(t).map(e=>({id:e,label:t[e]})),t.unshift({id:null,label:this.$str("all","core")}),t}}},c=(i("wS5V"),i("KHd+")),u=function(e){e.options.__langStrings={core:["all"],mod_perform:["showing_activities","user_activities_filter","user_activities_filter_own_progress","user_activities_filter_overdue_only","user_activities_filter_type"]}},m=Object(c.a)(d,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tui-performUserActivitiesFilter"},[i("FilterBar",{attrs:{title:e.$str("user_activities_filter","mod_perform"),"has-top-bar":!1},scopedSlots:e._u([{key:"filters-left",fn:function(t){var n=t.stacked;return[e.filterOptions.activityTypes?i("SelectFilter",{attrs:{label:e.$str("user_activities_filter_type","mod_perform"),"show-label":!0,options:e.activityTypeFilterOptions,stacked:n},model:{value:e.selectedFilters.activityType,callback:function(t){e.$set(e.selectedFilters,"activityType",t)},expression:"selectedFilters.activityType"}}):e._e(),e._v(" "),e.filterOptions.progressOptions?i("SelectFilter",{attrs:{label:e.$str("user_activities_filter_own_progress","mod_perform"),"show-label":!0,options:e.progressFilterOptions,stacked:n},model:{value:e.selectedFilters.ownProgress,callback:function(t){e.$set(e.selectedFilters,"ownProgress",t)},expression:"selectedFilters.ownProgress"}}):e._e(),e._v(" "),i("ToggleSwitch",{attrs:{text:e.$str("user_activities_filter_overdue_only","mod_perform"),"toggle-first":!0},model:{value:e.selectedFilters.overdueOnly,callback:function(t){e.$set(e.selectedFilters,"overdueOnly",t)},expression:"selectedFilters.overdueOnly"}})]}}]),model:{value:e.selectedFilters,callback:function(t){e.selectedFilters=t},expression:"selectedFilters"}}),e._v(" "),i("div",{staticClass:"tui-performUserActivitiesFilter__after"},[e.total?i("div",{staticClass:"tui-performUserActivitiesFilter__after-total"},[e._v("\n      "+e._s(e.$str("showing_activities","mod_perform",{shown:e.shown,total:e.total}))+"\n    ")]):e._e()])],1)}),[],!1,null,null,null);"function"==typeof u&&u(m),m.options.__hasBlocks={script:!0,template:!0};t.default=m.exports},yikf:function(e,t){e.exports=tui.require("tui/components/datatable/Table")},zN6o:function(e,t,i){},zQG5:function(e,t,i){"use strict";var n=i("CQIp");i.n(n).a},zRWw:function(e,t,i){},zclK:function(e,t,i){"use strict";i.r(t);var n=i("JXQf"),a=i.n(n),s=i("WBvU"),r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"mod_perform_activities"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mod_perform_activities"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"type"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"updated_at"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_view_participation_reporting"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_potentially_activate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_activate"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_manage"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"can_clone"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state_details"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"display_name"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"name"},arguments:[],directives:[]}]}}]}}]}}]},o={components:{FormRow:s.FormRow,FormSelect:s.FormSelect,FormScope:s.FormScope,Loader:a.a},props:{data:{type:Object,required:!0},configData:{type:Object,required:!0}},data:()=>({activities:[],visible:!0}),computed:{activityOptions(){let e={id:null,label:this.$str("schedule_dynamic_another_activity_select","mod_perform")},t=this.activities.filter(e=>e.id!=this.configData.activityId).map(e=>({id:e.id,label:e.name}));return t.unshift(e),t}},apollo:{activities:{query:r,update:e=>e.mod_perform_activities}},beforeDestroy(){this.visible=!1},methods:{activityValidator(e){const t=this.$str("schedule_dynamic_activity_required","mod_perform"),i={};return this.visible&&!e.activity&&(i.activity=t),i}}},l=i("KHd+"),d=function(e){e.options.__langStrings={mod_perform:["schedule_dynamic_activity_required","schedule_dynamic_another_activity_select","schedule_range_activity"]}},c=Object(l.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("FormScope",{attrs:{path:"dynamicCustomSettings",validate:this.activityValidator}},[t("FormRow",{attrs:{label:this.$str("schedule_range_activity","mod_perform")}},[t("Loader",{attrs:{loading:this.$apollo.loading}},[t("FormSelect",{attrs:{id:this.$id("relative-date-reference-date"),"char-length":"25",options:this.activityOptions,name:"activity"}})],1)],1)],1)}),[],!1,null,null,null);"function"==typeof d&&d(c),c.options.__hasBlocks={script:!0,template:!0};t.default=c.exports},zdti:function(e,t){e.exports=tui.require("tui/components/notifications/NotificationBanner")},zkRv:function(e,t){e.exports=tui.require("mod_perform/components/user_activities/participant/OtherParticipantResponses")},zs4z:function(e,t){e.exports=tui.require("tui/components/layouts/PageBackLink")}});