define(["jquery","theme_legacy/bootstrap"],function(a){function b(){function b(b){var d=b.target;null!==c&&d.closest("[aria-describedby]")!==c&&null===d.closest("#"+c.getAttribute("aria-describedby"))&&a(c).popover("hide")}a('[data-component="/core/output/popover"][data-enhanced="false"]').each(function(){var b=this,c=a(this),d=c.parent(),e=this.getAttribute("data-arrow_placement")?this.getAttribute("data-arrow_placement"):"bottom",f=this.getAttribute("data-trigger")?this.getAttribute("data-trigger"):"focus";if("smartPosition"===e){var g=!1;e=function(a,c){var d=c.getBoundingClientRect(),e=b.getAttribute("data-placement_max_height")?b.getAttribute("data-placement_max_height"):300,f=b.getAttribute("data-placement_max_width")?b.getAttribute("data-placement_max_width"):300;return e+=10,f+=10,window.innerHeight-d.bottom>e?(g=!0,"bottom"):d.top>e?(g=!1,"top"):d.left>f?"left":window.innerWidth-d.right>f?"right":(g=!1,"top")},window.innerWidth<992&&d.on("shown.bs.popover",function(){b.parentNode.scrollIntoView(g)})}if(d.popover({title:c.data("title")?c.data("title"):"",content:a(".popover__content",this).html(),placement:e,trigger:f,html:!0,sanitize:!1}),"manual"===f){var h=function(){d.popover("show")},i=function(){d.popover("hide")},j=function(){d.popover("destroy"),b.parentNode.removeEventListener("core/popover:show",h),b.parentNode.removeEventListener("core/popover:hide",i),b.parentNode.removeEventListener("core/popover:destroy",j),b.remove()};b.parentNode.addEventListener("core/popover:show",h),b.parentNode.addEventListener("core/popover:hide",i),b.parentNode.addEventListener("core/popover:destroy",j)}else d.attr("tabindex",0).css("cursor","pointer");c.attr("data-enhanced","true")});var d=document.querySelector('[data-component="/core/output/popover"][data-close_on_focus_out]');d&&(document.removeEventListener("click",b,!1),document.removeEventListener("touchstart",b,!1),document.addEventListener("click",b,!1),document.addEventListener("touchstart",b,!1))}var c=null;return a(document).on("shown.bs.popover",function(a){c=a.target}),a(document).on("hide.bs.modal",function(){c=null}),{scan:b}});