define(["core/config"],function(a){var b=function(a){this.storage=a,this.supported=this.detectSupport(),this.prefix="totara:cache:"+this._rootPath()+":",this.jsrevPrefix=this.prefix+"__jsrev",this.validateCache()};return b.prototype.detectSupport=function(){if(a.jsrev==-1)return!1;if("undefined"==typeof this.storage)return!1;var b="test";try{return null!==this.storage&&(this.storage.setItem(b,"1"),this.storage.removeItem(b),!0)}catch(c){return!1}},b.prototype.prefixKey=function(a){return this.prefix+a},b.prototype.validateCache=function(){var b=this.storage.getItem(this.jsrevPrefix);null!==b&&a.jsrev==b||(this._clear(),this.storage.setItem(this.jsrevPrefix,a.jsrev))},b.prototype.get=function(a){return!!this.supported&&(a=this.prefixKey(a),this.storage.getItem(a))},b.prototype.set=function(a,b){if(!this.supported)return!1;a=this.prefixKey(a);try{this.storage.setItem(a,b)}catch(c){return!1}return!0},b.prototype._rootPath=function(){var b=/^\w+:\/\/[^/]+\/?(.*)$/.exec(a.wwwroot);return b?b[1]:a.wwwroot},b.prototype._clear=function(){for(var a=this,b=[],c=0;c<this.storage.length;c++){var d=this.storage.key(c);(d.startsWith(this.prefix)||/^-?\d+\//.test(d))&&b.push(d)}b.forEach(function(b){return a.storage.removeItem(b)})},b});