define(["core/yui"],function(a){var b=function(a){this.node=a,this.blockNode=a.closest("[data-instanceid]"),this.blockNode&&(this.blockinstanceid=this.blockNode.getAttribute("data-instanceid")),this.addEvents(),this.checkResize()};return b.prototype={node:null,blockNode:null,blockinstanceid:-1,resizePending:!1,addEvents:function(){var a=this;if(window.addEventListener("resize",this.checkResize.bind(this)),this.addDockListeners(),document.body.classList.contains("editing")){var b=function(b){b.filter(function(a){return"childList"===a.type&&a.target.hasAttribute("data-blockregion")}).forEach(function(b){b.addedNodes.forEach(function(b){b.id=="inst"+a.blockinstanceid&&a.checkResize()})})},c=new MutationObserver(b);c.observe(document.body,{attributes:!1,childList:!0,subtree:!0})}},addDockListeners:function(){var b=this;a.use("moodle-core-dock",function(){var a=M.core.dock.get();a.on("dock:resizepanelcomplete",function(){var a=document.querySelector("#dock .block_current_learning");a&&b.checkResize()}),a.on("dock:itemremoved",function(){var a=document.getElementById("inst"+b.blockinstanceid);a&&b.checkResize()})})},checkResize:function(){this.resizePending||(this.resizePending=!0,setTimeout(this.doResize.bind(this),50))},doResize:function(){var a=parseInt(getComputedStyle(this.node).width,10),b=Math.floor(a/214)||1,c=this.node.querySelectorAll(".rb-chartjs__chart");if(b=Math.min(c.length,b),this.node.setAttribute("data-items-per-row",b),1===b&&this.node.firstElementChild){var d=getComputedStyle(this.node.firstElementChild);if(d.maxWidth===d.width){var e=getComputedStyle(this.node).width,f=(parseInt(e,10)-parseInt(d.width,10))/2;c.forEach(function(a){a.style.marginLeft=f+"px",a.style.marginRight=f+"px"})}else c.forEach(function(a){a.style.marginLeft="",a.style.marginRight=""})}this.resizePending=!1}},{init:function(a){var c=new b(a);Promise.resolve(c)}}});