define([],function(){function a(){return this instanceof a?(this.widget="",this.pathway={id:0,sortorder:0,type:"learning_plan",singleuse:1},this.pwKey="",this.endpoints={create:"pathway_learning_plan_create",update:"pathway_learning_plan_update"},void(this.filename="modal.js")):new a}a.prototype={setParent:function(a){this.widget=a},initData:function(){var a=this,b=this.widget.closest("[data-tw-editAchievementPaths-pathway-key]"),c=0,d=0,e=this.widget.closest("[data-tw-editAchievementPaths-pathway-id]"),f=this.widget;return new Promise(function(g){if(b&&(c=b.getAttribute("data-tw-editAchievementPaths-pathway-key")?b.getAttribute("data-tw-editAchievementPaths-pathway-key"):0),e&&(d=e.getAttribute("data-tw-editAchievementPaths-pathway-id")?e.getAttribute("data-tw-editAchievementPaths-pathway-id"):0),a.pwKey=c,0===d){delete a.pathway.id;var h=document.querySelector("[data-tw-editAchievementPaths-competency]"),i=1;h&&(i=h.getAttribute("data-tw-editAchievementPaths-competency")),a.pathway.competency_id=i,f.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.create)}else a.pathway.id=d,f.setAttribute("data-tw-editAchievementPaths-save-endPoint",a.endpoints.update);a.triggerEvent("update",{pathway:a.pathway}),g()})},triggerEvent:function(a,b){b.key=this.pwKey;var c=new CustomEvent("totara_competency/pathway:"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),c(d),M.util.js_pending("pathwayLearningPlan"),d.initData().then(function(){M.util.js_complete("pathwayLearningPlan")})["catch"](function(){})})};return{init:b}});