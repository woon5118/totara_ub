define([],function(){function a(){return this instanceof a?(this.countChange="data-tw-selectionbasket-countchange",this.countRequired="data-tw-selectionBasket-countReq",this.disabledBtnsClass="tw-selectionBasket__btn_disabled",this.eventKey=null,this.emptyBasketClass="tw-selectionBasket__empty",this.expandedActionsClass="tw-selectionBasket__actions_group_active",this.wideBasketClass="tw-selectionBasket--wide",void(this.widget=null)):new a}a.prototype={constructor:a,events:function(){var a=this;this.widget.addEventListener("click",function(b){if(b.target){if(b.target.closest("."+a.disabledBtnsClass))return void b.preventDefault();var c,d;if(b.target.closest("[data-tw-selectionBasket-group-trigger]")){b.preventDefault();var e=b.target.closest("[data-tw-selectionBasket-group]");e.classList.toggle(a.expandedActionsClass)}else b.target.closest("[data-tw-selectionbasket-action]")?(b.preventDefault(),d=b.target.closest("[data-tw-selectionbasket-action]"),c=d.getAttribute("data-tw-selectionbasket-action"),a.hideExpandedList(),a.triggerEvent("update",{action:c})):b.target.closest("[data-tw-selectionbasket-customAction]")&&(d=b.target.closest("[data-tw-selectionbasket-customAction]"),c=d.getAttribute("data-tw-selectionbasket-customAction"),a.hideExpandedList(),a.triggerEvent("customUpdate",{action:c}))}}),this.widget.addEventListener("transitionend",function(b){"max-width"===b.propertyName&&(b.target.classList.contains(a.wideBasketClass)?a.triggerEvent("transition",{state:"large"}):a.triggerEvent("transition",{state:"small"}))}),document.addEventListener("click",function(b){var c=a.widget.querySelector("."+a.expandedActionsClass);c&&b.target&&!b.target.closest("."+a.expandedActionsClass)&&c.classList.toggle(a.expandedActionsClass)});var b=new MutationObserver(function(){if(a.widget.hasAttribute(a.countChange)){var b=parseInt(a.widget.getAttribute(a.countChange));b||(b=0),a.updateCount(b),a.widget.removeAttribute(a.countChange)}});b.observe(this.widget,{attributes:!0,attributeFilter:[a.countChange],subtree:!1})},hideExpandedList:function(){var a=this.widget.querySelector("."+this.expandedActionsClass);a&&a.classList.toggle(this.expandedActionsClass)},setEventKey:function(){this.eventKey=this.widget.getAttribute("data-tw-selectionBasket-events")},setParent:function(a){this.widget=a},triggerEvent:function(a,b){var c=new CustomEvent(this.eventKey+":"+a,{bubbles:!0,detail:b});this.widget.dispatchEvent(c)},updateBtnState:function(a){var b,c=this.widget.querySelectorAll("["+this.countRequired+"]"),d=this.widget.querySelector("."+this.disabledBtnsClass);if(d&&a)for(b=0;b<c.length;b++)c[b].classList.remove(this.disabledBtnsClass);else if(!d&&!a)for(b=0;b<c.length;b++)c[b].classList.add(this.disabledBtnsClass)},updateCount:function(a){var b=this.widget.querySelector("[data-tw-selectionbasket-count]");b.innerHTML=a,this.updateBtnState(a),0===a?this.widget.classList.add(this.emptyBasketClass):this.widget.classList.remove(this.emptyBasketClass)}};var b=function(b){return new Promise(function(c){var d=new a;d.setParent(b),d.setEventKey(),d.events(),c(d)})};return{init:b}});